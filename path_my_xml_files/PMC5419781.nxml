<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Sensors (Basel)</journal-id><journal-id journal-id-type="iso-abbrev">Sensors (Basel)</journal-id><journal-id journal-id-type="publisher-id">sensors</journal-id><journal-title-group><journal-title>Sensors (Basel, Switzerland)</journal-title></journal-title-group><issn pub-type="epub">1424-8220</issn><publisher><publisher-name>MDPI</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">28338620</article-id><article-id pub-id-type="pmc">5419781</article-id><article-id pub-id-type="doi">10.3390/s17040668</article-id><article-id pub-id-type="publisher-id">sensors-17-00668</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>A Secure and Privacy-Preserving Navigation Scheme Using Spatial Crowdsourcing in Fog-Based VANETs</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Wang</surname><given-names>Lingling</given-names></name><xref rid="c1-sensors-17-00668" ref-type="corresp">*</xref></contrib><contrib contrib-type="author"><name><surname>Liu</surname><given-names>Guozhu</given-names></name></contrib><contrib contrib-type="author"><name><surname>Sun</surname><given-names>Lijun</given-names></name></contrib></contrib-group><contrib-group><contrib contrib-type="editor"><name><surname>Lu</surname><given-names>Rongxing</given-names></name><role>Academic Editor</role></contrib></contrib-group><aff id="af1-sensors-17-00668">School of Information Science and Technology, Qingdao University of Science and Technology, Qingdao 266061, China; <email>LGZ_0228@163.com</email> (G.L.); <email>lijunsun@qust.edu.cn</email> (L.S.)</aff><author-notes><corresp id="c1-sensors-17-00668"><label>*</label>Correspondence: <email>teacherwll@163.com</email>; Tel.: +86-136-1642-3910</corresp></author-notes><pub-date pub-type="epub"><day>24</day><month>3</month><year>2017</year></pub-date><pub-date pub-type="collection"><month>4</month><year>2017</year></pub-date><volume>17</volume><issue>4</issue><elocation-id>668</elocation-id><history><date date-type="received"><day>28</day><month>12</month><year>2016</year></date><date date-type="accepted"><day>16</day><month>3</month><year>2017</year></date></history><permissions><copyright-statement>&#x000a9; 2017 by the authors.</copyright-statement><copyright-year>2017</copyright-year><license license-type="open-access"><license-p>Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>).</license-p></license></permissions><abstract><p>Fog-based VANETs (Vehicular ad hoc networks) is a new paradigm of vehicular ad hoc networks with the advantages of both vehicular cloud and fog computing. Real-time navigation schemes based on fog-based VANETs can promote the scheme performance efficiently. In this paper, we propose a secure and privacy-preserving navigation scheme by using vehicular spatial crowdsourcing based on fog-based VANETs. Fog nodes are used to generate and release the crowdsourcing tasks, and cooperatively find the optimal route according to the real-time traffic information collected by vehicles in their coverage areas. Meanwhile, the vehicle performing the crowdsourcing task can get a reasonable reward. The querying vehicle can retrieve the navigation results from each fog node successively when entering its coverage area, and follow the optimal route to the next fog node until it reaches the desired destination. Our scheme fulfills the security and privacy requirements of authentication, confidentiality and conditional privacy preservation. Some cryptographic primitives, including the Elgamal encryption algorithm, AES, randomized anonymous credentials and group signatures, are adopted to achieve this goal. Finally, we analyze the security and the efficiency of the proposed scheme.</p></abstract><kwd-group><kwd>fog-based VANETs</kwd><kwd>real-time navigation</kwd><kwd>privacy-preserving</kwd><kwd>spatial crowdsourcing</kwd></kwd-group></article-meta></front><body><sec id="sec1-sensors-17-00668"><title>1. Introduction</title><p>Traffic congestion in crowded urban areas has had a number of negative effects on society, such as wasting motorists&#x02019; time, increasing air pollution from the wasted fuel, and creating a higher chance of collisions, etc. It is reported that commuters in Beijing spent on average 32 min per hour in traffic jams while traveling during rush hours in 2015 [<xref rid="B1-sensors-17-00668" ref-type="bibr">1</xref>]. Hence, it is a common experience for a driver to find a better driving route in a congested area. Since real-time traffic information plays a key role in monitoring road conditions and predicting optimal routes of vehicles, it is certainly worth using a real-time navigation system for drivers on the road to find the optimal route of a certain destination.</p><p>For the last few years, global positioning system (GPS) [<xref rid="B2-sensors-17-00668" ref-type="bibr">2</xref>] technology has been adopted for navigation systems, such as the Autonavi navigation system [<xref rid="B3-sensors-17-00668" ref-type="bibr">3</xref>], which provides convenient navigation services based on a local map database. However, since the road conditions are not updated in time in the local map database, conventional GPS-based navigation systems may guide drivers to erroneous routes if some traffic accidents occur in real time.</p><p>In the meantime, vehicular ad hoc networks (VANETs), which act as important elements of the intelligent transportation system, has become increasingly popular in many countries. The navigation system based on VANETs can provide more timely and more accurate traffic information. In a typical VANET, vehicles are equipped with on-board units (OBUs) to perform mobile computation and communication with other nearby vehicles, and with road-side units (RSUs) installed along the road. With the support of VANETs and its crowdsensing capability, real-time road conditions can be collected and transmitted to support the real-time navigation. However, RSUs have limited computation and storage capability, while real-time navigation systems based on crowd sourcing require complex computation and large storage. This challenge has motivated researchers to investigate the new paradigm of VANETs.</p><p>Recently, the vehicular cloud has been proposed for big data processing and complicated intelligent analysis on VANET environments [<xref rid="B4-sensors-17-00668" ref-type="bibr">4</xref>,<xref rid="B5-sensors-17-00668" ref-type="bibr">5</xref>,<xref rid="B6-sensors-17-00668" ref-type="bibr">6</xref>]. However, centralized cloud computing is unnecessary and inefficient for the interactive navigation system. To relieve the computation and communication burden on vehicular cloud, fog computing can be adopted. Fog computing, which was firstly proposed by Cisco in 2012 [<xref rid="B7-sensors-17-00668" ref-type="bibr">7</xref>], is an extension of the cloud-based Internet by introducing an intermediate layer between mobile devices and cloud, aiming at the smooth, low-latency service delivery from the cloud to mobile. In this paper, we combine vehicular cloud with fog computing, and consider a new paradigm called fog-based VANETs.</p><p>Although fog-based VANETs can provide many possible advantages for real-time navigation systems, several security concerns also have to be addressed before the implementation of the system. A navigation system requires that the identity of the vehicle and communication messages should be authenticated and maintain secrecy to guard against the impersonation, message forgery attacks, and eavesdropping. Meanwhile, privacy preservation must be achieved because the private information, such as vehicles&#x02019; licenses, location, and speed, etc., needs to be protected. In addition, the authorities should be able to reveal the real identity of the disputed vehicles when necessary.</p><p>In this paper, we proposed a secure and privacy-preserving navigation scheme (SPNS) in fog-based VANETs, which use spatial crowdsourcing to collect real-time traffic information and analyze the collected data to provide real-time navigation services to drivers. The security and the privacy preservation of the scheme are also analyzed to evaluate the scheme. In particular, we make the following contributions:
<list list-type="bullet"><list-item><p>First, we present a model for a secure navigation scheme in fog-based VANETs, which takes advantage of vehicular cloud and fog computing to make up for the limitation of the previous VANET-based navigation system.</p></list-item><list-item><p>Second, we construct a specific scheme that can support real-time navigation service to drivers in a congested area. In this way, drivers can quickly find an available route, and, moreover, gasoline and the time wasted in traffic congestion can be reduced. By using the spatial crowdsourcing, the real-time road conditions can be updated in time in fog-based VANETs. Meanwhile, the vehicle performing the crowdsourcing task can get a reasonable reward. Performance analysis shows that the real-time navigation service supported by the proposed scheme is effective.</p></list-item><list-item><p>Third, the proposed scheme can also ensure the conditional privacy preservation of the vehicles (or drivers), which is regarded as the basic security requirement in VANET communications [<xref rid="B8-sensors-17-00668" ref-type="bibr">8</xref>,<xref rid="B9-sensors-17-00668" ref-type="bibr">9</xref>,<xref rid="B10-sensors-17-00668" ref-type="bibr">10</xref>,<xref rid="B11-sensors-17-00668" ref-type="bibr">11</xref>].</p></list-item></list></p><p>The rest of the paper is organized as follows: the system model and design goals are described in <xref ref-type="sec" rid="sec2-sensors-17-00668">Section 2</xref>. Some preliminaries are given in <xref ref-type="sec" rid="sec3-sensors-17-00668">Section 3</xref>. Our scheme is proposed in <xref ref-type="sec" rid="sec4-sensors-17-00668">Section 4</xref>. The security analysis is given in <xref ref-type="sec" rid="sec5-sensors-17-00668">Section 5</xref>, and the performance analysis is given in <xref ref-type="sec" rid="sec6-sensors-17-00668">Section 6</xref>. Related work is reviewed in <xref ref-type="sec" rid="sec7-sensors-17-00668">Section 7</xref>. Finally, <xref ref-type="sec" rid="sec8-sensors-17-00668">Section 8</xref> concludes the paper.</p></sec><sec id="sec2-sensors-17-00668"><title>2. System Model and Design Goal</title><p>In this section, we define the problem by formalizing the system model and the design goal.</p><sec id="sec2dot1-sensors-17-00668"><title>2.1. System Model</title><p>In this section, we consider the fog-based VANETs and describe our system model, in which communication nodes include trusted authority (TA), navigation servers (NS) and crowdsourcing servers (CS) residing in the fog, and vehicles as shown in <xref ref-type="fig" rid="sensors-17-00668-f001">Figure 1</xref>. The detailed description of system components is as follows:
<list list-type="bullet"><list-item><p>TA is trusted and the public agency. For example, the transportation authorities with administrative rights can take on the role of the TA. It is responsible for the registration of fog nodes and vehicles deployed in fog-based VANETs, issuing anonymous credentials and tracing the vehicles&#x02019; identity in case of rewarding purpose for spatial crowdsourcing, sending fake traffic information for uncongested driving experience, etc.</p></list-item><list-item><p>The cloud is a set of interconnected computing resources. The cloud provides centralized navigation services for drivers, e.g., Google Map.</p></list-item><list-item><p>Fog node is a highly virtualized computing system, which is deployed at the edge of networks, e.g., banks, bus terminals, shopping halls, etc. Similar to a lightweight cloud server, fog node is equipped with the on-board large volume data storage, computers and wireless communication facility [<xref rid="B12-sensors-17-00668" ref-type="bibr">12</xref>]. In our fog-based VANETs, the fog node consists of navigation servers (NS) and crowdsourcing servers (CS) and conventional RSU, which are in charge of releasing crowdsourcing tasks, computing the optimal path for the querying vehicles, and rewarding the crowdsourcing contributors.</p></list-item><list-item><p>Vehicles are equipped with irreplaceable and temper-proof OBU device, which enables performing some simple computations, communicating with other vehicles and fog nodes, and these vehicles have a small amount of read-only memory. In our model, OBU is required to generate real-time navigation query, traffic information reports for spatial crowdsourcing tasks, result retrieving query.</p></list-item></list></p><p>As shown in <xref ref-type="fig" rid="sensors-17-00668-f001">Figure 1</xref>, the navigation scheme works as the following. Assume each vehicle and fog node have already registered to the TA. Then, a vehicle can send a navigation query generated by the OBU to the nearby fog node, denoted as fog<inline-formula><mml:math id="mm1"><mml:mrow><mml:msub><mml:mrow/><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, at time <inline-formula><mml:math id="mm2"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. The navigation server (NS) in Fog<inline-formula><mml:math id="mm3"><mml:mrow><mml:msub><mml:mrow/><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> forwards the query to the last Fog<inline-formula><mml:math id="mm4"><mml:mrow><mml:msub><mml:mrow/><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> which covers the destination by relaying fog nodes hop by hop. Upon receiving the navigation query, each crowdsourcing server (CS) generates and releases a crowdsourcing task of collecting real-time traffic information to vehicles in its coverage area. In addition, the vehicle who wants to perform the task returns a crowdsourcing report and can get a reasonable reward from the CS. Upon receiving the report, CS verifies it and shares the valuable traffic information with NS. The NS computes the optimal path for the querying vehicle in its area. Meanwhile, NS analyzes and forwards the traffic information to the cloud for other services. Finally, the querying vehicle can get successive navigation results from fog nodes by sending navigation result retrieving query when entering the coverage of the fog nodes until it ultimately reaches the desired destination.</p></sec><sec id="sec2dot2-sensors-17-00668"><title>2.2. Design Goal</title><p>Before describing our design goal for the navigation scheme, we first make necessary assumptions in our system model.</p><statement><label><bold>Assumption</bold>&#x000a0;<bold>1.</bold></label><p>TA is fully trusted by all vehicles and fog nodes. TA can communicate with fog nodes and vehicles through a secure channel by the internet or any other reliable communication links with high bandwidth. The TA can also inspect all fog nodes and maintain the compromised entities list.</p></statement><statement><label><bold>Assumption</bold>&#x000a0;<bold>2.</bold></label><p>Fog nodes are untrusted. For instance, some honest-but-curious fog nodes may learn the position of specific vehicles and also get some sensitive information for some purposes.</p></statement><statement><label><bold>Assumption</bold>&#x000a0;<bold>3.</bold></label><p>The adversary can overhear V2V (Vehicle to Vehicle) and V2I (Vehicle to Infrastructure) communications to obtain any messages for their purposes, such as tracing the identity of some vehicles. Some dishonest vehicles may overhear the communications to obtain the navigation results queried by other vehicles to enjoy free navigation services if they happen to have the same destination.</p></statement><statement><label><bold>Assumption</bold>&#x000a0;<bold>4.</bold></label><p><italic>TA, fog nodes, and vehicles have clocks for generation of time stamps and check valid time of navigation query and result retrieving query. They can use GPS satellites as a synchronized time source</italic> [<xref rid="B13-sensors-17-00668" ref-type="bibr">13</xref>].</p></statement><p>Our design goal is to develop a secure and privacy-preserving navigation scheme for vehicles, which can achieve the following desirable requirements: (1) real-time route navigation; (2) authentication; (3) confidentiality; and (4) conditional privacy preservation.
<list list-type="bullet"><list-item><p>Real-time path navigation: With the guidance of the fog nodes, a vehicle can conveniently find the optimal path to the desired destination.</p></list-item><list-item><p>Authentication: Only legitimate entities should take part in the fog-based VANETs. Fog nodes and vehicles should be able to prove themselves by using certificates or credentials. In addition, the origin of the messages should be authenticated to prevent against the impersonation and message forgery attacks. Meanwhile, the identity of the crowdsourcing contributor should be authenticated to get the reward. In addition, only a legitimate subscriber that has service access rights should be able to get navigation service.</p></list-item><list-item><p>Confidentiality: the navigation query, traffic information report, and navigation result should be kept confidential from eavesdroppers who will illegally use the navigation information for their own purposes.</p></list-item><list-item><p>Conditional privacy preservation: the real identity of the querying vehicle and the crowdsourcing vehicle should be kept secret. Although the location and destination would be exposed to fog nodes, the adversary can neither link a navigaiton query to a specific vehicle nor identify two navigation queries from the same vehicle. However, once an exceptional event occurs, the fog nodes can learn the vehicles&#x02019; real identifier with the help of TA.</p></list-item></list></p></sec></sec><sec id="sec3-sensors-17-00668"><title>3. Preliminaries</title><p>This section describes some cryptographic primitives which are adopted in our proposed scheme. They are bilinear groups, message-locked encryption, randomized signatures and group signatures.</p><sec id="sec3dot1-sensors-17-00668"><title>3.1. Bilinear groups</title><p>Bilinear groups are a set of three cyclic groups <inline-formula><mml:math id="mm5"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm6"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm7"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> of prime order <italic>q</italic> with a bilinear map <inline-formula><mml:math id="mm8"><mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x000d7;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02192;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> with the following properties:
<list list-type="order"><list-item><p>for all <inline-formula><mml:math id="mm9"><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm10"><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm11"><mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm12"><mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mi>a</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:mi>b</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>;</p></list-item><list-item><p>for <inline-formula><mml:math id="mm13"><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02260;</mml:mo><mml:msub><mml:mn>1</mml:mn><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm14"><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02260;</mml:mo><mml:msub><mml:mn>1</mml:mn><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm15"><mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02260;</mml:mo><mml:msub><mml:mn>1</mml:mn><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> ;</p></list-item><list-item><p>the map <italic>e</italic> is efficiently computable.</p></list-item></list></p><p>There are three types of pairings defined by Galbraith, Paterson, and Smart [<xref rid="B14-sensors-17-00668" ref-type="bibr">14</xref>]: in type 1, <inline-formula><mml:math id="mm16"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>; in type 2, <inline-formula><mml:math id="mm17"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02260;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, but there exists an efficient homomorphism <inline-formula><mml:math id="mm18"><mml:mrow><mml:mrow><mml:mi>&#x003d5;</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02192;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> while no efficient one exists in the other direction; in type 3, <inline-formula><mml:math id="mm19"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02260;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and there is no efficiently computable homomorphism between <inline-formula><mml:math id="mm20"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm21"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> in either direction. In this paper, we only consider type 3 pairings, which will guarantee the security of the randomized signatures used in our scheme.</p></sec><sec id="sec3dot2-sensors-17-00668"><title>3.2. Message-Locked Encryption</title><p>A message-locked encryption (MLE) scheme is a symmetric encryption scheme in which the key used for encryption and decryption is itself derived from the message [<xref rid="B15-sensors-17-00668" ref-type="bibr">15</xref>]. Instances of this primitive are seeing widespread deployment and application for the purpose of secure deduplication [<xref rid="B16-sensors-17-00668" ref-type="bibr">16</xref>,<xref rid="B17-sensors-17-00668" ref-type="bibr">17</xref>,<xref rid="B18-sensors-17-00668" ref-type="bibr">18</xref>]. A message-locked encryption scheme MLE = <inline-formula><mml:math id="mm22"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">P</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">K</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">E</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">D</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="script">T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is a five-tuple of polynomial time algorithm, the last two deterministic:
<list list-type="bullet"><list-item><p>On input <inline-formula><mml:math id="mm23"><mml:mrow><mml:msup><mml:mn>1</mml:mn><mml:mi>&#x003bb;</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, the parameter generation algorithm <inline-formula><mml:math id="mm24"><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:math></inline-formula> returns a public parameter <italic>P</italic>.</p></list-item><list-item><p>On input <italic>P</italic> and a message <italic>M</italic>, the key-generation algorithm <inline-formula><mml:math id="mm25"><mml:mrow><mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:math></inline-formula> returns a message-derived key <inline-formula><mml:math id="mm26"><mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>&#x02190;</mml:mo><mml:msub><mml:mi mathvariant="script">K</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>On input <inline-formula><mml:math id="mm27"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, the encryption algorithm <inline-formula><mml:math id="mm28"><mml:mrow><mml:mi mathvariant="script">E</mml:mi></mml:mrow></mml:math></inline-formula> returns a ciphertext <inline-formula><mml:math id="mm29"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>&#x02190;</mml:mo><mml:msub><mml:mi mathvariant="script">E</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>On input <inline-formula><mml:math id="mm30"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and a ciphertext <italic>C</italic>, the decryption algorithm <inline-formula><mml:math id="mm31"><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow></mml:math></inline-formula> returns <inline-formula><mml:math id="mm32"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="script">D</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo>&#x0222a;</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mo>&#x022a5;</mml:mo><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p>On input <inline-formula><mml:math id="mm33"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, the tag generation algorithm returns a tag <inline-formula><mml:math id="mm34"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>&#x02190;</mml:mo><mml:msub><mml:mi mathvariant="script">T</mml:mi><mml:mi>P</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></list-item></list></p><p>Bellare [<xref rid="B15-sensors-17-00668" ref-type="bibr">15</xref>] has summarized four MLE schemes: convergent encryption (CE), Hash-and-CE1 (HCE1), Hash-and-CE2 (HCE2), and randomized convergent encryption (RCE). In our scheme, we utilize the RCE to encrypt the crowdsourcing traffic information report.</p></sec><sec id="sec3dot3-sensors-17-00668"><title>3.3. Randomized Signatures</title><p>Randomized signature [<xref rid="B19-sensors-17-00668" ref-type="bibr">19</xref>] is both an efficient and secure signature with the same features as Camenisch-Lysyanskaya (CL)-signatures [<xref rid="B20-sensors-17-00668" ref-type="bibr">20</xref>] but consists of only two elements in the signature. It takes advantage of the full potential of type 3 pairings, in which the space of the signatures and the one of the public key are seperated. A randomized signature scheme usually consists of four algorithms:
<list list-type="bullet"><list-item><p><inline-formula><mml:math id="mm35"><mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>: given a security parameter <italic>k</italic>, this algorithm outputs public parameter <inline-formula><mml:math id="mm36"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. These bilinear groups must be of type 3.</p></list-item><list-item><p><inline-formula><mml:math id="mm37"><mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mi>e</mml:mi><mml:mi>y</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>: selects <inline-formula><mml:math id="mm38"><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm39"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02208;</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, computes <inline-formula><mml:math id="mm40"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and sets <inline-formula><mml:math id="mm41"><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> as <inline-formula><mml:math id="mm42"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm43"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> as <inline-formula><mml:math id="mm44"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p><inline-formula><mml:math id="mm45"><mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>: picks a random <inline-formula><mml:math id="mm46"><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> to compute a signature <inline-formula><mml:math id="mm47"><mml:mrow><mml:mrow><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x02190;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p><inline-formula><mml:math id="mm48"><mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003c3;</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>: parses <inline-formula><mml:math id="mm49"><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow></mml:math></inline-formula> as <inline-formula><mml:math id="mm50"><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003c3;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003c3;</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and checks whether <inline-formula><mml:math id="mm51"><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003c3;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02260;</mml:mo><mml:msub><mml:mn>1</mml:mn><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm52"><mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003c3;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>X</mml:mi><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003c3;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> are both satisfied. If it is the positive case, it outputs 1, and 0 otherwise.</p></list-item></list></p><p>A randomized signature <inline-formula><mml:math id="mm53"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003c3;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003c3;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> on <italic>m</italic> can be randomized by selecting a random <inline-formula><mml:math id="mm54"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and computing <inline-formula><mml:math id="mm55"><mml:mrow><mml:mrow><mml:msup><mml:mi>&#x003c3;</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02190;</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mn>1</mml:mn><mml:mi>r</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mn>2</mml:mn><mml:mi>r</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> , which is still a valid signature on <italic>m</italic>.</p></sec><sec id="sec3dot4-sensors-17-00668"><title>3.4. Group Signatures</title><p>The group signature scheme was first introduced by David Chaum and Eugene van Heyst in 1991 [<xref rid="B21-sensors-17-00668" ref-type="bibr">21</xref>]. In a group signature scheme, there exists a group manager and several group members, essential to which is a group manager, who is in charge of adding group members and has the ability to reveal the original signer in the event of disputes. A group signature scheme is desired to satisfy three security properties: unforgeability, anonymity, and traceability. Unforgeability ensures that only the group member can generate signatures on behalf of the group. Anonymity means that signatures do not reveal their signer&#x02019;s identity, except the group manager. Traceability shows that all valid signatures, even those generated by the collusion of multiple group members, can be revoked by the group manager.</p></sec></sec><sec id="sec4-sensors-17-00668"><title>4. Proposed Secure and Privacy-Preserving Navigation Scheme</title><p>In this section, we present a secure and privacy-preserving navigation scheme (SPNS) in fog-based VANETs, which consists of four parts: (1) system setting; (2) real-time navigation querying; (3) vehicular spatial crowdsourcing; and (4) navigation result retrieving.</p><sec id="sec4dot1-sensors-17-00668"><title>4.1. System Setting</title><p>Let <inline-formula><mml:math id="mm56"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm57"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> be three cyclic groups of the same large prime order <italic>q</italic>. Suppose that <inline-formula><mml:math id="mm58"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm59"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are equipped with a type 3 pairing. Let <inline-formula><mml:math id="mm60"><mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mo>:</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo>&#x02192;</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> be a public collision-resistant hash function. The TA first chooses <inline-formula><mml:math id="mm61"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02208;</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> as the master key and computes <inline-formula><mml:math id="mm62"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> as its public key. In the end, the TA publishes the system parameters <inline-formula><mml:math id="mm63"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mspace width="3.33333pt"/><mml:mo>=</mml:mo><mml:mspace width="3.33333pt"/><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>Each fog node has a unique identifier <inline-formula><mml:math id="mm64"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to identify its position and a map of its coverage. <inline-formula><mml:math id="mm65"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> randomly chooses <inline-formula><mml:math id="mm66"><mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> as its secret key and computes <inline-formula><mml:math id="mm67"><mml:mrow><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:mi>y</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> as its public key. In addition, <inline-formula><mml:math id="mm68"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> maintains a routing table to determine the next fog node to which the vehicle should move forward.</p><p>Each vehicle has a unique identifier <inline-formula><mml:math id="mm69"><mml:mrow><mml:msub><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. The vehicle <inline-formula><mml:math id="mm70"><mml:mrow><mml:msub><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> randomly chooses <inline-formula><mml:math id="mm71"><mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> to compute <inline-formula><mml:math id="mm72"><mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mi>v</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm73"><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>2</mml:mn><mml:mi>v</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, and sends <inline-formula><mml:math id="mm74"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to the TA to prove its knowledge of <italic>v</italic>. Then, the TA verifies the validity by checking the equation <inline-formula><mml:math id="mm75"><mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>. If the equation does not hold, the TA returns failure and aborts. Otherwise, the TA picks <inline-formula><mml:math id="mm76"><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> to compute
<disp-formula><mml:math id="mm77"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02190;</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mfrac></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mi>s</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi>V</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>s</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>In addition, the TA stores <inline-formula><mml:math id="mm78"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in a secure database, and returns <inline-formula><mml:math id="mm79"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="mm80"><mml:mrow><mml:msub><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> through a secure channel. <inline-formula><mml:math id="mm81"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> sets its secret key as <inline-formula><mml:math id="mm82"><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>k</mml:mi><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and the corresponding public key as <inline-formula><mml:math id="mm83"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>When <inline-formula><mml:math id="mm84"><mml:mrow><mml:msub><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> starts to travel in the city, it will generate some short-life keys for navigation queries according to the following steps:
<list list-type="bullet"><list-item><p><inline-formula><mml:math id="mm85"><mml:mrow><mml:msub><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> chooses <italic>m</italic> random numbers, <inline-formula><mml:math id="mm86"><mml:mrow><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> as the short-life private keys and computes the corresponding public keys <inline-formula><mml:math id="mm87"><mml:mrow><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>u</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="mm88"><mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> for the travel;</p></list-item><list-item><p>for each short-life public key <inline-formula><mml:math id="mm89"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm90"><mml:mrow><mml:msub><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> computes the self-delegated certificate <inline-formula><mml:math id="mm91"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> as follows:
<list list-type="simple"><list-item><label>&#x02212;</label><p>randomly choose <inline-formula><mml:math id="mm92"><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm93"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm94"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm95"><mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, compute <inline-formula><mml:math id="mm96"><mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>&#x003b2;</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> as follows: <inline-formula><mml:math id="mm97"><mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>1</mml:mn><mml:mi>&#x003b1;</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm98"><mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>3</mml:mn><mml:mi>&#x003b1;</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm99"><mml:mrow><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mo>=</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> mod <italic>q</italic>, <inline-formula><mml:math id="mm100"><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>t</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm101"><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mn>1</mml:mn><mml:mi>v</mml:mi></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>t</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm102"><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>t</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>4</mml:mn><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>t</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>;</p></list-item><list-item><label>&#x02212;</label><p>compute <inline-formula><mml:math id="mm103"><mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm104"><mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="mm105"><mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mi>&#x003b1;</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> mod <italic>q</italic>; <inline-formula><mml:math id="mm106"><mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> mod <italic>q</italic>; <inline-formula><mml:math id="mm107"><mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mi>&#x003b2;</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> mod <italic>q</italic>; and the certificate of <inline-formula><mml:math id="mm108"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is <inline-formula><mml:math id="mm109"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><label>&#x02212;</label><p>anyone can check the validity of <inline-formula><mml:math id="mm110"><mml:mrow><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mi>C</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> by computing: <inline-formula><mml:math id="mm111"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003b2;</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mn>1</mml:mn><mml:mi>c</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>;</p><p><inline-formula><mml:math id="mm112"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003b2;</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>;</p><p><inline-formula><mml:math id="mm113"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003b2;</mml:mi><mml:mn>3</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:msubsup><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>4</mml:mn><mml:mi>c</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>4</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub></mml:msubsup><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:msub></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:mi>c</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>;</p><p>and check whether <inline-formula><mml:math id="mm114"><mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003b2;</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003b2;</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003b2;</mml:mi><mml:mn>3</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> holds.</p></list-item></list></p></list-item><list-item><p><inline-formula><mml:math id="mm115"><mml:mrow><mml:msub><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> installs <inline-formula><mml:math id="mm116"><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>k</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm117"><mml:mrow><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>C</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="mm118"><mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> into the read-only memory of the OBUs.</p></list-item></list></p></sec><sec id="sec4dot2-sensors-17-00668"><title>4.2. Real-Time Navigation Querying</title><p>When a vehicle <inline-formula><mml:math id="mm119"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> that is equipped with an OBU is driving on the road, it can send a real-time navigation query to the nearby fog node, denoted as <inline-formula><mml:math id="mm120"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. The real-time query utilizes the OBU to generate the navigation information <inline-formula><mml:math id="mm121"><mml:mrow><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm122"><mml:mrow><mml:msup><mml:mi>U</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm123"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm124"><mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm125"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm126"><mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, as shown in <xref ref-type="table" rid="sensors-17-00668-t001">Table 1</xref>.</p><p>Using this navigation information, the querier <inline-formula><mml:math id="mm127"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> performs the following steps to generate a navigation query:
<list list-type="bullet"><list-item><p>utilize <inline-formula><mml:math id="mm128"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> to encrypt <inline-formula><mml:math id="mm129"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> by randomly choosing <inline-formula><mml:math id="mm130"><mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and compute <inline-formula><mml:math id="mm131"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm132"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm133"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>C</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>D</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>;</p></list-item><list-item><p>select randomly <inline-formula><mml:math id="mm134"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02208;</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> to compute the randomized signture <inline-formula><mml:math id="mm135"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02190;</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and the hush function <inline-formula><mml:math id="mm136"><mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msup><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm137"><mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, and output the group signature <inline-formula><mml:math id="mm138"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>;</p></list-item><list-item><p>finally, send the navigation query <italic>Q</italic> to the fog node <inline-formula><mml:math id="mm139"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="mm140"><mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></list-item></list></p><p>Upon receiving the navigation query <italic>Q</italic>, <inline-formula><mml:math id="mm141"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> firstly checks whether the destination <inline-formula><mml:math id="mm142"><mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> is in its coverage. If the answer is yes, it will generate a crowdsourcing task to find the optimal route to the destination for the querying vehicle <inline-formula><mml:math id="mm143"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>. Otherwise, <inline-formula><mml:math id="mm144"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> performs the following steps to forward <italic>Q</italic> to the next fog node <inline-formula><mml:math id="mm145"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> according to its routing table. Meanwhile, it will generate a crowdsourcing task to find the optimal route to the next fog node for the querying vehicle.
<list list-type="bullet"><list-item><p>Decode <inline-formula><mml:math id="mm146"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> by computing <inline-formula><mml:math id="mm147"><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>;</p></list-item><list-item><p>verify the validity of the signature <inline-formula><mml:math id="mm148"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> by computing
<disp-formula><mml:math id="mm149"><mml:mrow><mml:mrow><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>1</mml:mn><mml:mi>c</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>2</mml:mn><mml:mi>&#x003c4;</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
and checking whether the hash <inline-formula><mml:math id="mm150"><mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> holds. If not, <inline-formula><mml:math id="mm151"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> returns failure and aborts; Otherwise, it checks the routing table to find the next fog node, denoted as <inline-formula><mml:math id="mm152"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, according to the destination <inline-formula><mml:math id="mm153"><mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></list-item><list-item><p><inline-formula><mml:math id="mm154"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> randomly chooses <inline-formula><mml:math id="mm155"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>k</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>0</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> to compute <inline-formula><mml:math id="mm156"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:msubsup><mml:mi>k</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm157"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>0</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mn>2</mml:mn><mml:msubsup><mml:mi>k</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm158"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mn>3</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:msubsup><mml:mi>g</mml:mi><mml:mn>0</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>C</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>D</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>;</p></list-item><list-item><p>finally, <inline-formula><mml:math id="mm159"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> forwards the query <inline-formula><mml:math id="mm160"><mml:mrow><mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mn>3</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="mm161"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>.</p></list-item></list></p><p>When <inline-formula><mml:math id="mm162"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> receives <inline-formula><mml:math id="mm163"><mml:mrow><mml:msup><mml:mi>Q</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, it performs the same operations as <inline-formula><mml:math id="mm164"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and will forward the query to the next fog node until it reaches the last fog node, denoted as <inline-formula><mml:math id="mm165"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, which covers the destination of the querying vehicle <inline-formula><mml:math id="mm166"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="sec4dot3-sensors-17-00668"><title>4.3. Spatial Crowdsourcing</title><p>When receiving a navigation query with a sequence number <italic>N</italic>, the fog node <inline-formula><mml:math id="mm167"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mspace width="3.33333pt"/><mml:mo>&#x02208;</mml:mo><mml:mspace width="3.33333pt"/><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> generates and releases a crowdsourcing task of collecting traffic information to all the vehicles in its coverage area. <inline-formula><mml:math id="mm168"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> keeps a tag table <inline-formula><mml:math id="mm169"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, which contains all tags of rewarded vehicles for a specific crowdsourcing task. If a vehicle <inline-formula><mml:math id="mm170"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> with the secret key <inline-formula><mml:math id="mm171"><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>k</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> wants to perform this task, it performs the operations as follows:
<list list-type="bullet"><list-item><p>randomly choose a short-life public key <inline-formula><mml:math id="mm172"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> from the <inline-formula><mml:math id="mm173"><mml:mrow><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>C</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="mm174"><mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> stored in its OBU;</p></list-item><list-item><p>generate a traffic information report <inline-formula><mml:math id="mm175"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> including the current location, current time, driving speed and the road condition;</p></list-item><list-item><p>randomly choose <inline-formula><mml:math id="mm176"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02208;</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> to calculate the randomized signature <inline-formula><mml:math id="mm177"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02190;</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, the hash <inline-formula><mml:math id="mm178"><mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm179"><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>;</p></list-item><list-item><p>encrypt the traffic information report <inline-formula><mml:math id="mm180"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> by using a message-lock encryption algorithm. Choose <inline-formula><mml:math id="mm181"><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> to compute <inline-formula><mml:math id="mm182"><mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, the tag <inline-formula><mml:math id="mm183"><mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm184"><mml:mrow><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm185"><mml:mrow><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="3.33333pt"/><mml:mo>=</mml:mo><mml:mspace width="3.33333pt"/><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02295;</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02295;</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>;</p></list-item><list-item><p>finally, <inline-formula><mml:math id="mm186"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> returns the crowdsourcing response <inline-formula><mml:math id="mm187"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="mm188"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p></list-item></list></p><p>When <inline-formula><mml:math id="mm189"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> receives the crowdsourcing response <inline-formula><mml:math id="mm190"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, it will compute the optimal path to the destination by the following operations:
<list list-type="bullet"><list-item><p>decode the crowdsourcing response <inline-formula><mml:math id="mm191"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> by computing <inline-formula><mml:math id="mm192"><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02295;</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02295;</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm193"><mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and the tag <inline-formula><mml:math id="mm194"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>;</p></list-item><list-item><p>check whether the equation <inline-formula><mml:math id="mm195"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> holds. If not, <inline-formula><mml:math id="mm196"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> reject the <inline-formula><mml:math id="mm197"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Otherwise, it compares the tag <inline-formula><mml:math id="mm198"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> with the element in the tag table <inline-formula><mml:math id="mm199"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. If there exists a tag <inline-formula><mml:math id="mm200"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> in the tag table <inline-formula><mml:math id="mm201"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> satisfying <inline-formula><mml:math id="mm202"><mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, which means the same traffic information report has been stored in the database, <inline-formula><mml:math id="mm203"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> will reject the <inline-formula><mml:math id="mm204"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Otherwise, it verifies the signature by computing
<disp-formula><mml:math id="mm205"><mml:mrow><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
and checking whether the equation <inline-formula><mml:math id="mm206"><mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> holds. If not, <inline-formula><mml:math id="mm207"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> returns failure and aborts; otherwise, it keeps <inline-formula><mml:math id="mm208"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> in its database;</p></list-item><list-item><p><inline-formula><mml:math id="mm209"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> rewards the contributor <inline-formula><mml:math id="mm210"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> based on the short-life public key <inline-formula><mml:math id="mm211"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>;</p></list-item><list-item><p><inline-formula><mml:math id="mm212"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> can compute the optimal path <inline-formula><mml:math id="mm213"><mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> by using Dijkstra&#x02019;s algorithm in its coverage area;</p></list-item><list-item><p>choose <inline-formula><mml:math id="mm214"><mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm215"><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> to calculate <inline-formula><mml:math id="mm216"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mrow><mml:mo>*</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>O</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm217"><mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mrow><mml:mo>*</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. Finally, the navigation result for <inline-formula><mml:math id="mm218"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> is <inline-formula><mml:math id="mm219"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></list-item></list></p></sec><sec id="sec4dot4-sensors-17-00668"><title>4.4. Navigation Result Retrieval</title><p>When the querying vehicle <inline-formula><mml:math id="mm220"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> enters the coverage area of <inline-formula><mml:math id="mm221"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, it reads <inline-formula><mml:math id="mm222"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in the OBU, computes <inline-formula><mml:math id="mm223"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>j</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>j</mml:mi><mml:msup><mml:mi>u</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and generates the retrieving query <inline-formula><mml:math id="mm224"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>Q</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p><inline-formula><mml:math id="mm225"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> chooses randomly <inline-formula><mml:math id="mm226"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02208;</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> to compute randomized signature <inline-formula><mml:math id="mm227"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02190;</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mn>1</mml:mn><mml:msubsup><mml:mi>r</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mn>2</mml:mn><mml:msubsup><mml:mi>r</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, the hash value <inline-formula><mml:math id="mm228"><mml:mrow><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mi>j</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>r</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, in which <inline-formula><mml:math id="mm229"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the current time. <inline-formula><mml:math id="mm230"><mml:mrow><mml:mrow><mml:msup><mml:mi>&#x003c4;</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, and sends <inline-formula><mml:math id="mm231"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mi>j</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>&#x003c4;</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to the fog node <inline-formula><mml:math id="mm232"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p>Upon receiving <inline-formula><mml:math id="mm233"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>Q</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm234"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> computes
<disp-formula><mml:math id="mm235"><mml:mrow><mml:mrow><mml:msup><mml:mi>B</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>1</mml:mn><mml:msup><mml:mi>c</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>2</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mi>e</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>2</mml:mn><mml:msup><mml:mi>&#x003c4;</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>
and checks whether the equation <inline-formula><mml:math id="mm236"><mml:mrow><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mi>j</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mn>1</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mn>2</mml:mn><mml:mo>&#x02032;</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> holds. If not, <inline-formula><mml:math id="mm237"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> returns failure and aborts; otherwise, it searches for the navigation result <inline-formula><mml:math id="mm238"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in the database based on <inline-formula><mml:math id="mm239"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>j</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p><p><inline-formula><mml:math id="mm240"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> signs the navigation result using its secret key <inline-formula><mml:math id="mm241"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Randomly choose <inline-formula><mml:math id="mm242"><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> to compute <inline-formula><mml:math id="mm243"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm244"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm245"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mn>3</mml:mn><mml:mi>j</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. Finally, <inline-formula><mml:math id="mm246"><mml:mrow><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> sends the navigation result <inline-formula><mml:math id="mm247"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mn>3</mml:mn><mml:mi>j</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> to <inline-formula><mml:math id="mm248"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p><p>Upon receiving the <inline-formula><mml:math id="mm249"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm250"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> computes <inline-formula><mml:math id="mm251"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mn>4</mml:mn><mml:mi>j</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="script">R</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> and checks whether <inline-formula><mml:math id="mm252"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:msubsup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mrow><mml:mo>*</mml:mo><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mn>4</mml:mn><mml:mi>j</mml:mi></mml:msubsup></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mn>3</mml:mn><mml:mi>j</mml:mi></mml:msubsup></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> holds. If not, <inline-formula><mml:math id="mm253"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> returns failure and aborts; otherwise, it decodes <inline-formula><mml:math id="mm254"><mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> by computing <inline-formula><mml:math id="mm255"><mml:mrow><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mi>u</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="sec4dot5-sensors-17-00668"><title>4.5. Identity Revocation</title><p>Once an accepted message has been disputed, the TA can use the self-delegated certificate <inline-formula><mml:math id="mm256"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> of <inline-formula><mml:math id="mm257"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to revoke the real identity of the disputed vehicle. The TA uses its secret key <inline-formula><mml:math id="mm258"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02208;</mml:mo><mml:msubsup><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> to compute
<disp-formula><mml:math id="mm259"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>A</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>3</mml:mn><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>&#x003b1;</mml:mi></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>&#x003b1;</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>A</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>&#x003b1;</mml:mi></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>&#x003b1;</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mi>A</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msup></mml:mrow></mml:mrow></mml:math></disp-formula>
and can trace the identity <inline-formula><mml:math id="mm260"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> by looking up the entry <inline-formula><mml:math id="mm261"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in the secure database.</p></sec></sec><sec id="sec5-sensors-17-00668"><title>5. Security Analysis</title><p>In this section, we discuss security issues of the proposed navigation scheme SPNS, i.e., authentication, confidentiality, and conditional privacy preservation.</p><p>(1)&#x02003;Authentication</p><p>The identity authentication of vehicles can be guaranteed by the anonymous credentials <inline-formula><mml:math id="mm262"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> issued by the TA through the system setting. For the real-time navigation query, vehicles need to generate some anonymous short-life keys <inline-formula><mml:math id="mm263"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> by themselves, the authentication of which can also be provided by self-delegated certificates <inline-formula><mml:math id="mm264"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> created by using authorized key <italic>A</italic>. Meanwhile, in the spatial crowdsourcing phase, crowdsourcing contributor <inline-formula><mml:math id="mm265"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> can get the reward by showing the certificate of <inline-formula><mml:math id="mm266"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> used in the crowdsourcing response <inline-formula><mml:math id="mm267"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. The identity authentication of fog nodes are also guaranteed by the certificates generated by TA.</p><p>Message authentication can be guaranteed by using randomized signatures [<xref rid="B19-sensors-17-00668" ref-type="bibr">19</xref>] and Schnorr signatures [<xref rid="B22-sensors-17-00668" ref-type="bibr">22</xref>]. In the real-time navigation query phase, vehicles generate signature <inline-formula><mml:math id="mm268"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the navigation information by using short randomized signatures [<xref rid="B19-sensors-17-00668" ref-type="bibr">19</xref>]. In the spatial crowdsourcing phase, vehicle <inline-formula><mml:math id="mm269"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, who wants to perform the crowdsourcing task, returns the crowdsourcing report with a randomized signature <inline-formula><mml:math id="mm270"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> . In addition, when a fog node <inline-formula><mml:math id="mm271"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> finds the optimal path <inline-formula><mml:math id="mm272"><mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, it will generate a signature <inline-formula><mml:math id="mm273"><mml:mrow><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mrow><mml:mo>*</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> by using its secret key <inline-formula><mml:math id="mm274"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> to sign the <inline-formula><mml:math id="mm275"><mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. The security of the signature depends on the discrete algorithm problem in <inline-formula><mml:math id="mm276"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. In the navigation result retrieving phase, vehicles generate signatures of the retrieving query through randomized signatures, and fog nodes create signatures of the navigation result by using Schnorr signatures. Since both short randomized signatures and Schnorr signatures used in our scheme have proven to be unforgeable, the security of signatures generated in our proposed scheme are secure, which guarantees the message authentication.</p><p>(2)&#x02003;Confidentiality</p><p>To avoid navigation information being illegally obtained by unauthorized vehicles or adversaries, our scheme takes advantage of the Elgamal encryption algorithm, AES algorithm and the message-lock encryption algorithm to encrypt the transmitted information including real-time navigation query, crowdsourcing response and the navigation result. If the encryption algorithms used in the proposed scheme are secure, confidentiality requirements can be satisfied.</p><p>First, we consider the anonymous credential. When vehicle <inline-formula><mml:math id="mm277"><mml:mrow><mml:msub><mml:mi mathvariant="script">V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> requests an anonymous credential from the TA, it first picks a random number <inline-formula><mml:math id="mm278"><mml:mrow><mml:mrow><mml:mi>v</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> to compute <inline-formula><mml:math id="mm279"><mml:mrow><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mi>v</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm280"><mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>X</mml:mi><mml:mn>2</mml:mn><mml:mi>v</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, and sends <inline-formula><mml:math id="mm281"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to the TA along with a zero-knowledge proof to prove its knowledge of <italic>v</italic>. Thus, the TA cannot tell the secret key <italic>v</italic> of the vehicle, if the discrete algorithm problem in <inline-formula><mml:math id="mm282"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm283"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is hard. Then, TA computes the anonymous credential <inline-formula><mml:math id="mm284"><mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>k</mml:mi><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> and sends it to the vehicle through a secure channel, so other vehicles can not illegally receive the anonymous credential by eavesdropping messages from the air.</p><p>Second, we consider the navigation query. <inline-formula><mml:math id="mm285"><mml:mrow><mml:msub><mml:mi mathvariant="script">V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> utilizes the public key of the fog node <inline-formula><mml:math id="mm286"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> to encrypt <inline-formula><mml:math id="mm287"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> by computing <inline-formula><mml:math id="mm288"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm289"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm290"><mml:mrow><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo></mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>C</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>D</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="mm291"><mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>), which involves the Elgamal encryption algorithm and AES algorithm. Hence, the confidentiality of the navigation query is guaranteed. Similarly, when the fog node can not find the destination in its coverage, it will transmit the navigation query to the next fog node. The fog node will encrypt the <inline-formula><mml:math id="mm292"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> by using the Elgamal encryption algorithm and AES algorithm. Therefore, no other vehicle can eavesdrop on the route even if they want to go to the same destination.</p><p>Third, we consider the crowdsourcing report. When a vehicle wants to perform the crowdsourcing task, it will generate a traffic information report <inline-formula><mml:math id="mm293"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. To ensure the confidentiality of the report, <inline-formula><mml:math id="mm294"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, we encrypt it by using the message-lock encryption algorithm RCE [<xref rid="B15-sensors-17-00668" ref-type="bibr">15</xref>], which can ensure the confidentiality of the report and avoid the repeated rewarding for the same vehicle.</p><p>Finally, we consider the navigation result. The navigation result <inline-formula><mml:math id="mm295"><mml:mrow><mml:mrow><mml:mi>O</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is encrypted as <inline-formula><mml:math id="mm296"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> by using the public key <inline-formula><mml:math id="mm297"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> of the querying vehicle based on Elgamal encryption. When a vehicle asks for the navigation result, it can decode the navigation result by using its short-life secret key <italic>u</italic>. However, other vehicles can not decrypt the ciphertext <inline-formula><mml:math id="mm298"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mn>3</mml:mn><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. </p><p>(3)&#x02003;Conditional privacy preservation</p><p>In our scheme, although fog nodes can decode <inline-formula><mml:math id="mm299"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>&#x02019;s short-life public key, current location, and the destination by computing <inline-formula><mml:math id="mm300"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>U</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mi>L</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, they can not link this information to some specific vehicle. Because querying vehicle <inline-formula><mml:math id="mm301"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> utilizes anonymous credentials <inline-formula><mml:math id="mm302"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> to prove itself. To prevent dishonest fog nodes or adversaries from linking the navigation query or the retrieving query to a specific vehicle, <inline-formula><mml:math id="mm303"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> provides a randomized version of the credential <inline-formula><mml:math id="mm304"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> when generating signatures. Different versions of <inline-formula><mml:math id="mm305"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are unlinkable because linking <inline-formula><mml:math id="mm306"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="mm307"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>A</mml:mi><mml:mn>2</mml:mn><mml:mi>t</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> for some <inline-formula><mml:math id="mm308"><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="double-struck">Z</mml:mi><mml:mi>q</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is equivalent to breaking the DDH assumption in <inline-formula><mml:math id="mm309"><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>. Furthermore, vehicles use the group signature scheme [<xref rid="B21-sensors-17-00668" ref-type="bibr">21</xref>] to sign messages as <inline-formula><mml:math id="mm310"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, which provides conditional anonymity of the signer.</p><p>In addition, <inline-formula><mml:math id="mm311"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> takes advantage of group signatures [<xref rid="B21-sensors-17-00668" ref-type="bibr">21</xref>] to generate short-life keys <inline-formula><mml:math id="mm312"><mml:mrow><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>C</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="mm313"><mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> for anonymous authentication in the proposed scheme, so only TA can distinguish the real identity of <inline-formula><mml:math id="mm314"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>. When vehicle <inline-formula><mml:math id="mm315"><mml:mrow><mml:msubsup><mml:mi mathvariant="script">V</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>D</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> performs the crowdsourcing task, its anonymity and identity privacy can also be guaranteed by the randomly chosen public key <inline-formula><mml:math id="mm316"><mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p><p>In conclusion, the anonymity, identity privacy and location privacy of the vehicles have been protected in our scheme. However, once an exceptional event occurs, the fog nodes can learn the vehicle&#x02019;s real identifier with the help of TA. The TA can use the self-delegated certificate <inline-formula><mml:math id="mm317"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>&#x003b2;</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> used in the navigation query to trace the identity of the disputed vehicle. Hence, conditional privacy preservation is satisfied in our scheme.</p></sec><sec id="sec6-sensors-17-00668"><title>6. Performance Analysis</title><p>In this section, we evaluate and compare the computational and communication costs of the proposed scheme SPNS with VSPN (VANET-Based Secure and Privacy-Preserving Navigation Scheme) [<xref rid="B23-sensors-17-00668" ref-type="bibr">23</xref>].</p><p>Firstly, let <inline-formula><mml:math id="mm318"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denote the time to perform one point scalar multiplication in <inline-formula><mml:math id="mm319"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi mathvariant="double-struck">G</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, with <inline-formula><mml:math id="mm320"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> the time of AES encryption, <inline-formula><mml:math id="mm321"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> the time of a pairing operation, respectively. Since these operations dominate the speed of the proposed scheme SPNS, we only consider the time taken by these operations and neglect other operations such as one-way hash function, addition and scalar value manipulation. The number of the operations required in each phase of the proposed SPNS are shown in <xref ref-type="table" rid="sensors-17-00668-t002">Table 2</xref>.</p><p>Next, we consider the computational costs of TA, vehicles and fog nodes in our scheme SPNS compared with VSPN [<xref rid="B23-sensors-17-00668" ref-type="bibr">23</xref>]. For the TA side, it is only involved in the system setting and tracing phases. The number of the operations are <inline-formula><mml:math id="mm322"><mml:mrow><mml:mrow><mml:mn>8</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm323"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> in SPNS, compared to <inline-formula><mml:math id="mm324"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm325"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> in the protocol VSPN. For the participant TA side, SPNS is less efficient than VSPN because we need more secure parameters for self-delegating short-life public keys and crowdsourcing tasks, which are not mentioned in VSPN. As shown in <xref ref-type="table" rid="sensors-17-00668-t003">Table 3</xref>, for the vehicles&#x02019; side, our scheme needs more operations in the system setting phase to generate self-delegating short-life public keys, which can enhance the anonymity of the vehicles and also avoid delegating public key certificates by CA. Since our scheme accomplishes enhanced security and privacy, our scheme needs more operations than VSPN. Considering the experiment in [<xref rid="B24-sensors-17-00668" ref-type="bibr">24</xref>] for an MNT (Miyaji, Nakabayashi, Takano) curve [<xref rid="B25-sensors-17-00668" ref-type="bibr">25</xref>] with embedding degree <inline-formula><mml:math id="mm326"><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm327"><mml:mrow><mml:mi mathvariant="double-struck">G</mml:mi></mml:mrow></mml:math></inline-formula> being represented by 161 bits and order <italic>q</italic> being represented by 160 bits, on an Intel Pentium IV 3.0-GHz machine, there exists the following results: <inline-formula><mml:math id="mm328"><mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> ms, <inline-formula><mml:math id="mm329"><mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>4.5</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> ms. Our scheme needs <inline-formula><mml:math id="mm330"><mml:mrow><mml:mrow><mml:mn>1.8</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> ms more to realize the navigation query than VSPN. When retrieving the navigation result from each fog node or RSU, our scheme needs <inline-formula><mml:math id="mm331"><mml:mrow><mml:mrow><mml:mn>1.2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> ms more than VSPN. For the fog node side, since the computational capability is stronger than common RSU in our fog-based VANET model, it is efficient to realize the operations in each phase of our SPNS scheme.</p><p>In terms of the communication overhead, VSPN needs the initial RSU, <inline-formula><mml:math id="mm332"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>U</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, to forward the navigation request <italic>Q</italic> to its neighbors until <italic>Q</italic> reaches the last RSU, <inline-formula><mml:math id="mm333"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>U</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> covering the destination. After <inline-formula><mml:math id="mm334"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>U</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> constructs the navigation reply message, it sends the message back along the reverse path to the initial RSU, <inline-formula><mml:math id="mm335"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>U</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. Furthermore, the querying vehicle can get the the navigation result from the <inline-formula><mml:math id="mm336"><mml:mrow><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>U</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. This procedure needs much communication among RSUs. In contrast to VSPN, our SPNS does not require the fog nodes to return the navigation results to the first fog node. Instead, the querying vehicle can retrieve the navigation result from each fog node and use it to find a proper route to the destination or to the next fog node. In this way, the communication overhead among fog nodes is significantly reduced. <xref ref-type="fig" rid="sensors-17-00668-f002">Figure 2</xref> shows the comparison results of SPNS and VSPN with respect to the average communication burden between two fog nodes.</p></sec><sec id="sec7-sensors-17-00668"><title>7. Related Works</title><p>A number of previous studies have been dedicated to designing real-time VANET-based navigation systems for the last few years. In 2009, Lu [<xref rid="B26-sensors-17-00668" ref-type="bibr">26</xref>] presented a VANET-based parking navigation protocol, which tracks available parking spaces and guides drivers to the available parking spaces. In their protocol, three RSUs are fully trusted, which provide the navigation functions for a vehicle to find a vacant parking space in a parking lot. However, the protocol [<xref rid="B26-sensors-17-00668" ref-type="bibr">26</xref>] can not be used for our navigation purposes. In 2010, another work [<xref rid="B27-sensors-17-00668" ref-type="bibr">27</xref>] gave an application of real-time navigation. In addition to driving guidance, the returned routes of the scheme [<xref rid="B27-sensors-17-00668" ref-type="bibr">27</xref>] were used for opportunistically routing multimedia information such as images and videos of a desired scene to vehicles. In addition, VANET-based navigation systems [<xref rid="B28-sensors-17-00668" ref-type="bibr">28</xref>,<xref rid="B29-sensors-17-00668" ref-type="bibr">29</xref>] also emerged to provide real-time navigation services for drivers on roads. By means of the widely deployed vehicular communication infrastructure, the vehicles only needed the OBUs to enjoy the navigation services. However, the security and privacy issues were not concerned in their schemes.</p><p>Recently, several VANET-based vehicle navigation systems [<xref rid="B23-sensors-17-00668" ref-type="bibr">23</xref>,<xref rid="B30-sensors-17-00668" ref-type="bibr">30</xref>,<xref rid="B31-sensors-17-00668" ref-type="bibr">31</xref>,<xref rid="B32-sensors-17-00668" ref-type="bibr">32</xref>] have been proposed for drivers&#x02019; privacy preservation. Chim et al. [<xref rid="B23-sensors-17-00668" ref-type="bibr">23</xref>] proposed a VANET-based secure and privacy-preserving navigation system, which utilizes the anonymous credentials to provide secure navigation services to drivers. Based on anonymous credentials and the destination, the system can use the real-time road information to search for an available route for drivers in a distributed way. Nevertheless, this system is vulnerable to insider attacks since the system master key is shared among all vehicles. To eliminate the system master key distribution and simplify the anonymous credential acquisition, Cho et al. [<xref rid="B30-sensors-17-00668" ref-type="bibr">30</xref>] introduced a security-enhanced navigation system based on the concept of two person multisignature [<xref rid="B33-sensors-17-00668" ref-type="bibr">33</xref>] and identity-based cryptographic schemes [<xref rid="B34-sensors-17-00668" ref-type="bibr">34</xref>]. However, how to collect traffic information was not considered in their scheme. Sur et al. [<xref rid="B31-sensors-17-00668" ref-type="bibr">31</xref>] pointed out that prior VANET-based secure navigation protocols cannot provide non transferability of anonymous credentials used in their protocols to prevent an insider attacker from sharing her anonymous credentials, and the protocols [<xref rid="B23-sensors-17-00668" ref-type="bibr">23</xref>,<xref rid="B30-sensors-17-00668" ref-type="bibr">30</xref>] are vulnerable to an attacker who can compromise roadside units (RSUs) deployed on the roads. Sur et al. [<xref rid="B31-sensors-17-00668" ref-type="bibr">31</xref>] proposed a secure navigation system based on vehicular cloud from a trapdoor hash function and zero-knowledge proof. However, the anonymous credentials in this system can only be used once for fear of vehicles&#x02019; sharing credentials with unregistered users. Ni et al. [<xref rid="B32-sensors-17-00668" ref-type="bibr">32</xref>] proposed a privacy-preserving real-time navigation system using crowdsourcing. However, their scheme does not take advantage of fog computing, which leads to high efficiency and low-latency.</p><p>Our scheme is based on the idea of randomizing anonymous credentials. Once the fog nodes are compromised, they can not link the navigation query or a retrieving query to a specific vehicle. In this way, it can preserve the privacy of the vehicles. Moreover, the anonymous credentials need not be updated frequently, whereas it can be used for a long time. In our scheme, we utilize fog nodes to issue spatial crowdsourcing tasks to vehicles in their coverage in order to collect real-time road conditions, which guarantee that the retrieving path is real-time and optimal. In addition, the querying vehicle can successively retrieve the navigation result from each fog node when entering its coverage area. This framework is superior to existing solutions, which mainly depend on the assumption that a moving vehicle has to obtain the results from the first fog node, which is quite challenging in reality due to vehicles&#x02019; high moving speed.</p></sec><sec id="sec8-sensors-17-00668"><title>8. Conclusions</title><p>In this paper, we proposed a secure and privacy-preserving real-time navigation system based on fog-based VANETs. We utilized the real-time traffic information to guid the vehicle to a desired destination in a distributed way: fog nodes generate the spatial crowdsourcing task to collect real-time road conditions. Then, each fog node takes advantage of the collected traffic information provided by the vehicles in its coverage to compute the optimal route to the destination. Vehicles can get the continuous optimal route from the fog nodes until it arrives at the desired destination. Moreover, the vehicle performing the crowdsourcing task can get a reasonable reward. Our scheme adopts some security primitives to provide a number of security features: (1) vehicles are authenticated by using zero-knowledge proof and randomized anonymous credentials; (2) messages provided by the vehicles and fog nodes can also be authenticated by means of signatures; (3) navigation queries, traffic information report and navigation results are protected from eavesdroppers. Besides satisfying all security requirements, our scheme provides the conditional privacy-preserving requirements. No one including TA can link up a vehicle&#x02019;s navigation query and its identity. However, the TA can trace the identity of the driver who reports false traffic information. Furthermore, our scheme is efficient in terms of computational and communication overhead. For the future work, we will further improve the effectiveness of our scheme and develop a privacy-preserving parking system using vehicular crowdsourcing based on fog-based VANETs.</p></sec></body><back><ack><title>Acknowledgments</title><p>The research was sponsored by the Fund Project of Domestic Visiting Scholars of Excellent Backbone Teachers of Higher Education Institutions in Shandong Province.</p></ack><notes><title>Author Contributions</title><p>L.L. Wang conceived and designed the schemes; L. Sun performed the experiments; G.Z. Liu analyzed the data; L.L. Wang wrote the paper.</p></notes><notes notes-type="COI-statement"><title>Conflicts of Interest</title><p>The authors declare no conflict of interest. The founding sponsors had no role in the design of the study; in the collection, analyses, or interpretation of data; in the writing of the manuscript, and in the decision to publish the results.</p></notes><ref-list><title>References</title><ref id="B1-sensors-17-00668"><label>1.</label><element-citation publication-type="other"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>J.R.</given-names></name></person-group><article-title>Beijing tops domestic list for traffic congestion</article-title><source>China Daily</source><day>27</day><month>8</month><year>2015</year></element-citation></ref><ref id="B2-sensors-17-00668"><label>2.</label><element-citation publication-type="book"><source>Global Positioning System Standard Positioning Service Signal Specification</source><publisher-name>Navtech GPS Supply</publisher-name><publisher-loc>Springfield, VA, USA</publisher-loc><year>1995</year></element-citation></ref><ref id="B3-sensors-17-00668"><label>3.</label><element-citation publication-type="web"><article-title>Autonavi Navigation</article-title><comment>Available online: <ext-link ext-link-type="uri" xlink:href="http://www.autonavi.com/">http://www.autonavi.com/</ext-link></comment><date-in-citation content-type="access-date" iso-8601-date="2017-03-17">(accessed on 17 March 2017)</date-in-citation><comment>(In Chinese)</comment></element-citation></ref><ref id="B4-sensors-17-00668"><label>4.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Olariu</surname><given-names>S.</given-names></name><name><surname>Hristov</surname><given-names>T.</given-names></name><name><surname>Yan</surname><given-names>G.</given-names></name></person-group><source>The Next Paradigm Shift: From Vehicular Networks to Vehicular Clouds</source><publisher-name>John Wiley &#x00026; Sons, Inc.</publisher-name><publisher-loc>Hoboken, NJ, USA</publisher-loc><year>2013</year><fpage>645</fpage><lpage>700</lpage></element-citation></ref><ref id="B5-sensors-17-00668"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yan</surname><given-names>G.</given-names></name><name><surname>Wen</surname><given-names>D.</given-names></name><name><surname>Olariu</surname><given-names>S.</given-names></name><name><surname>Weigle</surname><given-names>M.C.</given-names></name></person-group><article-title>Security challenges in vehicular cloud computing</article-title><source>IEEE Trans. Intell. Transp. Syst.</source><year>2013</year><volume>14</volume><fpage>284</fpage><lpage>294</lpage><pub-id pub-id-type="doi">10.1109/TITS.2012.2211870</pub-id></element-citation></ref><ref id="B6-sensors-17-00668"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>R.</given-names></name><name><surname>Zhang</surname><given-names>Y.</given-names></name><name><surname>Gjessing</surname><given-names>S.</given-names></name><name><surname>Xia</surname><given-names>W.</given-names></name></person-group><article-title>Toward cloud-based vehicular networks with efficient resource management</article-title><source>IEEE Netw.</source><year>2013</year><volume>27</volume><fpage>48</fpage><lpage>55</lpage><pub-id pub-id-type="doi">10.1109/MNET.2013.6616115</pub-id></element-citation></ref><ref id="B7-sensors-17-00668"><label>7.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bonomi</surname><given-names>F.</given-names></name><name><surname>Milito</surname><given-names>R.</given-names></name><name><surname>Zhu</surname><given-names>J.</given-names></name><name><surname>Addepalli</surname><given-names>S.</given-names></name></person-group><source>Fog Computing and Its Role in the Internet of Things</source><comment>Edition of the MCC Workshop on Mobile Cloud Computing</comment><publisher-name>ACM</publisher-name><publisher-loc>Helsinki, Finland</publisher-loc><day>17</day><month>8</month><year>2012</year><fpage>13</fpage><lpage>16</lpage></element-citation></ref><ref id="B8-sensors-17-00668"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>X.</given-names></name><name><surname>Sun</surname><given-names>X.</given-names></name><name><surname>Ho</surname><given-names>P.H.</given-names></name><name><surname>Shen</surname><given-names>X.</given-names></name></person-group><article-title>GSIS: A secure and privacy-preserving protocol for vehicular communications</article-title><source>IEEE Trans. Veh. Technol.</source><year>2007</year><volume>56</volume><fpage>3442</fpage><lpage>3456</lpage></element-citation></ref><ref id="B9-sensors-17-00668"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>X.</given-names></name><name><surname>Sun</surname><given-names>X.</given-names></name><name><surname>Wang</surname><given-names>X.</given-names></name><name><surname>Ho</surname><given-names>P.H.</given-names></name><name><surname>Shen</surname><given-names>X.</given-names></name></person-group><article-title>TSVC: Timed efficient and secure vehicular communications with privacy preserving</article-title><source>IEEE Trans. Wirel. Commun.</source><year>2009</year><volume>7</volume><fpage>4987</fpage><lpage>4998</lpage><pub-id pub-id-type="doi">10.1109/T-WC.2008.070773</pub-id></element-citation></ref><ref id="B10-sensors-17-00668"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>X.</given-names></name><name><surname>Lu</surname><given-names>R.</given-names></name><name><surname>Zhang</surname><given-names>C.</given-names></name><name><surname>Ho</surname><given-names>P.H.</given-names></name><name><surname>Shen</surname><given-names>X.</given-names></name></person-group><article-title>Security in vehicular ad hoc networks</article-title><source>IEEE Commun. Mag.</source><year>2008</year><volume>46</volume><fpage>88</fpage><lpage>95</lpage></element-citation></ref><ref id="B11-sensors-17-00668"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>R.</given-names></name><name><surname>Lin</surname><given-names>X.</given-names></name><name><surname>Zhu</surname><given-names>H.</given-names></name><name><surname>Ho</surname><given-names>P.H.</given-names></name><name><surname>Shen</surname><given-names>X.</given-names></name></person-group><article-title>A novel anonymous mutual authentication protocol with provable link-layer location privacy</article-title><source>IEEE Trans. Veh. Technol.</source><year>2009</year><volume>58</volume><fpage>1454</fpage><lpage>1466</lpage></element-citation></ref><ref id="B12-sensors-17-00668"><label>12.</label><element-citation publication-type="other"><person-group person-group-type="author"><name><surname>Luan</surname><given-names>T.H.</given-names></name><name><surname>Gao</surname><given-names>L.</given-names></name><name><surname>Li</surname><given-names>Z.</given-names></name><name><surname>Xiang</surname><given-names>Y.</given-names></name><name><surname>Wei</surname><given-names>G.</given-names></name><name><surname>Sun</surname><given-names>L.</given-names></name></person-group><article-title>Fog computing: Focusing on mobile users at the edge</article-title><source>arXiv</source><year>2015</year><pub-id pub-id-type="other">arXiv:1502.01815</pub-id></element-citation></ref><ref id="B13-sensors-17-00668"><label>13.</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Behrendt</surname><given-names>K.</given-names></name><name><surname>Fodero</surname><given-names>K.</given-names></name></person-group><article-title>The perfect time: An examination of time-synchronization techniques</article-title><source>Proceedings of the Distributech</source><conf-loc>San Diego, CA, USA</conf-loc><conf-date>3 January 2005</conf-date></element-citation></ref><ref id="B14-sensors-17-00668"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Galbraith</surname><given-names>S.D.</given-names></name><name><surname>Paterson</surname><given-names>K.G.</given-names></name><name><surname>Smart</surname><given-names>N.P.</given-names></name></person-group><article-title>Pairings for cryptographers</article-title><source>Discr. Appl. Math.</source><year>2008</year><volume>156</volume><fpage>3113</fpage><lpage>3121</lpage><pub-id pub-id-type="doi">10.1016/j.dam.2007.12.010</pub-id></element-citation></ref><ref id="B15-sensors-17-00668"><label>15.</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Bellare</surname><given-names>M.</given-names></name><name><surname>Keelveedhi</surname><given-names>S.</given-names></name><name><surname>Ristenpart</surname><given-names>T.</given-names></name></person-group><article-title>Message-Locked Encryption and Secure Deduplication</article-title><source>Proceedings of the Annual International Conference on the Theory and Applications of Cryptographic Techniques</source><conf-loc>Athens, Greece</conf-loc><conf-date>26&#x02013;30 May 2013</conf-date><volume>Volume 7881</volume><fpage>296</fpage><lpage>312</lpage></element-citation></ref><ref id="B16-sensors-17-00668"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hur</surname><given-names>J.</given-names></name><name><surname>Koo</surname><given-names>D.</given-names></name><name><surname>Shin</surname><given-names>Y.</given-names></name><name><surname>Kang</surname><given-names>K.</given-names></name></person-group><article-title>Secure Data Deduplication with Dynamic Ownership Management in Cloud Storage</article-title><source>IEEE Trans. Knowl. Data Eng.</source><year>2016</year><volume>28</volume><fpage>3113</fpage><lpage>3125</lpage><pub-id pub-id-type="doi">10.1109/TKDE.2016.2580139</pub-id></element-citation></ref><ref id="B17-sensors-17-00668"><label>17.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mao</surname><given-names>B.</given-names></name><name><surname>Jiang</surname><given-names>H.</given-names></name><name><surname>Wu</surname><given-names>S.</given-names></name><name><surname>Tian</surname><given-names>L.</given-names></name></person-group><article-title>Leveraging Data Deduplication to Improve the Performance of Primary Storage Systems in the Cloud</article-title><source>IEEE Trans. Comput.</source><year>2013</year><volume>25</volume><fpage>1775</fpage><lpage>1788</lpage></element-citation></ref><ref id="B18-sensors-17-00668"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yan</surname><given-names>Z.</given-names></name><name><surname>Wang</surname><given-names>M.</given-names></name><name><surname>Li</surname><given-names>Y.</given-names></name><name><surname>Vasilakos</surname><given-names>A.V.</given-names></name></person-group><article-title>Encrypted Data Management with Deduplication in Cloud Computing</article-title><source>IEEE Cloud Comput.</source><year>2016</year><volume>3</volume><fpage>28</fpage><lpage>35</lpage><pub-id pub-id-type="doi">10.1109/MCC.2016.29</pub-id></element-citation></ref><ref id="B19-sensors-17-00668"><label>19.</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Pointcheval</surname><given-names>D.</given-names></name><name><surname>Sanders</surname><given-names>O.</given-names></name></person-group><article-title>Short randomizable signatures</article-title><source>Proceedings of the CT-RSA 2016</source><conf-loc>San Francisco, CA, USA</conf-loc><conf-date>29 February&#x02013;4 March 2016</conf-date><volume>Volume 9610</volume><fpage>111</fpage><lpage>126</lpage></element-citation></ref><ref id="B20-sensors-17-00668"><label>20.</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Camenisch</surname><given-names>J.</given-names></name><name><surname>Lysyanskaya</surname><given-names>A.</given-names></name></person-group><article-title>A signature scheme with efficient protocols</article-title><source>Proceedings of the International Conference on Security in Communication Networks</source><conf-loc>Amalfi, Italy</conf-loc><conf-date>11&#x02013;13 September 2002</conf-date><fpage>268</fpage><lpage>289</lpage></element-citation></ref><ref id="B21-sensors-17-00668"><label>21.</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Chaum</surname><given-names>D.</given-names></name><name><surname>Heyst</surname><given-names>E.V.</given-names></name></person-group><article-title>Group signatures</article-title><source>Proceedings of the Workshop on the Theory and Application of of Cryptographic Techniques</source><conf-loc>Brighton, UK</conf-loc><conf-date>8&#x02013;11 April 1991</conf-date><publisher-name>Springer</publisher-name><publisher-loc>Berlin/Heidelberg, Germany</publisher-loc><year>1991</year><fpage>257</fpage><lpage>265</lpage></element-citation></ref><ref id="B22-sensors-17-00668"><label>22.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Schnorr</surname><given-names>C.P.</given-names></name></person-group><article-title>Efficient Identification and Signatures for Smart Cards</article-title><source>Advances in Cryptology&#x02014; EUROCRYPT&#x02019;89</source><publisher-name>Springer</publisher-name><publisher-loc>Berlin/Heidelberg, Germany</publisher-loc><year>1990</year><fpage>688</fpage><lpage>689</lpage></element-citation></ref><ref id="B23-sensors-17-00668"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chim</surname><given-names>T.W.</given-names></name><name><surname>Yiu</surname><given-names>S.M.</given-names></name><name><surname>Hui</surname><given-names>L.C.K.</given-names></name><name><surname>Li</surname><given-names>V.O.</given-names></name></person-group><article-title>VSPN: VANET-Based Secure and Privacy-Preserving Navigation</article-title><source>IEEE Trans. Comput.</source><year>2014</year><volume>63</volume><fpage>510</fpage><lpage>524</lpage><pub-id pub-id-type="doi">10.1109/TC.2012.188</pub-id></element-citation></ref><ref id="B24-sensors-17-00668"><label>24.</label><element-citation publication-type="web"><person-group person-group-type="author"><name><surname>Scott</surname><given-names>M.</given-names></name></person-group><article-title>Efficient Implementation of Cryptographic pairings</article-title><comment>Available online: <ext-link ext-link-type="uri" xlink:href="http://ecrypt-ss07.rhul.ac.uk/Slides/Thursday/mscottsamos07.pdf">http://ecrypt-ss07.rhul.ac.uk/Slides/Thursday/mscottsamos07.pdf</ext-link></comment><date-in-citation content-type="access-date" iso-8601-date="2016-06-05">(accessed on 5 June 2016)</date-in-citation></element-citation></ref><ref id="B25-sensors-17-00668"><label>25.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miyaji</surname><given-names>A.</given-names></name><name><surname>Nakabayashi</surname><given-names>M.</given-names></name><name><surname>Takano</surname><given-names>S.</given-names></name></person-group><article-title>New explicit conditions of elliptic curve traces for FR-reduction</article-title><source>IEICE Trans. Fundam. Electron. Commun. Comput. Sci.</source><year>2001</year><volume>84</volume><fpage>1234</fpage><lpage>1243</lpage></element-citation></ref><ref id="B26-sensors-17-00668"><label>26.</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Lu</surname><given-names>R.</given-names></name><name><surname>Lin</surname><given-names>X.</given-names></name><name><surname>Zhu</surname><given-names>H.</given-names></name><name><surname>Shen</surname><given-names>X.</given-names></name></person-group><article-title>SPARK: A new VANET-based smart parking scheme for large parking lots</article-title><source>Proceedings of the IEEE INFOCOM</source><conf-loc>Rio De Janeiro, Brazil</conf-loc><conf-date>19&#x02013;25 April 2009</conf-date><fpage>1413</fpage><lpage>1421</lpage></element-citation></ref><ref id="B27-sensors-17-00668"><label>27.</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Leontiadis</surname><given-names>I.</given-names></name><name><surname>Costa</surname><given-names>P.</given-names></name><name><surname>Mascolo</surname><given-names>C.</given-names></name></person-group><article-title>Extending access point connectivity through opportunistic routing in vehicular networks</article-title><source>Proceedings of the Conference on Information Communications</source><conf-loc>San Diego, CA, USA</conf-loc><conf-date>14&#x02013;19 March 2010</conf-date><fpage>1</fpage><lpage>5</lpage></element-citation></ref><ref id="B28-sensors-17-00668"><label>28.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Liu</surname><given-names>C.G.</given-names></name><name><surname>Liu</surname><given-names>I.H.</given-names></name><name><surname>Yang</surname><given-names>T.T.</given-names></name><name><surname>Li</surname><given-names>J.S.</given-names></name></person-group><article-title>Navigation-aware association control in vehicular wireless networks</article-title><source>J. High Speed Netw.</source><year>2013</year><volume>19</volume><fpage>311</fpage><lpage>324</lpage></element-citation></ref><ref id="B29-sensors-17-00668"><label>29.</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>P.Y.</given-names></name><name><surname>Guo</surname><given-names>Y.M.</given-names></name><name><surname>Chen</surname><given-names>W.T.</given-names></name></person-group><article-title>Fuel-saving navigation system in VANETs</article-title><source>Proceedings of the IEEE Vehicular Technology Conference Fall</source><conf-loc>Ottawa, ON, Canada</conf-loc><conf-date>6&#x02013;9 September 2010</conf-date><fpage>1</fpage><lpage>5</lpage></element-citation></ref><ref id="B30-sensors-17-00668"><label>30.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cho</surname><given-names>W.</given-names></name><name><surname>Park</surname><given-names>Y.</given-names></name><name><surname>Sur</surname><given-names>C.</given-names></name><name><surname>Rhee</surname><given-names>K.H.</given-names></name></person-group><article-title>An improved privacy-preserving navigation protocol in VANETs</article-title><source>J. Wirel. Mob. Netw. Ubiquitous Comput. Dependable Appl.</source><year>2013</year><volume>4</volume><fpage>80</fpage><lpage>92</lpage></element-citation></ref><ref id="B31-sensors-17-00668"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sur</surname><given-names>C.</given-names></name><name><surname>Park</surname><given-names>Y.</given-names></name><name><surname>Rhee</surname><given-names>K.H.</given-names></name></person-group><article-title>An efficient and secure navigation protocol based on vehicular cloud</article-title><source>Int. J. Comput. Math.</source><year>2016</year><volume>93</volume><fpage>1</fpage><lpage>20</lpage><pub-id pub-id-type="doi">10.1080/00207160.2014.934685</pub-id></element-citation></ref><ref id="B32-sensors-17-00668"><label>32.</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Ni</surname><given-names>J.B.</given-names></name><name><surname>Lin</surname><given-names>X.D.</given-names></name><name><surname>Zhang</surname><given-names>K.</given-names></name><name><surname>Shen</surname><given-names>X.</given-names></name></person-group><article-title>Privacy-Preserving Real-Time Navigation System Using Vehicular Crowdsourcing</article-title><source>Proceedings of the IEEE 84th Vehicular Technology Conference (VTC2016-Fall)</source><conf-loc>Montr&#x000e9;al, QC, Canada</conf-loc><conf-date>18&#x02013;21 September 2016</conf-date></element-citation></ref><ref id="B33-sensors-17-00668"><label>33.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gentry</surname><given-names>C.</given-names></name><name><surname>Silverberg</surname><given-names>A.</given-names></name></person-group><article-title>Hierarchical ID-Based cryptography</article-title><source>Advances in Cryptology-ASIACRYPT 2002</source><publisher-name>Springer</publisher-name><publisher-loc>Berlin/Heidelberg, Germany</publisher-loc><year>2002</year><fpage>548</fpage><lpage>566</lpage></element-citation></ref><ref id="B34-sensors-17-00668"><label>34.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>L.</given-names></name><name><surname>Cheng</surname><given-names>Z.</given-names></name><name><surname>Smart</surname><given-names>N.P.</given-names></name></person-group><article-title>Identity-based key agreement protocols from pairings</article-title><source>Int. J. Inf. Secur.</source><year>2007</year><volume>6</volume><fpage>213</fpage><lpage>241</lpage><pub-id pub-id-type="doi">10.1007/s10207-006-0011-9</pub-id></element-citation></ref></ref-list></back><floats-group><fig id="sensors-17-00668-f001" orientation="portrait" position="float"><label>Figure 1</label><caption><p>System model.</p></caption><graphic xlink:href="sensors-17-00668-g001"/></fig><fig id="sensors-17-00668-f002" orientation="portrait" position="float"><label>Figure 2</label><caption><p>Communication overhead comparison.</p></caption><graphic xlink:href="sensors-17-00668-g002"/></fig><table-wrap id="sensors-17-00668-t001" orientation="portrait" position="float"><object-id pub-id-type="pii">sensors-17-00668-t001_Table 1</object-id><label>Table 1</label><caption><p>The description of navigation information elements.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="middle" style="border-bottom:solid thin;border-top:solid thin" rowspan="1" colspan="1">Element</th><th align="left" valign="middle" style="border-bottom:solid thin;border-top:solid thin" rowspan="1" colspan="1">Description</th></tr></thead><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1"><italic>N</italic></td><td align="left" valign="middle" rowspan="1" colspan="1">Sequence number: records the query number that is used to distinguish different queries from the same OBU.</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="mm337"><mml:mrow><mml:msup><mml:mi>U</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula></td><td align="left" valign="middle" rowspan="1" colspan="1">Short-life public key: If a vehicle sends a navigation query at some time, it will randomly choose a short-life public key <inline-formula><mml:math id="mm338"><mml:mrow><mml:msup><mml:mi>U</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> from the sequence <inline-formula><mml:math id="mm339"><mml:mrow><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>U</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>C</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="mm340"><mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> stored in the OBU. This field is used to record the public key, which will be also used to reward vehicles in the spatial crowdsourcing step.</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="mm341"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="middle" rowspan="1" colspan="1">Current location: records the current position of the querying vehicle on the unique Euclidean plane.</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="mm342"><mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="middle" rowspan="1" colspan="1">Desired destination: records the destination where the querying vehicle will arrive.</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="mm343"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="middle" rowspan="1" colspan="1">Current time: records the start querying time.</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><inline-formula><mml:math id="mm344"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Expired time: records the exact time after which the query is invalid, because the life-time of the navigation query is fixed.</td></tr></tbody></table></table-wrap><table-wrap id="sensors-17-00668-t002" orientation="portrait" position="float"><object-id pub-id-type="pii">sensors-17-00668-t002_Table 2</object-id><label>Table 2</label><caption><p>Computational cost of each step in SPNS.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="middle" style="border-bottom:solid thin;border-top:solid thin" rowspan="1" colspan="1">Phases</th><th align="left" valign="middle" style="border-bottom:solid thin;border-top:solid thin" rowspan="1" colspan="1">TA</th><th align="left" valign="middle" style="border-bottom:solid thin;border-top:solid thin" rowspan="1" colspan="1">Fog Node</th><th align="left" valign="middle" style="border-bottom:solid thin;border-top:solid thin" rowspan="1" colspan="1">Vehicle</th></tr></thead><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1">System setting</td><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="mm345"><mml:mrow><mml:mrow><mml:mn>8</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="mm346"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula></td><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="mm347"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">Querying</td><td align="left" valign="middle" rowspan="1" colspan="1">0</td><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="mm348"><mml:mrow><mml:mrow><mml:mn>6</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="mm349"><mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">Crowdsourcing</td><td align="left" valign="middle" rowspan="1" colspan="1">0</td><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="mm350"><mml:mrow><mml:mrow><mml:mn>6</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="mm351"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">Retrieving</td><td align="left" valign="middle" rowspan="1" colspan="1">0</td><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="mm352"><mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="mm353"><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>6</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Tracing</td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><inline-formula><mml:math id="mm354"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0</td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0</td></tr></tbody></table><table-wrap-foot><fn><p><italic>m</italic> is the number of the short-life public keys generated by vehicles and <italic>n</italic> is the number of the fog nodes that relay the navigation query; SPNS is our proposed scheme.</p></fn></table-wrap-foot></table-wrap><table-wrap id="sensors-17-00668-t003" orientation="portrait" position="float"><object-id pub-id-type="pii">sensors-17-00668-t003_Table 3</object-id><label>Table 3</label><caption><p>Comparison of vehicles&#x02019; computational cost.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="middle" style="border-bottom:solid thin;border-top:solid thin" rowspan="1" colspan="1">Phases</th><th align="left" valign="middle" style="border-bottom:solid thin;border-top:solid thin" rowspan="1" colspan="1">SPNS</th><th align="left" valign="middle" style="border-bottom:solid thin;border-top:solid thin" rowspan="1" colspan="1">VSPN</th></tr></thead><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1">Setting</td><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="mm355"><mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="mm356"><mml:mrow><mml:mrow><mml:mn>9</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">Querying</td><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="mm357"><mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="mm358"><mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">Crowdsourcing</td><td align="left" valign="middle" rowspan="1" colspan="1"><inline-formula><mml:math id="mm359"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="middle" rowspan="1" colspan="1">0</td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Retrieving</td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><inline-formula><mml:math id="mm360"><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>6</mml:mn><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula></td><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1"><inline-formula><mml:math id="mm361"><mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mi>n</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula></td></tr></tbody></table><table-wrap-foot><fn><p><italic>m</italic> is the number of the short-life public keys generated by vehicles and <italic>n</italic> is the number of the fog nodes that relay the navigation query; SPNS is our proposed scheme; VSPN is the VANET-Based Secure and Privacy-Preserving Navigation Scheme proposed in [<xref rid="B23-sensors-17-00668" ref-type="bibr">23</xref>].</p></fn></table-wrap-foot></table-wrap></floats-group></article>