<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS One</journal-id><journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="pmc">plosone</journal-id><journal-title-group><journal-title>PLoS ONE</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, CA USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">28068341</article-id><article-id pub-id-type="pmc">5221766</article-id><article-id pub-id-type="publisher-id">PONE-D-16-19793</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0163956</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical Sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied Mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and Analysis Methods</subject><subj-group><subject>Simulation and Modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Medical Microbiology</subject><subj-group><subject>Microbiome</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Microbial Genomics</subject><subj-group><subject>Microbiome</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Microbial Genomics</subject><subj-group><subject>Microbiome</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and Health Sciences</subject><subj-group><subject>Gastroenterology and Hepatology</subject><subj-group><subject>Inflammatory Bowel Disease</subject><subj-group><subject>Colitis</subject><subj-group><subject>Ulcerative Colitis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and Health Sciences</subject><subj-group><subject>Oncology</subject><subj-group><subject>Cancer Treatment</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and Analysis Methods</subject><subj-group><subject>Simulation and Modeling</subject><subj-group><subject>Mathematical Modeling</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Nucleic acids</subject><subj-group><subject>RNA</subject><subj-group><subject>Non-coding RNA</subject><subj-group><subject>Ribosomal RNA</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Ribosomes</subject><subj-group><subject>Ribosomal RNA</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular structures and organelles</subject><subj-group><subject>Ribosomes</subject><subj-group><subject>Ribosomal RNA</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Metagenomics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and Health Sciences</subject><subj-group><subject>Pharmaceutics</subject><subj-group><subject>Pharmaceutical Processing Technology</subject><subj-group><subject>Drug Delivery System Preparation</subject><subj-group><subject>Microencapsulation</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories><title-group><article-title>Exploring the Efficacy of Pooled Stools in Fecal Microbiota Transplantation for Microbiota-Associated Chronic Diseases</article-title><alt-title alt-title-type="running-head">Exploring the Efficacy of Pooled Stools in Fecal Microbiota Transplantation for Chronic Diseases</alt-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Kazerouni</surname><given-names>Abbas</given-names></name><xref ref-type="aff" rid="aff001"><sup>1</sup></xref></contrib><contrib contrib-type="author"><name><surname>Wein</surname><given-names>Lawrence M.</given-names></name><xref ref-type="aff" rid="aff002"><sup>2</sup></xref><xref ref-type="corresp" rid="cor001">*</xref></contrib></contrib-group><aff id="aff001"><label>1</label><addr-line>Department of Electrical Engineering, Stanford University, Stanford, California, Unites States of America</addr-line></aff><aff id="aff002"><label>2</label><addr-line>Graduate School of Business, Stanford University, Stanford, California, Unites States of America</addr-line></aff><contrib-group><contrib contrib-type="editor"><name><surname>Cominelli</surname><given-names>Fabio</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1"><addr-line>Case Western Reserve University, UNITED STATES</addr-line></aff><author-notes><fn fn-type="COI-statement" id="coi001"><p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p></fn><fn fn-type="con"><p><list list-type="simple"><list-item><p><bold>Conceptualization:</bold> AK LMW.</p></list-item><list-item><p><bold>Formal analysis:</bold> AK LMW.</p></list-item><list-item><p><bold>Investigation:</bold> AK LMW.</p></list-item><list-item><p><bold>Methodology:</bold> AK LMW.</p></list-item><list-item><p><bold>Software:</bold> AK.</p></list-item><list-item><p><bold>Writing &#x02013; original draft:</bold> AK LMW.</p></list-item></list></p></fn><corresp id="cor001">* E-mail: <email>lwein@stanford.edu</email></corresp></author-notes><pub-date pub-type="collection"><year>2017</year></pub-date><pub-date pub-type="epub"><day>9</day><month>1</month><year>2017</year></pub-date><volume>12</volume><issue>1</issue><elocation-id>e0163956</elocation-id><history><date date-type="received"><day>16</day><month>5</month><year>2016</year></date><date date-type="accepted"><day>16</day><month>9</month><year>2016</year></date></history><permissions><copyright-statement>&#x000a9; 2017 Kazerouni, Wein</copyright-statement><copyright-year>2017</copyright-year><copyright-holder>Kazerouni, Wein</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="pone.0163956.pdf"/><abstract><p>Fecal microbiota transplantation is being assessed as a treatment for chronic microbiota-related diseases such as ulcerative colitis. Results from an initial randomized trial suggest that remission rates depend on unobservable features of the fecal donors and observable features of the patients. We use mathematical modeling to assess the efficacy of pooling stools from different donors during multiple rounds of treatment. In the model, there are two types of patients and two types of donors, where the patient type is observable and the donor type (effective or not effective) is not observable. In the model, clinical outcomes from earlier rounds of treatment are used to estimate the current likelihood that each donor is effective, and then each patient in each round is treated by a pool of donors that are currently deemed to be the most effective. Relative to the no-pooling case, pools of size two or three significantly increase the proportion of patients in remission during the first several rounds of treatment. Although based on data from a single randomized trial, our modeling suggests that pooling of stools &#x02013; via daily cycling of encapsulated stool from several different donors &#x02013; may be beneficial in fecal microbiota transplantation for chronic microbiota-related diseases.</p></abstract><funding-group><funding-statement>The authors received no specific funding for this work.</funding-statement></funding-group><counts><fig-count count="3"/><table-count count="1"/><page-count count="13"/></counts><custom-meta-group><custom-meta id="data-availability"><meta-name>Data Availability</meta-name><meta-value>The minimal data set underlying the findings of this manuscript can all be found in the main text of [2] (Moayyedi et al., 2015).</meta-value></custom-meta></custom-meta-group></article-meta><notes><title>Data Availability</title><p>The minimal data set underlying the findings of this manuscript can all be found in the main text of [2] (Moayyedi et al., 2015).</p></notes></front><body><sec sec-type="intro" id="sec001"><title>Introduction</title><p>Fecal microbiota transplantation (FMT), i.e., stool transplanted from a healthy donor that reconstitutes the normal microbiota community in the gut, is an effective treatment for <italic>Clostridium difficile</italic> infection, achieving a 90% cure rate in recurrent cases [<xref rid="pone.0163956.ref001" ref-type="bibr">1</xref>]. This treatment modality is now being considered for chronic and difficult-to-treat microbiota-associated diseases such as ulcerative colitis (UC). Although results from a placebo-controlled randomized trial of FMT for UC [<xref rid="pone.0163956.ref002" ref-type="bibr">2</xref>] show that FMT is only moderately effective (24% remission probability vs. 5% for placebo), they also reveal two interesting phenomena: remission probabilities are highly dependent on the fecal donor (one of five donors achieved seven of the nine remissions) and on the length of time that a patient has had UC (three of four patients with UC for &#x0003c;1 year experienced remission). While this patient heterogeneity is observable prior to treatment (i.e., via the time with UC), heterogeneity in the efficacy of donor material is not observable prior to treatment under the current state of scientific knowledge; in particular, it is not currently possible to predict whether a donor&#x02019;s stools will lead to remission based on an analysis of 16s rRNA data or a more general metagenomic analysis.</p><p>This unobservable heterogeneity suggests that remission rates might be improved by pooling several different donors&#x02019; stools into each patient; this could be achieved via an encapsulated stool protocol [<xref rid="pone.0163956.ref003" ref-type="bibr">3</xref>] with daily cycling of pills; e.g., if the pool size is two, pills from one donor are given on odd-numbered days and pills from a second donor are administered on even-numbered days. We use mathematical modeling and analysis to propose and assess an adaptive donor allocation policy that statistically infers which donors are effective and then allocates stools (in pool sizes up to five) from the best donors to each patient in each round of treatment.</p></sec><sec sec-type="materials|methods" id="sec002"><title>Methods</title><p>We describe the mathematical model and then propose an algorithm that dynamically assigns patients to donor pools&#x02014;or equivalently, allocates donor pools to patients&#x02014;in a multi-round setting.</p><sec id="sec003"><title>The Model</title><p>We consider two versions of the model, and begin with the aspects of the model that are common to both versions. There are <italic>N</italic><sub>1</sub> patients who have had UC for &#x0003c;1 year and <italic>N</italic><sub>2</sub> patients who have had UC for &#x0003e;1 year; they are referred to as type 1 and type 2 patients. We consider <italic>T</italic> rounds of treatment indexed by <italic>t</italic> = 1, &#x02026;, <italic>T</italic>, and let <italic>D</italic><sub><italic>t</italic></sub> fecal donors be available in treatment round <italic>t</italic>; as explained later, new donors can be added during each round before allocating treatments. Each donor is either effective (referred to as type 1) or ineffective (type 0). The probability that a donor is effective is <italic>p</italic>, although a donor&#x02019;s type is not observable and needs to be estimated from previous treatment results. Treatment results are binary, where patients are either in remission or not in remission after receiving treatment in any given round.</p><p>In each round, each patient receives 14 days of treatment from a particular donor pool. We assume that treatment is persistent; i.e., the treatment outcome from a particular patient-donor pool pair is the same in all rounds of treatment. In particular, if a patient is in remission after treatment from a particular donor pool, then he remains in remission for as long as he receives treatment from this donor pool. Consequently, we assume that if a patient is in remission after treatment in round <italic>t</italic> from a particular donor pool, then that patient continues to receive treatment from this donor pool in rounds <italic>t</italic> + 1, &#x02026;, <italic>T</italic>. Moreover, because a patient who is not in remission after treatment from a particular donor pool would not achieve remission for as long as treatment is continued with this donor pool, all patients who are not in remission after treatment in round <italic>t</italic> are reassigned to a different donor pool in round <italic>t</italic> + 1. Therefore, the proportion of patients in remission at the end of round <italic>t</italic> is nondecreasing in <italic>t</italic>.</p><p>Turning to the effect of pooled donors, because it takes up to 14 days of treatment to observe whether remission is achieved, we assume that daily cycling of pills from several donors (e.g., ABABAB&#x022ef; if there are two donors and ABCABC&#x022ef; if there are three donors, where A, B and C represent different donors) achieves the same outcome as a pooled stool from these donors. While this assumption is likely to hold for small pool sizes (e.g., two or three), the point at which this assumption breaks down has yet to be assessed empirically. In other words, we implicitly assume that&#x02014;regardless of pool size (although we only consider pools up to size five)&#x02014;the probability of engraftment of specific microbes is not lowered due to pooling, and that once the microbes are engrafted, the actual equilibrium and associated clinical outcome would be the same. This assumption is consistent with Lotka-Volterra models of intestinal microbiota [<xref rid="pone.0163956.ref004" ref-type="bibr">4</xref>]-[<xref rid="pone.0163956.ref006" ref-type="bibr">6</xref>], where&#x02014;after a perturbation due to FMT&#x02014;the new microbiota equilibrium in the patient will be independent of the initial quantities of microbes from the donor pool beyond these microbes&#x02019; absence or presence. While it could take longer to attain the new equilibrium if the initial concentration of certain microbes is lower (i.e., due to pooling), the actual equilibrium&#x02014;and hence clinical outcome&#x02014;should be the same.</p><p>Due to the paucity of data about FMT treatment for UC (and, in particular, the absence of data from pooled stools or from multi-round treatments), we consider two versions of the model that differ in their probabilistic assumptions about treatment outcomes, both within a pool of several donors and across rounds of treatment. In the optimistic (in the sense of achieving remission in more patients) scenario referred to as the independence version of the model, we assume that the treatment results from different donors for a particular patient are independent within a pool and independent across rounds. In the pessimistic scenario referred to as the dependence version of the model, we assume that once a patient receives a treatment outcome from a particular donor type, he experiences that same treatment outcome if he receives treatment from another donor of the same type, whether this other donor is in the same pool as the original donor (i.e., in the same round of treatment) or is in a subsequent round of treatment. Another assumption in the dependence version of the model is that the remissions achieved by type 0 donors are a subset of (i.e., subsumed by) the remissions achieved by type 1 donors; i.e., an ineffective donor is incapable of achieving remission in a patient that did not achieve remission from an effective donor, and hence a patient&#x02019;s overall remission probability is independent of the number of previous times that he was unsuccessfully treated by an ineffective donor.</p><p>One way to think about these two versions of the model is that each effective donor possesses an effective unobservable factor (e.g., a microorganism) that achieves a (relatively) high remission probability, and each ineffective donor possesses an ineffective factor that achieves a lower remission probability. In the independence version, there are many of these factors and each donor possesses a different factor (be it effective or ineffective), and the patient is lacking all of these (effective and ineffective) factors; in the dependence version, each effective donor possesses the same effective factor, each ineffective donor possesses the same ineffective factor, each patient is lacking both the effective factor and the ineffective factor, and the effective factor subsumes the ineffective factor.</p><p>We now formulate and analyze the two versions of the model, culminating in the calculation of the posterior marginal probabilities that each donor is effective at the end of each round of treatment. We then present an allocation strategy that applies to both versions of the model.</p></sec><sec id="sec004"><title>The Independence Version of the Model</title><p>In the absence of donor pooling, the remission probability when a donor of type <italic>i</italic> first treats a patient of type <italic>j</italic> is <italic>r</italic><sub><italic>ij</italic></sub> for <italic>i</italic> = 0, 1 and <italic>j</italic> = 1, 2, regardless of when (i.e., which round) the treatment occurs. Hence, a patient can fail treatment from a donor in round <italic>t</italic> and then achieve remission from a different donor of the same type in a later round. If a type <italic>j</italic> donor, in round <italic>t</italic>, is treated by a pool comprised of a mix of <inline-formula id="pone.0163956.e001"><alternatives><graphic xlink:href="pone.0163956.e001.jpg" id="pone.0163956.e001g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M1"><mml:msubsup><mml:mi>s</mml:mi><mml:mn>0</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> ineffective donors and <inline-formula id="pone.0163956.e002"><alternatives><graphic xlink:href="pone.0163956.e002.jpg" id="pone.0163956.e002g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M2"><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> effective donors who have never treated this patient before, then the probability of remission is <inline-formula id="pone.0163956.e003"><alternatives><graphic xlink:href="pone.0163956.e003.jpg" id="pone.0163956.e003g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M3"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mn>0</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mi>t</mml:mi></mml:msubsup></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. Thus, the probability of remission after <italic>t</italic> rounds of treatment for a patient of type <italic>j</italic> is
<disp-formula id="pone.0163956.e004"><alternatives><graphic xlink:href="pone.0163956.e004.jpg" id="pone.0163956.e004g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>&#x003c4;</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:munderover><mml:mrow><mml:mo>[</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mn>0</mml:mn><mml:mi>&#x003c4;</mml:mi></mml:msubsup></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mn>1</mml:mn><mml:mi>&#x003c4;</mml:mi></mml:msubsup></mml:msup><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(1)</label></disp-formula></p><p>The key to the analysis is to compute the posterior marginal probability that donor <italic>d</italic> is of type 1 (i.e., effective) conditioned on all of the treatment results in the first <italic>t</italic> rounds, which is denoted by <italic>&#x003f5;</italic><sub><italic>d</italic></sub>(<italic>t</italic>). To compute this posterior probability, we need to introduce additional notation. Let <italic>s</italic> be the pool size (i.e., the number of donors in a pool), let <inline-formula id="pone.0163956.e005"><alternatives><graphic xlink:href="pone.0163956.e005.jpg" id="pone.0163956.e005g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M5"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>D</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>s</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> be the number of pools of size <italic>s</italic> that can be formed from the <italic>D</italic><sub><italic>t</italic></sub> donors available in round <italic>t</italic>, index these pools by <italic>k</italic> = 1, &#x02026;, <italic>K</italic><sub><italic>t</italic></sub>, and let <italic>A</italic><sub><italic>k</italic></sub> be the set of <italic>s</italic> donors in pool <italic>k</italic>. For each patient <italic>l</italic>, let <inline-formula id="pone.0163956.e006"><alternatives><graphic xlink:href="pone.0163956.e006.jpg" id="pone.0163956.e006g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M6"><mml:msubsup><mml:mi>U</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> be the set of all donors from which he has received unsuccessful treatment by the end of round <italic>t</italic> and <inline-formula id="pone.0163956.e007"><alternatives><graphic xlink:href="pone.0163956.e007.jpg" id="pone.0163956.e007g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M7"><mml:msubsup><mml:mi>V</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> be the set of donors who achieved remission in patient <italic>l</italic> by the end of round <italic>t</italic>. Note that <inline-formula id="pone.0163956.e008"><alternatives><graphic xlink:href="pone.0163956.e008.jpg" id="pone.0163956.e008g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M8"><mml:msubsup><mml:mi>V</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is either empty or contains the donors in the pool that achieved remission in patient <italic>l</italic>. Furthermore, <inline-formula id="pone.0163956.e009"><alternatives><graphic xlink:href="pone.0163956.e009.jpg" id="pone.0163956.e009g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M9"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>&#x02229;</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is empty for all values of <italic>t</italic> and <italic>l</italic> because a patient is never reassigned to a donor from whom he previously received unsuccessful treatment. For <italic>d</italic> = 1, &#x02026;, <italic>D</italic><sub><italic>t</italic></sub>, let donor <italic>d</italic>&#x02019;s type <italic>E</italic><sub><italic>d</italic></sub> equal <italic>i</italic> if donor <italic>d</italic> is of type <italic>i</italic>, for <italic>i</italic> = 0, 1. Given the donors&#x02019; types <italic>E</italic><sub>1</sub> = <italic>e</italic><sub>1</sub>, <italic>E</italic><sub>2</sub> = <italic>e</italic><sub>2</sub>, &#x02026;, <italic>E</italic><sub><italic>D</italic><sub><italic>t</italic></sub></sub> = <italic>e</italic><sub><italic>D</italic><sub><italic>t</italic></sub></sub>, define
<disp-formula id="pone.0163956.e010"><alternatives><graphic xlink:href="pone.0163956.e010.jpg" id="pone.0163956.e010g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>d</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>:</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(2)</label></disp-formula>
<disp-formula id="pone.0163956.e011"><alternatives><graphic xlink:href="pone.0163956.e011.jpg" id="pone.0163956.e011g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>&#x003b2;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>d</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>:</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(3)</label></disp-formula>
<disp-formula id="pone.0163956.e012"><alternatives><graphic xlink:href="pone.0163956.e012.jpg" id="pone.0163956.e012g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>d</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>:</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(4)</label></disp-formula>
and
<disp-formula id="pone.0163956.e013"><alternatives><graphic xlink:href="pone.0163956.e013.jpg" id="pone.0163956.e013g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>&#x003bd;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mi>d</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>:</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(5)</label></disp-formula>
where <bold>e</bold> = (<italic>e</italic><sub>1</sub>, <italic>e</italic><sub>2</sub>, &#x02026;, <italic>e</italic><sub><italic>D</italic><sub><italic>t</italic></sub></sub>). In words, <inline-formula id="pone.0163956.e014"><alternatives><graphic xlink:href="pone.0163956.e014.jpg" id="pone.0163956.e014g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M14"><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0163956.e015"><alternatives><graphic xlink:href="pone.0163956.e015.jpg" id="pone.0163956.e015g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M15"><mml:msubsup><mml:mi>&#x003b2;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> are the number of effective and ineffective donors, respectively, who have unsuccessfully treated patient <italic>l</italic> by the end of round <italic>t</italic>, and <inline-formula id="pone.0163956.e016"><alternatives><graphic xlink:href="pone.0163956.e016.jpg" id="pone.0163956.e016g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M16"><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0163956.e017"><alternatives><graphic xlink:href="pone.0163956.e017.jpg" id="pone.0163956.e017g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M17"><mml:msubsup><mml:mi>&#x003bd;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> are the number of effective and ineffective donors, respectively, who have achieved remission in patient <italic>l</italic> by the end of round <italic>t</italic>. Note that <inline-formula id="pone.0163956.e018"><alternatives><graphic xlink:href="pone.0163956.e018.jpg" id="pone.0163956.e018g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M18"><mml:mrow><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>&#x003bd;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> or 0, depending upon whether or not patient <italic>l</italic> is in remission at the end of round <italic>t</italic>.</p><p>The key to the analysis is the computation of the posterior joint distribution, <inline-formula id="pone.0163956.e019"><alternatives><graphic xlink:href="pone.0163956.e019.jpg" id="pone.0163956.e019g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M19"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">E</mml:mtext><mml:mo>=</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, of each donor&#x02019;s type at the end of each round, given all previous treatment results, <inline-formula id="pone.0163956.e020"><alternatives><graphic xlink:href="pone.0163956.e020.jpg" id="pone.0163956.e020g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M20"><mml:msub><mml:mi mathvariant="script">H</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, where <bold>E</bold> = (<italic>E</italic><sub>1</sub>, <italic>E</italic><sub>2</sub>, &#x02026;, <italic>E</italic><sub><italic>D</italic><sub><italic>t</italic></sub></sub>). The posterior distribution at the end of each round can be updated using only the sufficient statistics <inline-formula id="pone.0163956.e021"><alternatives><graphic xlink:href="pone.0163956.e021.jpg" id="pone.0163956.e021g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M21"><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003b2;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0163956.e022"><alternatives><graphic xlink:href="pone.0163956.e022.jpg" id="pone.0163956.e022g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M22"><mml:msubsup><mml:mi>&#x003bd;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> in Eqs (<xref ref-type="disp-formula" rid="pone.0163956.e010">2</xref>)&#x02013;(<xref ref-type="disp-formula" rid="pone.0163956.e013">5</xref>). For any integer <italic>N</italic>, define [<italic>N</italic>] = {1, 2, &#x02026;, <italic>N</italic>}. Then for <inline-formula id="pone.0163956.e023"><alternatives><graphic xlink:href="pone.0163956.e023.jpg" id="pone.0163956.e023g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M23"><mml:mrow><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, we have
<disp-formula id="pone.0163956.e024"><alternatives><graphic xlink:href="pone.0163956.e024.jpg" id="pone.0163956.e024g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M24"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>[</mml:mo><mml:mtext mathvariant="bold">E</mml:mtext><mml:mo>=</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Z</mml:mi></mml:mfrac><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:munderover><mml:msup><mml:mi>p</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:msup><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:munderover><mml:munder><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003b2;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003bd;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(6)</label></disp-formula>
where <italic>Z</italic> is the normalization constant defined as
<disp-formula id="pone.0163956.e025"><alternatives><graphic xlink:href="pone.0163956.e025.jpg" id="pone.0163956.e025g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M25"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:msup></mml:mrow></mml:munder><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:munderover><mml:msup><mml:mi>p</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:msup><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:munderover><mml:munder><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003b2;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003bd;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(7)</label></disp-formula>
A key observation is that the updated posterior probability at the end of the previous round together with the treatment outcomes observed in the current round are sufficient to update the posterior probability at the end of the current round. Specifically, defining <inline-formula id="pone.0163956.e026"><alternatives><graphic xlink:href="pone.0163956.e026.jpg" id="pone.0163956.e026g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M26"><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>l</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>&#x003b2;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mi>&#x003b2;</mml:mi><mml:mi>l</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>m</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>l</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0163956.e027"><alternatives><graphic xlink:href="pone.0163956.e027.jpg" id="pone.0163956.e027g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M27"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>&#x003bd;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msubsup><mml:mi>&#x003bd;</mml:mi><mml:mi>l</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (which are all observable after treatment in round <italic>t</italic>), and taking
<disp-formula id="pone.0163956.e028"><alternatives><graphic xlink:href="pone.0163956.e028.jpg" id="pone.0163956.e028g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M28"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:msup><mml:mi>p</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msup><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msup></mml:mrow></mml:msub><mml:msubsup><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msubsup><mml:msup><mml:mi>p</mml:mi><mml:msubsup><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(8)</label></disp-formula>
we have, for any <italic>t</italic> = 1, 2, &#x02026;, <italic>T</italic>,
<disp-formula id="pone.0163956.e029"><alternatives><graphic xlink:href="pone.0163956.e029.jpg" id="pone.0163956.e029g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M29"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Z</mml:mi></mml:mfrac><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:munderover><mml:munder><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(9)</label></disp-formula>
where the normalization constant <italic>Z</italic> is
<disp-formula id="pone.0163956.e030"><alternatives><graphic xlink:href="pone.0163956.e030.jpg" id="pone.0163956.e030g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M30"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:msup></mml:mrow></mml:munder><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:munderover><mml:munder><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:munder><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>b</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>n</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(10)</label></disp-formula></p><p>Given the posterior joint probability of donors types in Eqs (<xref ref-type="disp-formula" rid="pone.0163956.e029">9</xref>) and (<xref ref-type="disp-formula" rid="pone.0163956.e030">10</xref>), the posterior marginal probability of each donor <italic>d</italic> being of type 1 at the end of round <italic>t</italic> is
<disp-formula id="pone.0163956.e031"><alternatives><graphic xlink:href="pone.0163956.e031.jpg" id="pone.0163956.e031g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M31"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>&#x003f5;</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>[</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>]</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>:</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mi>P</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(11)</label></disp-formula></p></sec><sec id="sec005"><title>The Dependence Version of the Model</title><p>In the dependence version, we assume perfect temporal dependence in the treatment outcome. More specifically, if a type <italic>j</italic> patient is treated by a pool with at least one effective donor in round 1, then remission is achieved with probability <italic>r</italic><sub>1<italic>j</italic></sub>. But if that patient does not achieve remission, then the patient never achieves remission in any future rounds, regardless of treatment. If a patient is treated by a pool with all ineffective donors in round 1, then remission is achieved with probability <italic>r</italic><sub>0<italic>j</italic></sub>. If remission is not achieved, then the patient never achieves remission in subsequent rounds when treated by a pool with all ineffective donors, and if the patient is subsequently treated by a pool with at least one effective donor, then remission is achieved with probability <inline-formula id="pone.0163956.e032"><alternatives><graphic xlink:href="pone.0163956.e032.jpg" id="pone.0163956.e032g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M32"><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>, so that the patient&#x02019;s overall remission probability is also <italic>r</italic><sub>1<italic>j</italic></sub>.</p><p>The first step in deriving the posterior marginal probability, <italic>&#x003f5;</italic><sub><italic>d</italic></sub>(<italic>t</italic>), that donor <italic>d</italic> is of type 1 at the end of round <italic>t</italic>, is to compute the likelihood <inline-formula id="pone.0163956.e033"><alternatives><graphic xlink:href="pone.0163956.e033.jpg" id="pone.0163956.e033g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M33"><mml:mrow><mml:msubsup><mml:mi>&#x003c0;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> of the data observed for patient <italic>l</italic> of type <italic>j</italic> through the end of round <italic>t</italic>, conditioned on the vector <bold>e</bold> of donor states. This likelihood, which is graphically depicted in <xref ref-type="fig" rid="pone.0163956.g001">Fig 1</xref>, is
<disp-formula id="pone.0163956.e034"><alternatives><graphic xlink:href="pone.0163956.e034.jpg" id="pone.0163956.e034g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M34"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>&#x003c0;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4.pt"/><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="3.33333pt"/><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4.pt"/><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="3.33333pt"/><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4.pt"/><mml:mo>|</mml:mo></mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>|</mml:mo><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="3.33333pt"/></mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4.pt"/><mml:mo>|</mml:mo></mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>|</mml:mo><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="3.33333pt"/></mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="3.33333pt"/><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>|</mml:mo></mml:mrow><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="3.33333pt"/><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4.pt"/><mml:mo>|</mml:mo></mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>|</mml:mo><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="3.33333pt"/></mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="3.33333pt"/><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>|</mml:mo></mml:mrow><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="3.33333pt"/><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4.pt"/><mml:mo>|</mml:mo></mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>|</mml:mo><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="3.33333pt"/></mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="3.33333pt"/><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="3.33333pt"/><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn><mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow/></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4.pt"/><mml:mo>|</mml:mo></mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>|</mml:mo><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="3.33333pt"/></mml:mrow><mml:msubsup><mml:mi>&#x003b1;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="3.33333pt"/><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mi>U</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mo>|</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="3.33333pt"/><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo/></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(12)</label></disp-formula>
where the probability <italic>r</italic><sub>1<italic>j</italic></sub> &#x02212; <italic>r</italic><sub>0<italic>j</italic></sub> is the product of the initial failure 1 &#x02212; <italic>r</italic><sub>0<italic>j</italic></sub> and the subsequent conditional probability of remission, <inline-formula id="pone.0163956.e035"><alternatives><graphic xlink:href="pone.0163956.e035.jpg" id="pone.0163956.e035g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M35"><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula>. Then, for any <inline-formula id="pone.0163956.e036"><alternatives><graphic xlink:href="pone.0163956.e036.jpg" id="pone.0163956.e036g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M36"><mml:mrow><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, the posterior joint probability of donor types at the end of round <italic>t</italic> is
<disp-formula id="pone.0163956.e037"><alternatives><graphic xlink:href="pone.0163956.e037.jpg" id="pone.0163956.e037g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M37"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo>[</mml:mo><mml:mtext mathvariant="bold">E</mml:mtext><mml:mo>=</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>|</mml:mo><mml:msub><mml:mi mathvariant="script">H</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>]</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Z</mml:mi></mml:mfrac><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:munderover><mml:msup><mml:mi>p</mml:mi><mml:msub><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:msup><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:munderover><mml:munder><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:munder><mml:msubsup><mml:mi>&#x003c0;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(13)</label></disp-formula>
where <italic>Z</italic> is the normalization constant defined as
<disp-formula id="pone.0163956.e038"><alternatives><graphic xlink:href="pone.0163956.e038.jpg" id="pone.0163956.e038g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M38"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:msup></mml:mrow></mml:munder><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:munderover><mml:munder><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:munder><mml:msubsup><mml:mi>&#x003c0;</mml:mi><mml:mi>l</mml:mi><mml:mi>t</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mtext mathvariant="bold">e</mml:mtext><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(14)</label></disp-formula>
Given the posterior joint probability of donors types in Eqs (<xref ref-type="disp-formula" rid="pone.0163956.e037">13</xref>) and (<xref ref-type="disp-formula" rid="pone.0163956.e038">14</xref>), the posterior marginal probability of each donor <italic>d</italic> being of type 1 can be computed as in <xref ref-type="disp-formula" rid="pone.0163956.e031">Eq (11)</xref>.</p><fig id="pone.0163956.g001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0163956.g001</object-id><label>Fig 1</label><caption><title>A graphical depiction of <xref ref-type="disp-formula" rid="pone.0163956.e034">Eq (12)</xref>.</title></caption><graphic xlink:href="pone.0163956.g001"/></fig></sec><sec id="sec006"><title>The Allocation Algorithm</title><p>For a given pool size <italic>s</italic> and for a given number of initial donors <italic>D</italic><sub>1</sub>, we consider the following strategy, which applies to both versions of the model, for assigning patients who are not in remission to donor pools over <italic>T</italic> treatment rounds. Our approach is to allocate donor pools consisting of the donors who are most likely to be of type 1 (i.e., effective). Let <inline-formula id="pone.0163956.e039"><alternatives><graphic xlink:href="pone.0163956.e039.jpg" id="pone.0163956.e039g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M39"><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>D</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>s</mml:mi></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> be the number of pools of size <italic>s</italic> that can be formed from the <italic>D</italic><sub><italic>t</italic></sub> donors available in round <italic>t</italic>.</p><p><bold>Step 1: Initially Allocate Patients to Donor Pools in a Balanced Manner</bold>: In round <italic>t</italic> = 1, assign <inline-formula id="pone.0163956.e040"><alternatives><graphic xlink:href="pone.0163956.e040.jpg" id="pone.0163956.e040g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M40"><mml:mrow><mml:mo>&#x0230a;</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>&#x0230b;</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> patients of type 1 and <inline-formula id="pone.0163956.e041"><alternatives><graphic xlink:href="pone.0163956.e041.jpg" id="pone.0163956.e041g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M41"><mml:mrow><mml:mo>&#x0230a;</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>&#x0230b;</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> patients of type 2 to each of the <italic>K</italic><sub>1</sub> donor pools, where &#x0230a;<italic>x</italic>&#x0230b; is the largest integer less than or equal to <italic>x</italic>. The remaining <inline-formula id="pone.0163956.e042"><alternatives><graphic xlink:href="pone.0163956.e042.jpg" id="pone.0163956.e042g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M42"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mo>&#x0230a;</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>&#x0230b;</mml:mo></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> type 1 patients are assigned to pools <inline-formula id="pone.0163956.e043"><alternatives><graphic xlink:href="pone.0163956.e043.jpg" id="pone.0163956.e043g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M43"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mo>&#x0230a;</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>&#x0230b;</mml:mo></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, respectively. If <inline-formula id="pone.0163956.e044"><alternatives><graphic xlink:href="pone.0163956.e044.jpg" id="pone.0163956.e044g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M44"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mo>&#x0230a;</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>&#x0230b;</mml:mo></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mo>&#x0230a;</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>&#x0230b;</mml:mo></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, then assign the remaining <inline-formula id="pone.0163956.e045"><alternatives><graphic xlink:href="pone.0163956.e045.jpg" id="pone.0163956.e045g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M45"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mo>&#x0230a;</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>&#x0230b;</mml:mo></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> type 2 patients to pools <inline-formula id="pone.0163956.e046"><alternatives><graphic xlink:href="pone.0163956.e046.jpg" id="pone.0163956.e046g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M46"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mo>&#x0230a;</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>&#x0230b;</mml:mo></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mo>&#x0230a;</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>&#x0230b;</mml:mo></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mo>&#x0230a;</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>&#x0230b;</mml:mo></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, respectively; otherwise, assign them to pools <inline-formula id="pone.0163956.e047"><alternatives><graphic xlink:href="pone.0163956.e047.jpg" id="pone.0163956.e047g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M47"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mo>&#x0230a;</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>&#x0230b;</mml:mo></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0163956.e048"><alternatives><graphic xlink:href="pone.0163956.e048.jpg" id="pone.0163956.e048g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M48"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mo>&#x0230a;</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>&#x0230b;</mml:mo></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mrow><mml:mo>&#x0230a;</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mfrac><mml:mo>&#x0230b;</mml:mo></mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, respectively. Observe the treatment results in round 1 and let <italic>t</italic> = 2.</p><p><bold>Step 2: Compute Posterior Probabilities:</bold> Given the observations at the end of round <italic>t</italic> &#x02212; 1, compute the posterior marginal probability <italic>&#x003f5;</italic><sub><italic>d</italic></sub>(<italic>t</italic> &#x02212; 1) for each donor <italic>d</italic> = 1, 2, &#x02026;, <italic>D</italic><sub><italic>t</italic>&#x02212;1</sub> using Eqs (<xref ref-type="disp-formula" rid="pone.0163956.e028">8</xref>)&#x02013;(<xref ref-type="disp-formula" rid="pone.0163956.e030">10</xref>) for the independence version and Eqs (<xref ref-type="disp-formula" rid="pone.0163956.e034">12</xref>)&#x02013;(<xref ref-type="disp-formula" rid="pone.0163956.e038">14</xref>) for the dependence version.</p><p><bold>Step 3: Add Naive Donors:</bold> Before allocating treatment, we consider adding naive (i.e., previously unused) donors. At the beginning of round <italic>t</italic>, identify each donor <italic>d</italic> for which the following happens for the first time: he has treated more than <inline-formula id="pone.0163956.e049"><alternatives><graphic xlink:href="pone.0163956.e049.jpg" id="pone.0163956.e049g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M49"><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></alternatives></inline-formula> different patients and his posterior marginal probability is below <italic>p</italic> (i.e., <italic>&#x003f5;</italic><sub><italic>d</italic></sub>(<italic>t</italic> &#x02212; 1) &#x0003c; <italic>p</italic>), where <inline-formula id="pone.0163956.e050"><alternatives><graphic xlink:href="pone.0163956.e050.jpg" id="pone.0163956.e050g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M50"><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is a user-defined parameter. For each of these donors, add a naive donor to the system, form the new pools (combining the old and new donors) and update the posterior joint probability of each donor&#x02019;s type at the end of round <italic>t</italic> &#x02212; 1, which is denoted by <italic>P</italic><sub><italic>t</italic>&#x02212;1</sub>(<italic>e</italic><sub>1</sub>, &#x02026;, <italic>e</italic><sub><italic>D</italic><sub><italic>t</italic>&#x02212;1</sub></sub>) and derived in Eqs (<xref ref-type="disp-formula" rid="pone.0163956.e028">8</xref>)&#x02013;(<xref ref-type="disp-formula" rid="pone.0163956.e030">10</xref>) and (<xref ref-type="disp-formula" rid="pone.0163956.e034">12</xref>)&#x02013;(<xref ref-type="disp-formula" rid="pone.0163956.e038">14</xref>) for the two versions of the model, as follows. If <italic>u</italic> = <italic>D</italic><sub><italic>t</italic></sub> &#x02212; <italic>D</italic><sub><italic>t</italic>&#x02212;1</sub> naive donors are added at this step in round <italic>t</italic>, then
<disp-formula id="pone.0163956.e051"><alternatives><graphic xlink:href="pone.0163956.e051.jpg" id="pone.0163956.e051g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M51"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>u</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>u</mml:mi></mml:munderover><mml:msup><mml:mi>p</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(15)</label></disp-formula>
Also, for the newly added donors <italic>d</italic>, define
<disp-formula id="pone.0163956.e052"><alternatives><graphic xlink:href="pone.0163956.e052.jpg" id="pone.0163956.e052g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M52"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>&#x003f5;</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(16)</label></disp-formula></p><p>Furthermore, if there is a patient who has been treated by more than <italic>D</italic><sub><italic>t</italic></sub> &#x02212; <italic>s</italic> donors and is not in remission (i.e., this patient does not have access to <italic>s</italic> donors who have not treated him yet), we add as many naive donors as necessary for this patient to have a pool of <italic>s</italic> unexplored donors. After adding these naive donors, all the possible pools are formed and <italic>P</italic><sub><italic>t</italic>&#x02212;1</sub>(<bold>e</bold>) and <italic>&#x003f5;</italic><sub><italic>d</italic></sub>(<italic>t</italic> &#x02212; 1) are again updated according to Eqs (<xref ref-type="disp-formula" rid="pone.0163956.e051">15</xref>) and (<xref ref-type="disp-formula" rid="pone.0163956.e052">16</xref>).</p><p><bold>Step 4: Reassign Patients who are not in Remission.</bold> For each patient who is not in remission and among those donors who have not yet treated him, assign the patient to the pool consisting of the <italic>s</italic> donors with the highest values of <italic>&#x003f5;</italic><sub><italic>d</italic></sub>(<italic>t</italic> &#x02212; 1).</p><p><bold>Step 5: Iterate.</bold> Observe the outcome of the new treatments. Increase <italic>t</italic> by one and if <italic>t</italic> &#x02264; <italic>T</italic>, return to Step 2. Otherwise, stop.</p></sec><sec id="sec007"><title>Parameter Estimation</title><p>Four of the 38 patients in [<xref rid="pone.0163956.ref002" ref-type="bibr">2</xref>] had UC &#x0003c;1 year, and we assume that <italic>N</italic><sub>1</sub> = 10 and <italic>N</italic><sub>2</sub> = 90 patients (see <xref ref-type="table" rid="pone.0163956.t001">Table 1</xref> for a list of parameter values). We let <italic>T</italic> = 5 treatment rounds and consider scenarios characterized by various combinations of <italic>D</italic><sub>1</sub> = 5, 10 and 20 initial donors, and pool sizes of <italic>s</italic> = 1, 2, 3, 4 and 5. We note that capacity constraints should not be a problem: each UC patient received <inline-formula id="pone.0163956.e053"><alternatives><graphic xlink:href="pone.0163956.e053.jpg" id="pone.0163956.e053g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M53"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>50</mml:mn><mml:mtext>mL</mml:mtext></mml:mrow><mml:mtext>wk</mml:mtext></mml:mfrac><mml:mo>&#x000d7;</mml:mo><mml:mfrac><mml:mrow><mml:mn>50</mml:mn><mml:mtext>g</mml:mtext></mml:mrow><mml:mrow><mml:mn>300</mml:mn><mml:mtext>mL</mml:mtext></mml:mrow></mml:mfrac><mml:mo>=</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> 8.33 grams of stool per week in [<xref rid="pone.0163956.ref002" ref-type="bibr">2</xref>], while the average production rate per donor is 87.2 g/day [<xref rid="pone.0163956.ref007" ref-type="bibr">7</xref>], implying that each donor is capable of serving <inline-formula id="pone.0163956.e054"><alternatives><graphic xlink:href="pone.0163956.e054.jpg" id="pone.0163956.e054g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M54"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>7</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>87</mml:mn><mml:mo>.</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>8</mml:mn><mml:mo>.</mml:mo><mml:mn>33</mml:mn></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>73</mml:mn><mml:mo>.</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> patients in an ongoing manner. In [<xref rid="pone.0163956.ref002" ref-type="bibr">2</xref>], one donor achieved seven remissions out of 18 patients, and the remaining four donors collectively achieved two remissions out of 20 patients. Consequently, we set <italic>p</italic> = 0.2. In addition, three of four type 1 patients and six of 34 type 2 patients experienced remission, although we do not know how many type 1 patients received donations from the most effective donor in [<xref rid="pone.0163956.ref002" ref-type="bibr">2</xref>]. We arbitrarily set <italic>r</italic><sub>11</sub> = 0.9, and estimate the remaining three remission probabilities by jointly solving <inline-formula id="pone.0163956.e055"><alternatives><graphic xlink:href="pone.0163956.e055.jpg" id="pone.0163956.e055g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M55"><mml:mrow><mml:mfrac><mml:mn>4</mml:mn><mml:mn>38</mml:mn></mml:mfrac><mml:msub><mml:mi>r</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>34</mml:mn><mml:mn>38</mml:mn></mml:mfrac><mml:msub><mml:mi>r</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>7</mml:mn><mml:mn>18</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pone.0163956.e056"><alternatives><graphic xlink:href="pone.0163956.e056.jpg" id="pone.0163956.e056g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M56"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>5</mml:mn></mml:mfrac><mml:msub><mml:mi>r</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>4</mml:mn><mml:mn>5</mml:mn></mml:mfrac><mml:msub><mml:mi>r</mml:mi><mml:mn>01</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>4</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pone.0163956.e057"><alternatives><graphic xlink:href="pone.0163956.e057.jpg" id="pone.0163956.e057g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M57"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>5</mml:mn></mml:mfrac><mml:msub><mml:mi>r</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>4</mml:mn><mml:mn>5</mml:mn></mml:mfrac><mml:msub><mml:mi>r</mml:mi><mml:mn>02</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>6</mml:mn><mml:mn>34</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, which yields <italic>r</italic><sub>12</sub> = 0.329, <italic>r</italic><sub>01</sub> = 0.713 and <italic>r</italic><sub>02</sub> = 0.138.</p><table-wrap id="pone.0163956.t001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0163956.t001</object-id><label>Table 1</label><caption><title>The model&#x02019;s parameters, along with their descriptions and values.</title></caption><alternatives><graphic id="pone.0163956.t001g" xlink:href="pone.0163956.t001"/><table frame="box" rules="all" border="0"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="center" rowspan="1" colspan="1">Parameter</th><th align="center" rowspan="1" colspan="1">Description</th><th align="center" rowspan="1" colspan="1">Value</th></tr></thead><tbody><tr><td align="center" rowspan="1" colspan="1"><italic>N</italic><sub>1</sub></td><td align="center" rowspan="1" colspan="1">number of type 1 (UC &#x0003c; 1 yr) patients</td><td align="center" rowspan="1" colspan="1">10</td></tr><tr><td align="center" rowspan="1" colspan="1"><italic>N</italic><sub>2</sub></td><td align="center" rowspan="1" colspan="1">number of type 2 (UC &#x0003e; 1 yr) patients</td><td align="center" rowspan="1" colspan="1">90</td></tr><tr><td align="center" rowspan="1" colspan="1"><italic>T</italic></td><td align="center" rowspan="1" colspan="1">number of treatment rounds</td><td align="center" rowspan="1" colspan="1">5</td></tr><tr><td align="center" rowspan="1" colspan="1"><italic>D</italic><sub>1</sub></td><td align="center" rowspan="1" colspan="1">initial number of fecal donors</td><td align="center" rowspan="1" colspan="1">5, 10, 20</td></tr><tr><td align="center" rowspan="1" colspan="1"><italic>p</italic></td><td align="center" rowspan="1" colspan="1">proportion of donors that are of type 1 (effective)</td><td align="center" rowspan="1" colspan="1">0.2</td></tr><tr><td align="center" rowspan="1" colspan="1"><italic>r</italic><sub>01</sub></td><td align="center" rowspan="1" colspan="1">remission probability for a type 0 donor and type 1 patient</td><td align="center" rowspan="1" colspan="1">0.713</td></tr><tr><td align="center" rowspan="1" colspan="1"><italic>r</italic><sub>02</sub></td><td align="center" rowspan="1" colspan="1">remission probability for a type 0 donor and type 2 patient</td><td align="center" rowspan="1" colspan="1">0.138</td></tr><tr><td align="center" rowspan="1" colspan="1"><italic>r</italic><sub>11</sub></td><td align="center" rowspan="1" colspan="1">remission probability for a type 1 donor and type 1 patient</td><td align="center" rowspan="1" colspan="1">0.9</td></tr><tr><td align="center" rowspan="1" colspan="1"><italic>r</italic><sub>12</sub></td><td align="center" rowspan="1" colspan="1">remission probability for a type 1 donor and type 2 patient</td><td align="center" rowspan="1" colspan="1">0.329</td></tr><tr><td align="center" rowspan="1" colspan="1"><italic>s</italic></td><td align="center" rowspan="1" colspan="1">pool size</td><td align="center" rowspan="1" colspan="1">1, 2, 3, 4, 5</td></tr><tr><td align="center" rowspan="1" colspan="1">
<inline-formula id="pone.0163956.e058"><alternatives><graphic id="pone.0163956.e058g" xlink:href="pone.0163956.e058"/><mml:math id="M58"><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></alternatives></inline-formula>
</td><td align="center" rowspan="1" colspan="1">minimum sample size before adding a new donor</td><td align="center" rowspan="1" colspan="1">15</td></tr></tbody></table></alternatives></table-wrap></sec></sec><sec sec-type="results" id="sec008"><title>Results</title><p>The proposed algorithm has three user-defined parameters: the threshold <inline-formula id="pone.0163956.e059"><alternatives><graphic xlink:href="pone.0163956.e059.jpg" id="pone.0163956.e059g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M59"><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></alternatives></inline-formula> for adding naive donors, the pool size <italic>s</italic>, and the number of initial donors <italic>D</italic><sub>1</sub>. Fixing <italic>D</italic><sub>1</sub> = 5, we perform an initial comparison of <inline-formula id="pone.0163956.e060"><alternatives><graphic xlink:href="pone.0163956.e060.jpg" id="pone.0163956.e060g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M60"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, 10 and 15 (Fig A in <xref ref-type="supplementary-material" rid="pone.0163956.s001">S1 File</xref>), which reveals that the proportion of patients in remission is very insensitive to <inline-formula id="pone.0163956.e061"><alternatives><graphic xlink:href="pone.0163956.e061.jpg" id="pone.0163956.e061g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M61"><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:math></alternatives></inline-formula> in the independence and dependence versions of the model. Consequently, we use <inline-formula id="pone.0163956.e062"><alternatives><graphic xlink:href="pone.0163956.e062.jpg" id="pone.0163956.e062g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M62"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> throughout the study. For most combinations of pool size <italic>s</italic> = 1, &#x02026;, 5 and number of initial donors <italic>D</italic><sub>1</sub> = 5, 10 and 20 and for the independence and dependence versions of the model (some combinations of high values of (<italic>s</italic>, <italic>D</italic><sub>1</sub>) were computationally intractable, particularly for the dependence version), we simulate <italic>T</italic> = 5 rounds of treatment 200 times and plot <italic>R</italic><sub><italic>t</italic></sub> vs. <italic>t</italic>, where <italic>R</italic><sub><italic>t</italic></sub> is the mean (over the 200 realizations) proportion of patients (of both types) in remission at the end of round <italic>t</italic>, for <italic>t</italic> = 1, &#x02026;, 5. We also compare the performance of our proposed algorithm to that of a random policy, which does not add any naive donors and randomly reassigns each patient who is not in remission to one of the existing donors who has not previously treated them. In the independence version of the model, this policy has a remission proportion at the end of round <italic>t</italic> = 1, &#x02026;, <italic>D</italic><sub>1</sub> of
<disp-formula id="pone.0163956.e063"><alternatives><graphic xlink:href="pone.0163956.e063.jpg" id="pone.0163956.e063g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M63"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>&#x003c4;</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>p</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mi>p</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(17)</label></disp-formula>
and no additional patients achieve remission after round <italic>D</italic><sub>1</sub>. There is no simple analogous expression for this quantity in the dependence version.</p><sec id="sec009"><title>Independence Version of the Model</title><p>We know from <xref ref-type="disp-formula" rid="pone.0163956.e004">Eq (1)</xref> that <italic>R</italic><sub><italic>t</italic></sub> converges to 1.0 as the pool size <italic>s</italic> or the treatment round <italic>t</italic> approaches infinity. Starting with the case where <italic>D</italic><sub>1</sub> = 5 initial donors (<xref ref-type="fig" rid="pone.0163956.g002">Fig 2</xref>), we see that convergence is somewhat rapid: by the end of round 5, over 95% of patients are in remission when <italic>s</italic> &#x02265; 3 (<xref ref-type="fig" rid="pone.0163956.g002">Fig 2</xref>). Although increasing the pool size achieves decreasing returns, there is a large improvement in remission from increasing the pool size from <italic>s</italic> = 1 to <italic>s</italic> = 2 for each of the first five rounds; e.g., at the end of rounds 2 and 3, approximately 50% more patients are in remission when <italic>s</italic> = 2 compared to when <italic>s</italic> = 1. Indeed, the impact from increasing the pool size <italic>s</italic> from 1 to 2 is much larger than the impact from switching from the random policy to the <italic>s</italic> = 1 policy.</p><fig id="pone.0163956.g002" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0163956.g002</object-id><label>Fig 2</label><caption><title>Results for the independence version of the problem with <italic>D</italic><sub>1</sub> = 5 initial donors.</title></caption><graphic xlink:href="pone.0163956.g002"/></fig><p>When the initial number of donors is increased from five to 10, the results are qualitatively identical, although the remission probabilities are slightly higher (Fig Ba in <xref ref-type="supplementary-material" rid="pone.0163956.s001">S1 File</xref>). When the initial number of donors is increased to 20, the remission probability increases relative to the <italic>D</italic><sub>1</sub> = 10 cases when there is no pooling (i.e., <italic>s</italic> = 1), but is very similar to the <italic>D</italic><sub>1</sub> = 10 cases when there is pooling (Fig Bb in <xref ref-type="supplementary-material" rid="pone.0163956.s001">S1 File</xref>). Returning to the base case where <italic>D</italic><sub>1</sub> = 5, we also note that the number of donors in round <italic>t</italic>, <italic>D</italic><sub><italic>t</italic></sub>, increases with the pool size <italic>s</italic>, although the dependence does not have a strong effect until round <italic>t</italic> = 3 (Fig Ca in <xref ref-type="supplementary-material" rid="pone.0163956.s001">S1 File</xref>). The number of donors is nearly linear (i.e., <italic>D</italic><sub><italic>t</italic></sub> = <italic>D</italic><sub>1</sub> + <italic>s</italic>(<italic>t</italic> &#x02212; 1)) for <italic>s</italic> = 4 and 5. For this set of parameter values, the addition of naive donors during step 3 of the algorithm was primarily caused by patients exhausting all available donors, not because donors were deemed ineffective.</p></sec><sec id="sec010"><title>Dependence Version of the Model</title><p>In the dependence version of the model, the maximum remission probability for a type <italic>j</italic> patient is <italic>r</italic><sub>1<italic>j</italic></sub>, and hence <italic>R</italic><sub><italic>t</italic></sub> converges to
<disp-formula id="pone.0163956.e064"><alternatives><graphic xlink:href="pone.0163956.e064.jpg" id="pone.0163956.e064g" mimetype="image" position="anchor" orientation="portrait"/><mml:math id="M64"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>11</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>r</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>3861</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives><label>(18)</label></disp-formula>
as <italic>s</italic> &#x02192; &#x0221e; or <italic>t</italic> &#x02192; &#x0221e;, which is the remission proportion if everyone is eventually treated by a pool with an effective donor. As in the independence version of the model, the remission proportion approaches the asymptotic limit at the end of round 5 for <italic>s</italic> &#x02265; 3 (<xref ref-type="fig" rid="pone.0163956.g003">Fig 3</xref>). As expected, the dependence version achieves much lower remission proportions than the independence version of the model, and few remissions occur after the second round of treatment. The impact of pooling is more modest in this version of the problem, both in absolute and relative increases in <italic>R</italic><sub><italic>t</italic></sub>. In contrast to the independence version, here the improvement from switching from the random policy to the <italic>s</italic> = 1 policy is much larger than the improvement from switching from <italic>s</italic> = 1 to <italic>s</italic> = 2. Nonetheless, improvements from pooling are still meaningful: e.g., at the end of round 2, 15% more patients are in remission if the pool size is increased from <italic>s</italic> = 1 to <italic>s</italic> = 5. Unlike in <xref ref-type="fig" rid="pone.0163956.g002">Fig 2</xref>, the impact of increasing the pool size does not consistently exhibit decreasing returns in <xref ref-type="fig" rid="pone.0163956.g003">Fig 3</xref>. As in the independence version of the model, we see that increasing the number of initial donors from five to 10 gives qualitatively similar results, but with slightly higher remission probabilities (Fig D in <xref ref-type="supplementary-material" rid="pone.0163956.s001">S1 File</xref>). The number of donors in round <italic>t</italic>, <italic>D</italic><sub><italic>t</italic></sub>, is nearly identical in the independence and dependence versions of the model when <italic>D</italic><sub>1</sub> = 5 (Fig Cb in <xref ref-type="supplementary-material" rid="pone.0163956.s001">S1 File</xref>).</p><fig id="pone.0163956.g003" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pone.0163956.g003</object-id><label>Fig 3</label><caption><title>Results for the dependence version of the problem with <italic>D</italic><sub>1</sub> = 5 initial donors.</title></caption><graphic xlink:href="pone.0163956.g003"/></fig></sec><sec id="sec011"><title>Sensitivity Analysis</title><p>The parameter with the most uncertain value is <italic>p</italic>, which is the proportion of donors who are effective. This value may vary for different chronic microbiota-associated diseases, and may increase over time as methods are developed to identify effective donors <italic>a priori</italic> [<xref rid="pone.0163956.ref008" ref-type="bibr">8</xref>]. Fixing <italic>D</italic><sub>1</sub> = 5 initial donors and changing <italic>p</italic> from the base-case value of 0.2 to 0.1 and 0.5, we find that, as expected, the remission probability increases with <italic>p</italic> (Fig E in <xref ref-type="supplementary-material" rid="pone.0163956.s001">S1 File</xref>). The results are qualitatively similar to the base case of <italic>p</italic> = 0.2, except that with no pooling (i.e., <italic>s</italic> = 1) in the <italic>p</italic> = 0.1 case, the performance of the proposed algorithm is very similar to the performance of the random policy, perhaps because of the small expected number of effective initial donors.</p><p>Because there is also uncertainty about whether either of the two versions of the model is accurate, we assess the robustness of our algorithm by supposing that the dependence model is the true model of the system, but that we incorrectly believe that the independence model is the true model. That is, the algorithm uses the posterior probabilities based on the independence version of the model, but we simulate the performance of this algorithm using the true dependence version of the model, and compare it to the performance under the dependence version of the model (i.e., where the algorithm correctly uses the posterior probabilities based on the dependence version). For <italic>D</italic><sub>1</sub> = 5 initial donors and pool sizes of <italic>s</italic> = 1, 2, 3, we see that the algorithm performs reasonably well even when it assumes the wrong version of the model (Fig F in <xref ref-type="supplementary-material" rid="pone.0163956.s001">S1 File</xref>).</p></sec></sec><sec sec-type="conclusions" id="sec012"><title>Discussion</title><p>FMT for treatment of chronic microbiota-associated diseases such as UC is in its infancy. The very little clinical data that have been generated suggest considerable donor heterogeneity in treatment outcomes [<xref rid="pone.0163956.ref002" ref-type="bibr">2</xref>]. While some of this heterogeneity may eventually be explained using 16s rRNA data or metagenomic analysis, it is caused by donor characteristics that are currently unobservable. Unobservable donor heterogeneity and the chronic nature of the disease (and hence the ongoing nature of treatment) suggest that treatment outcomes can be improved by (i) using an adaptive design in multi-round treatment settings, where past treatment results are used to infer donor efficacy and to reassign patients who are not in remission to promising donors, and (ii) pooling stools, which generates a form of combination therapy, as is commonly used to treat cancer, HIV and psychiatric disorders. Here, we use mathematical modeling to assess the potential of approaches (i) and (ii) to improve treatment outcomes.</p><p>Our results suggest that modest (e.g., pool size <italic>s</italic> = 2 or 3) pooling of stools can increase the proportion of patients who achieve remission, particularly in the first few rounds of treatment, although the improvements are smaller under the dependence version of the model than the independence version. These conclusions are robust to the number of initial donors (more specifically, the ratio of the number of patients to the number of initial donors) and the likelihood that each donor is effective. In addition, even with no pooling, performance can be improved by continually updating the likelihood that each donor is effective and adding naive donors when existing donors appear to be ineffective or when patients have explored all current donors.</p><p>Our two versions of the model consider two extreme sets of probabilistic assumptions: independence of treatment results (among different donors in a pool, and across different treatment rounds) and perfect dependence. Although the truth is likely to reside in between these two extremes, these two versions are the natural starting points in the absence of further information. Nonetheless, the fact that pooling provides improvements in both versions of the model suggests that pooling should also be beneficial in the more realistic setting of partially-correlated treatment results. Moreover, our sensitivity analysis, where the algorithm incorrectly assumes the independence version of the model and yet still performs well when the ground truth is the dependence version of the model, suggests that our algorithm is very robust with respect to the underlying probabilistic assumptions in the model.</p><p>Pooling aside, the difference in remission proportions between the two versions of the model is very large. Because the independence and dependence versions of the model can be mapped into a setting with many or one, respectively, effective and ineffective factors (e.g., microorganisms), it is possible to develop intermediate models with several different effective and ineffective factors; alternatively, we could use the multivariate Bernoulli distribution [<xref rid="pone.0163956.ref009" ref-type="bibr">9</xref>] to develop intermediate versions of the model. Our hope is to fit a family of such models to future data from multi-round clinical trials in order to assess the amount of positive correlation that exists, thereby allowing us to both improve our understanding of multi-round FMT treatment for microbiota-related diseases and refine our predictions and recommendations.</p><p>Over the coming years, analyses of 16s rRNA data from donors and patients (or more general metagenomic analysis) may shed light on the underlying factors that determine remission [<xref rid="pone.0163956.ref008" ref-type="bibr">8</xref>]. This new information should allow the concept of optimal pooling to become more refined, by combining stools from donors whose microbiota are complementary to one another and to the patient.</p><p>The pooling assumption&#x02014;in particular, that daily cycling of pills from <italic>s</italic> patients achieves the same clinical outcome as when the stools from <italic>s</italic> donors are actually pooled&#x02014;breaks down for some value of <italic>s</italic>, although this limit has yet to be evaluated empirically. Fortunately, much of the improvement from pooling can be achieved with pool sizes no larger than <italic>s</italic> = 3 (Figs <xref ref-type="fig" rid="pone.0163956.g001">1</xref> and <xref ref-type="fig" rid="pone.0163956.g002">2</xref>), and so the practical benefits of pooling can be realized even if the pooling assumption breaks down at moderate levels of <italic>s</italic>.</p><p>We should also note that&#x02014;to the extent that FMT may be risky&#x02014;e.g., due to the presence of untested agents in stools or to the theoretical risk of becoming more susceptible to chronic conditions such as obesity or autoimmune disorders [<xref rid="pone.0163956.ref010" ref-type="bibr">10</xref>]&#x02014;the use of pooled stools increases the number of donors&#x02014;and thereby the risk&#x02014;that each patient is exposed to. Moreover, if there was an adverse event while pooling was in use, tracing back to a particular donor would be more costly and difficult.</p><p>We conclude with two technical points. In the absence of pooling, it would be straightforward to take a Bayesian approach to this problem&#x02014;i.e., assuming that we have prior distributions of the <italic>r</italic><sub><italic>ij</italic></sub> values that are updated throughout the rounds of treatment&#x02014;using the beta-Bernoulli conjugate pair [<xref rid="pone.0163956.ref011" ref-type="bibr">11</xref>]. However, this approach appears to break down when the pool size <italic>s</italic> &#x0003e; 1, and a Bayesian approach in the presence of pooling remains a topic for future work.</p><p>In addition, our proposed algorithm is not optimal. We also developed a more complicated algorithm that uses the joint probability of donor types in Eqs (<xref ref-type="disp-formula" rid="pone.0163956.e028">8</xref>)&#x02013;(<xref ref-type="disp-formula" rid="pone.0163956.e030">10</xref>) and (<xref ref-type="disp-formula" rid="pone.0163956.e034">12</xref>)&#x02013;(<xref ref-type="disp-formula" rid="pone.0163956.e038">14</xref>) rather than the marginal probabilities in <xref ref-type="disp-formula" rid="pone.0163956.e031">Eq (11)</xref>. Exploratory computational analysis (not shown) suggests that the difference in performance between the two policies is negligible for <italic>s</italic> = 1, 2, 3 (we were unable to get the more complicated algorithm to run in a timely manner for <italic>s</italic> &#x0003e; 3).</p></sec><sec sec-type="conclusions" id="sec013"><title>Conclusion</title><p>We use two extreme probabilistic models&#x02014;one based on statistical independence of treatment outcomes and the other based on perfect dependence&#x02014;to assess the efficacy of pooled stools for FMT in the setting of multiple treatment rounds, where patients are adaptively reassigned to donor pools in each round. We predict that pools of size two or three can increase the proportion of patients in remission during the first few rounds of treatment, with the improvements being larger in the independence version of the model. Because pooling is beneficial at both probabilistic extremes, it is likely to be a robust strategy in practice. However, the remission proportion is much different in the two versions of the model, and this uncertainty cannot be resolved without further clinical data. The two versions of our model map into a setting where there are many factors (e.g., microorganism) or one factor that causes remission, and hence we have developed a framework for a family of models with any number of factors. To gain a better understanding of FMT for chronic diseases, data from future multi-round trials should be fit to a family of these models.</p></sec><sec sec-type="supplementary-material" id="sec014"><title>Supporting Information</title><supplementary-material content-type="local-data" id="pone.0163956.s001"><label>S1 File</label><caption><title>Supporting Material.</title><p>Contains additional figures discussed above.</p><p>(PDF)</p></caption><media xlink:href="pone.0163956.s001.pdf"><caption><p>Click here for additional data file.</p></caption></media></supplementary-material></sec></body><back><ack><p>We thank Mark Smith (OpenBiome) and Thomas Gurry (MIT) for helpful conversations.</p></ack><ref-list><title>References</title><ref id="pone.0163956.ref001"><label>1</label><mixed-citation publication-type="journal">
<name><surname>Kassam</surname><given-names>Z</given-names></name>, <name><surname>Lee</surname><given-names>CH</given-names></name>, <name><surname>Yuan</surname><given-names>Y</given-names></name>, <name><surname>Hunt</surname><given-names>RH</given-names></name>. <article-title>Fecal microbiota transplantation for <italic>Clostridium difficile</italic> infection. systematic review and meta-analysis</article-title>. <source>American Journal Gastroenterology</source>
<year>2013</year>; <volume>108</volume>:<fpage>500</fpage>&#x02013;<lpage>508</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ajg.2013.59">10.1038/ajg.2013.59</ext-link></comment>
<pub-id pub-id-type="pmid">23511459</pub-id></mixed-citation></ref><ref id="pone.0163956.ref002"><label>2</label><mixed-citation publication-type="journal">
<name><surname>Moayyedi</surname><given-names>P</given-names></name>, <name><surname>Surette</surname><given-names>MG</given-names></name>, <name><surname>Kim</surname><given-names>PT</given-names></name>, <name><surname>Libertucci</surname><given-names>J</given-names></name>, <name><surname>Wolfe</surname><given-names>M</given-names></name>, <name><surname>Onischi</surname><given-names>C</given-names></name>, <etal>et al</etal>
<article-title>Fecal microbiota transplantation induces remission in patients with active ulcerative colitis in a randomized controlled trial</article-title>. <source>Gastroenterology</source>
<year>2015</year>; <volume>149</volume>:<fpage>102</fpage>&#x02013;<lpage>109</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1053/j.gastro.2015.04.001">10.1053/j.gastro.2015.04.001</ext-link></comment>
<pub-id pub-id-type="pmid">25857665</pub-id></mixed-citation></ref><ref id="pone.0163956.ref003"><label>3</label><mixed-citation publication-type="journal">
<name><surname>Stollman</surname><given-names>N</given-names></name>, <name><surname>Smith</surname><given-names>M</given-names></name>, <name><surname>Giovanelli</surname><given-names>A</given-names></name>, <name><surname>Mendolia</surname><given-names>G</given-names></name>, <name><surname>Burns</surname><given-names>L</given-names></name>, <name><surname>Didyk</surname><given-names>E</given-names></name>, <etal>et al</etal>
<article-title>Frozen encapsulated stool in recurrent <italic>Clostridium difficule</italic>: exploring the role of pills in the treatment hierarchy of fecal microbiota transplant nonresponders</article-title>. <source>American Journal Gastroenterology</source>
<year>2015</year>; <volume>110</volume>:<fpage>600</fpage>&#x02013;<lpage>601</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ajg.2015.81">10.1038/ajg.2015.81</ext-link></comment></mixed-citation></ref><ref id="pone.0163956.ref004"><label>4</label><mixed-citation publication-type="journal">
<name><surname>Stein</surname><given-names>RR</given-names></name>, <name><surname>Bucci</surname><given-names>V</given-names></name>, <name><surname>Toussaint</surname><given-names>NC</given-names></name>, <name><surname>Buffie</surname><given-names>CG</given-names></name>, <name><surname>Ratsch</surname><given-names>G</given-names></name>, <name><surname>Pamer</surname><given-names>EG</given-names></name>, <etal>et al</etal>
<article-title>Ecological modeling from time-series inference: insight into dynamics and stability of intestinal microbiota</article-title>. <source>PLOS Computational Biology</source>
<year>2013</year>; <volume>9</volume>:<fpage>e1003388</fpage>
<comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003388">10.1371/journal.pcbi.1003388</ext-link></comment>
<pub-id pub-id-type="pmid">24348232</pub-id></mixed-citation></ref><ref id="pone.0163956.ref005"><label>5</label><mixed-citation publication-type="journal">
<name><surname>Marino</surname><given-names>S</given-names></name>, <name><surname>Baxter</surname><given-names>NT</given-names></name>, <name><surname>Huffnagle</surname><given-names>GB</given-names></name>, <name><surname>Petrosino</surname><given-names>JF</given-names></name>, <name><surname>Schloss</surname><given-names>PD</given-names></name>. <article-title>Mathematical modeling of primary succession of murine intestinal microbiota</article-title>. <source>PNAS</source>
<year>2014</year>; <volume>111</volume>:<fpage>439</fpage>&#x02013;<lpage>444</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1311322111">10.1073/pnas.1311322111</ext-link></comment>
<pub-id pub-id-type="pmid">24367073</pub-id></mixed-citation></ref><ref id="pone.0163956.ref006"><label>6</label><mixed-citation publication-type="journal">
<name><surname>Fisher</surname><given-names>CK</given-names></name>, <name><surname>Mehta</surname><given-names>P</given-names></name>. <article-title>Identifying keystone species in the human gut microbiome from metagenomic timeseries using sparse linear regression</article-title>. <source>PLOS ONE</source>
<year>2014</year>; <volume>9</volume>:<fpage>e102451</fpage>
<comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0102451">10.1371/journal.pone.0102451</ext-link></comment>
<pub-id pub-id-type="pmid">25054627</pub-id></mixed-citation></ref><ref id="pone.0163956.ref007"><label>7</label><mixed-citation publication-type="journal">
<name><surname>Kazerouni</surname><given-names>A</given-names></name>, <name><surname>Burgess</surname><given-names>J</given-names></name>, <name><surname>Burns</surname><given-names>LJ</given-names></name>, <name><surname>Wein</surname><given-names>LM</given-names></name>. <article-title>Optimal screening and donor management in a public stool bank</article-title>. <source>Microbiome</source>
<year>2015</year>; <volume>3</volume>:<fpage>75</fpage>
<comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s40168-015-0140-3">10.1186/s40168-015-0140-3</ext-link></comment>
<pub-id pub-id-type="pmid">26675010</pub-id></mixed-citation></ref><ref id="pone.0163956.ref008"><label>8</label><mixed-citation publication-type="other">Vermeire S, Joossens M, Verbake K, Wang J, Machiels K, Sabino J, <etal>et al</etal> Donor species richness determines faecal microbiota transplantation success in inflammatory bowel disease. <italic>J. Crohn&#x02019;s Colitis</italic> 2015.</mixed-citation></ref><ref id="pone.0163956.ref009"><label>9</label><mixed-citation publication-type="journal">
<name><surname>Dai</surname><given-names>B</given-names></name>, <name><surname>Ding</surname><given-names>S</given-names></name>, <name><surname>Wahba</surname><given-names>G</given-names></name>. <article-title>Multivariate Bernoulli distribution</article-title>. <source>Bernoulli</source>
<year>2013</year>; <volume>19</volume>:<fpage>1465</fpage>&#x02013;<lpage>1483</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3150/12-BEJSP10">10.3150/12-BEJSP10</ext-link></comment></mixed-citation></ref><ref id="pone.0163956.ref010"><label>10</label><mixed-citation publication-type="journal">
<name><surname>Smith</surname><given-names>MB</given-names></name>, <name><surname>Kelly</surname><given-names>C</given-names></name>, <name><surname>Alm</surname><given-names>EJ</given-names></name>. <article-title>How to regulate faecal transplants</article-title>. <source>Nature</source>
<year>2014</year>; <volume>506</volume>:<fpage>290</fpage>&#x02013;<lpage>291</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/506290a">10.1038/506290a</ext-link></comment>
<pub-id pub-id-type="pmid">24558658</pub-id></mixed-citation></ref><ref id="pone.0163956.ref011"><label>11</label><mixed-citation publication-type="book">
<name><surname>Berger</surname><given-names>JO</given-names></name>. <source>Statistical decision theory and Bayesian analysis</source>, <edition>second edition</edition>
<publisher-name>Springer-Verlag</publisher-name>, <publisher-loc>New York, NY</publisher-loc>, <year>1980</year>
<comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-1-4757-4286-2">10.1007/978-1-4757-4286-2</ext-link></comment></mixed-citation></ref></ref-list></back></article>