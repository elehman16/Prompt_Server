<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">BMC Med Res Methodol</journal-id><journal-id journal-id-type="iso-abbrev">BMC Med Res Methodol</journal-id><journal-title-group><journal-title>BMC Medical Research Methodology</journal-title></journal-title-group><issn pub-type="epub">1471-2288</issn><publisher><publisher-name>BioMed Central</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">28532387</article-id><article-id pub-id-type="pmc">5441049</article-id><article-id pub-id-type="publisher-id">354</article-id><article-id pub-id-type="doi">10.1186/s12874-017-0354-0</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Robust estimation of the expected survival probabilities from high-dimensional Cox models with biomarker-by-treatment interactions in randomized clinical trials</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Tern&#x000e8;s</surname><given-names>Nils</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Rotolo</surname><given-names>Federico</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6963-2968</contrib-id><name><surname>Michiels</surname><given-names>Stefan</given-names></name><address><phone>+33.1.42.11.41.44</phone><email>stefan.michiels@gustaveroussy.fr</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2284 9388</institution-id><institution-id institution-id-type="GRID">grid.14925.3b</institution-id><institution>Service de Biostatistique et d&#x02019;Epid&#x000e9;miologie, </institution><institution>Gustave Roussy, </institution></institution-wrap>B2M, RdC.114 rue Edouard-Vaillant, 94805 Villejuif, France </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0638 6872</institution-id><institution-id institution-id-type="GRID">grid.463845.8</institution-id><institution/><institution>CESP, Fac. de m&#x000e9;decine - Univ. Paris-Sud, Fac. de m&#x000e9;decine - UVSQ, INSERM, Universit&#x000e9; Paris-Saclay, </institution></institution-wrap>Villejuif, 94805 France </aff></contrib-group><pub-date pub-type="epub"><day>22</day><month>5</month><year>2017</year></pub-date><pub-date pub-type="pmc-release"><day>22</day><month>5</month><year>2017</year></pub-date><pub-date pub-type="collection"><year>2017</year></pub-date><volume>17</volume><elocation-id>83</elocation-id><history><date date-type="received"><day>13</day><month>12</month><year>2016</year></date><date date-type="accepted"><day>27</day><month>4</month><year>2017</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s). 2017</copyright-statement><license license-type="OpenAccess"><license-p>
<bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p></license></permissions><abstract id="Abs1"><sec><title>Background</title><p>Thanks to the advances in genomics and targeted treatments, more and more prediction models based on biomarkers are being developed to predict potential benefit from treatments in a randomized clinical trial. Despite the methodological framework for the development and validation of prediction models in a high-dimensional setting is getting more and more established, no clear guidance exists yet on how to estimate expected survival probabilities in a penalized model with biomarker-by-treatment interactions.</p></sec><sec><title>Methods</title><p>Based on a parsimonious biomarker selection in a penalized high-dimensional Cox model (lasso or adaptive lasso), we propose a unified framework to: estimate internally the predictive accuracy metrics of the developed model (using double cross-validation); estimate the individual survival probabilities at a given timepoint; construct confidence intervals thereof (analytical or bootstrap); and visualize them graphically (pointwise or smoothed with spline). We compared these strategies through a simulation study covering scenarios with or without biomarker effects. We applied the strategies to a large randomized phase III clinical trial that evaluated the effect of adding trastuzumab to chemotherapy in 1574 early breast cancer patients, for which the expression of 462 genes was measured.</p></sec><sec><title>Results</title><p>In our simulations, penalized regression models using the adaptive lasso estimated the survival probability of new patients with low bias and standard error; bootstrapped confidence intervals had empirical coverage probability close to the nominal level across very different scenarios. The double cross-validation performed on the training data set closely mimicked the predictive accuracy of the selected models in external validation data. We also propose a useful visual representation of the expected survival probabilities using splines. In the breast cancer trial, the adaptive lasso penalty selected a prediction model with 4 clinical covariates, the main effects of 98 biomarkers and 24 biomarker-by-treatment interactions, but there was high variability of the expected survival probabilities, with very large confidence intervals.</p></sec><sec><title>Conclusion</title><p>Based on our simulations, we propose a unified framework for: developing a prediction model with biomarker-by-treatment interactions in a&#x000a0;high-dimensional setting and validating it in absence of external data; accurately estimating the expected survival probability of future patients with associated confidence intervals; and graphically visualizing the developed prediction model. All the methods are implemented in the R package biospear, publicly available on the CRAN.</p></sec><sec><title>Electronic supplementary material</title><p>The online version of this article (doi:10.1186/s12874-017-0354-0) contains supplementary material, which is available to authorized users.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Cox model</kwd><kwd>Penalized regression</kwd><kwd>Prediction model</kwd><kwd>Treatment-effect modifiers</kwd><kwd>Prognostic biomarkers</kwd><kwd>Survival estimation</kwd><kwd>Confidence intervals</kwd><kwd>Precision medicine</kwd><kwd>High-dimensional data</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) 2017</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Background</title><p>Thanks to the advances in genomics and targeted treatments, an increasing interest is being devoted to develop prediction models with biomarkers, called treatment-effect modifiers (for which the relative treatment effect varies according to the biomarker values), to predict how much benefit individual patients would derive from specific treatments. This aims at taking the therapeutic decision that fits the best each individual patient. Recently, there have been some attempts to identify prediction models that are associated with higher efficacy of particular treatments such as an 8-gene and a 14-gene signatures (i.e. prediction model) to evaluate the degree of trastuzumab benefit in early breast cancer patients on disease-free survival [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. Statistical methodology has been proposed for the development of prediction models and their validation [<xref ref-type="bibr" rid="CR3">3</xref>, <xref ref-type="bibr" rid="CR4">4</xref>] and to estimate individual predictions in a survival setting [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>]; however, no clear guidance has been yet reached and evaluated in a high-dimensional setting.</p><p>Results from randomized clinical trials are often difficult to translate into predictions for individual patients, but the estimated absolute risk reductions from large randomized trials do still provide the best guidance [<xref ref-type="bibr" rid="CR7">7</xref>]. Therefore, in addition to the challenges coming from the identification of treatment-effect modifiers in a high-dimensional setting, it is also important to identify prognostic biomarkers (i.e. associated with the clinical outcome and independently of treatment) to adjust for the main effect of established clinical and genomic variables in order to obtain individual survival probabilities. Indeed, the clinical impact of a treatment can be judged only with the knowledge of the prognosis of a patient. It is thus of importance to reliably predict the prognosis of patients to assist treatment counseling [<xref ref-type="bibr" rid="CR8">8</xref>].</p><p>The aim of the present study was to propose a unified framework for developing and validating a high-dimensional Cox model [<xref ref-type="bibr" rid="CR9">9</xref>] in a randomized clinical trial to estimate the expected treatment effect according to different values of the biomarkers included in the model, and to estimate survival probabilities for individual patients with associated confidence intervals. We propose different approaches that can be used in this context. We present a simulation study including null (i.e. with no treatment-effect modifier) and alternative scenarios (i.e. with at least one treatment-effect modifier) to evaluate the performance of the proposed approaches. We also illustrate the methods in a large randomized clinical trial of breast cancer patients. Finally, we discuss the findings.</p></sec><sec id="Sec2"><title>Methods</title><p>In the present section we investigate several approaches to: (i) identify a parsimonious Cox regression model in a high-dimensional setting, (ii) estimate internally the predictive accuracy metrics of the selected model, (iii) estimate the expected survival probability for patients, (iv) construct confidence intervals thereof, and (v) visualize them graphically. A schematic representation of the framework is provided in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic representation of the proposed framework. 1CV and 2CV: single and double cross-validation, <italic>&#x00125;</italic>
<sub>0</sub>(<italic>t</italic>) baseline hazard at time <italic>t</italic>, <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \widehat{\alpha},\widehat{\boldsymbol{\beta}},\widehat{\boldsymbol{\gamma}} $$\end{document}</tex-math><mml:math id="M2"><mml:mover accent="true"><mml:mi>&#x003b1;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq1.gif"/></alternatives></inline-formula>: estimated regression parameters, <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\varphi}}_i = {\displaystyle \sum_{j=1}^p}{\widehat{\beta}}_j{X}_{i j} $$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mover accent="true"><mml:mi>&#x003c6;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover></mml:mstyle><mml:msub><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq2.gif"/></alternatives></inline-formula>: prognostic score, <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\eta}}_i = {\displaystyle \sum_{j=1}^p}{\widehat{\gamma}}_j{X}_{i j} $$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover></mml:mstyle><mml:msub><mml:mover accent="true"><mml:mi>&#x003b3;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq3.gif"/></alternatives></inline-formula>: treatment-effect modifying score, <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \widehat{\boldsymbol{\pi}} $$\end{document}</tex-math><mml:math id="M8"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq4.gif"/></alternatives></inline-formula>: entire linear predictor of the selected model, iBrier: integrated Brier score, C: Uno&#x02019;s C-statistic, &#x00394;C: different in arm-specific Uno&#x02019;s C-statistics, <italic>&#x0015c;</italic>(<italic>t</italic>): estimated survival probability at time <italic>t</italic>
</p></caption><graphic xlink:href="12874_2017_354_Fig1_HTML" id="MO1"/></fig>
</p><sec id="Sec3"><title>Identification of a prediction model with treatment-effect modifiers</title><p>The objective of developing a prediction model is to identify a model allowing the computation of a prognostic and a treatment-effect modifying score for each patient. From a statistical viewpoint, Rothwell put forward that the most reliable statistical approach for identifying treatment-effect modifiers is to test the interactions between the biomarkers and the treatment effect [<xref ref-type="bibr" rid="CR7">7</xref>]. Hereinafter, we consider the proportional hazards model<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{l} h\left( t,\  T,\ \boldsymbol{X}\right)={h}_0(t) \exp \left(\alpha T + {\displaystyle \sum_{j=1}^p}{\beta}_j{X}_j + {\displaystyle \sum_{j=1}^p}{\gamma}_j{X}_j T\right)\\ {}={h}_0(t) \exp \left(\alpha T+{\boldsymbol{\beta}}^{\hbox{'}}\boldsymbol{X}+{\boldsymbol{\gamma}}^{\hbox{'}}\boldsymbol{X} T\right),\end{array} $$\end{document}</tex-math><mml:math id="M10"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>h</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mspace width="0.25em"/><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover></mml:mstyle><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mspace width="0.25em"/><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover></mml:mstyle><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>T</mml:mi></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo>'</mml:mo></mml:msup><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfenced><mml:mtext>,</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12874_2017_354_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>
</p><p>where <italic>&#x003b1;</italic>, <bold><italic>&#x003b2;</italic></bold>&#x02009;=&#x02009;(<italic>&#x003b2;</italic>
<sub>1</sub>,&#x000a0;&#x02026;,&#x02009;<italic>&#x003b2;</italic>
<sub><italic>p</italic></sub>)<sup>T</sup> and <bold><italic>&#x003b3;</italic></bold>&#x02009;=&#x02009;(<italic>&#x003b3;</italic>
<sub>1</sub>,&#x02009;&#x02026;,&#x02009;<italic>&#x003b3;</italic>
<sub><italic>p</italic></sub>)<sup>T</sup> are the regression coefficients for: the treatment <italic>T</italic> coded as +0.5 and &#x02212;0.5 for the experimental and control arm, respectively; the main effects of the <italic>p</italic> standardized biomarkers <bold><italic>X</italic></bold>&#x02009;=&#x02009;(<italic>X</italic>
<sub>1</sub>,&#x02009;&#x02026;,&#x02009;<italic>X</italic>
<sub><italic>p</italic></sub>)<sup>T</sup>; and the <italic>p</italic> biomarker-by-treatment interactions, i.e. the product between the standardized biomarkers <bold><italic>X</italic></bold> and the treatment <italic>T</italic>. In other words, the first sum in (<xref rid="Equ1" ref-type="">1</xref>) corresponds to an average prognostic component to the total score and the second sum in (<xref rid="Equ1" ref-type="">1</xref>), corresponds to the treatment-effect modifying component. For simplicity, we do not consider clinical covariates in the presentation of the framework.</p><p>To overcome the nonidentifiability of the models due to the high-dimensional setting, we previously reviewed and proposed several methods to identify a parsimonious model starting from a large number of candidate biomarkers in a randomized clinical trial and to predict the magnitude of the relative treatment effect for future patients [<xref ref-type="bibr" rid="CR10">10</xref>]. Most of these methods are based on penalized regression, which maximizes the penalized partial log-likelihood <italic>l</italic>
<sub><italic>p</italic></sub>(<italic>&#x003b1;</italic>,&#x02009;<bold><italic>&#x003b2;</italic></bold>,&#x02009;<bold><italic>&#x003b3;</italic></bold>,&#x02009;<italic>&#x003bb;</italic>,&#x02009;<italic>T</italic>,<bold><italic>X</italic></bold>) that is the partial log-likelihood <italic>l</italic>(<italic>&#x003b1;</italic>,&#x02009;<bold><italic>&#x003b2;</italic></bold>,&#x02009;<bold><italic>&#x003b3;</italic></bold>,&#x02009;<italic>T</italic>,&#x000a0;<bold><italic>X</italic></bold>) of model (<xref rid="Equ1" ref-type="">1</xref>) minus a penalty:<disp-formula id="Equa"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {l}_p\left(\alpha, \boldsymbol{\beta}, \boldsymbol{\gamma}, \lambda, T,\boldsymbol{X}\right)= l\left(\alpha, \boldsymbol{\beta}, \boldsymbol{\gamma}, \lambda, T,\boldsymbol{X}\right)-\lambda \left({\displaystyle \sum_{j=1}^p}{\theta}_j\left|{\beta}_j\right|+{\displaystyle \sum_{j=1}^p}{\vartheta}_j\left|{\gamma}_j\right|\right). $$\end{document}</tex-math><mml:math id="M12" display="block"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003bb;</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003bb;</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003bb;</mml:mi><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>+</mml:mo></mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:munderover><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover></mml:mstyle><mml:mrow><mml:msub><mml:mi>&#x003d1;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mo>.</mml:mo></mml:math><graphic xlink:href="12874_2017_354_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>
</p><p>In the present work, we implemented two penalties: the lasso [<xref ref-type="bibr" rid="CR11">11</xref>] which corresponds to <italic>&#x003b8;</italic>
<sub><italic>j</italic></sub>&#x02009;=&#x02009;<italic>&#x003d1;</italic>
<sub><italic>j</italic></sub>&#x02009;=&#x02009;1, and the adaptive lasso [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>] which corresponds to <inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\theta}_j=1/\left|{\widehat{\beta}}_j^{\mathrm{R}}\right| $$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true">/</mml:mo><mml:mfenced close="|" open="|"><mml:msubsup><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:msubsup></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq5.gif"/></alternatives></inline-formula>, <inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\vartheta}_j=1/\left|{\widehat{\gamma}}_j^{\mathrm{R}}\right| $$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mrow><mml:mi>&#x003d1;</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>&#x003b3;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:msubsup><mml:mo>|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq6.gif"/></alternatives></inline-formula>, with <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\beta}}_j^{\mathrm{R}} $$\end{document}</tex-math><mml:math id="M18"><mml:msubsup><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq7.gif"/></alternatives></inline-formula> and <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\gamma}}_j^{\mathrm{R}} $$\end{document}</tex-math><mml:math id="M20"><mml:msubsup><mml:mover accent="true"><mml:mi>&#x003b3;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mi mathvariant="normal">R</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq8.gif"/></alternatives></inline-formula> the regression coefficients estimated in a preliminary step through the model (<xref rid="Equ1" ref-type="">1</xref>) subject to the ridge penalty. As compared to the popular lasso penalty, the adaptive lasso penalty was initially proposed as it fulfilled the oracle property [<xref ref-type="bibr" rid="CR14">14</xref>] in the prognostic setting. However, the performance of the oracle property is less known in high-dimensional samples with relatively low number of events. In a time-to-event setting with many candidate biomarker-by-treatment interactions, the adaptive lasso penalty was one of the best performing methods for selecting these interactions in a simulation study in [<xref ref-type="bibr" rid="CR10">10</xref>]. For both the lasso and adaptive lasso, the tuning parameter <italic>&#x003bb;</italic> was determined via a <italic>k</italic>
<sub>1</sub>-fold cross-validation scheme (called 1CV for the rest of the article) by maximizing the cross-validated log-likelihood criterion of the Cox model [<xref ref-type="bibr" rid="CR15">15</xref>]:<disp-formula id="Equb"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ c v l\left(\lambda \right)={\displaystyle \sum_{k=1}^{k_1}}\left({l}_p\left({\widehat{\alpha}}_{- k},{\widehat{\beta}}_{- k},{\widehat{\boldsymbol{\upgamma}}}_{- k},{\lambda}_{- k}, T,\ \boldsymbol{X}\right)-{l}_p\left({\widehat{\alpha}}_{- k},{\widehat{\beta}}_{- k},{\widehat{\boldsymbol{\upgamma}}}_{- k},{\lambda}_{- k},{T}_{- k},\ {\boldsymbol{X}}_{- k}\right)\right), $$\end{document}</tex-math><mml:math id="M22"><mml:mi>c</mml:mi><mml:mi>v</mml:mi><mml:mi>l</mml:mi><mml:mfenced close=")" open="("><mml:mi>&#x003bb;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:munderover></mml:mstyle><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b1;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">&#x003b3;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b1;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">&#x003b3;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mtext>,</mml:mtext></mml:math><graphic xlink:href="12874_2017_354_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>
</p><p>with <italic>k</italic>
<sub>1</sub> = 5 and where <inline-formula id="IEq9"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\alpha}}_{- k} $$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mover accent="true"><mml:mi>&#x003b1;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq9.gif"/></alternatives></inline-formula>, <inline-formula id="IEq10"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\boldsymbol{\beta}}}_{- k} $$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq10.gif"/></alternatives></inline-formula>, <inline-formula id="IEq11"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\boldsymbol{\gamma}}}_{- k} $$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq11.gif"/></alternatives></inline-formula> and the tuning parameter are estimated in the training data excluding the subsample <italic>k</italic>: <italic>T</italic>
<sub>&#x02212;&#x02009;<italic>k</italic></sub> and <bold><italic>X</italic></bold>
<sub>&#x02212;&#x02009;<italic>k</italic></sub>. Penalized regression coefficients are estimated through the R-package glmnet [<xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR17">17</xref>]. We also investigated the &#x0201c;refit adaptive lasso&#x0201d; and the &#x0201c;refit lasso&#x0201d; for which the selected non-zero regression coefficients are re-estimated in an unpenalized Cox regression model.</p></sec><sec id="Sec4"><title>Internal assessment of predictive accuracy of the prediction model</title><p>To assess the performance of a prediction model, some predictive accuracy measures (see the section &#x0201c;Simulation study&#x0201d; for more details) can be used. However, computing these metrics on the same data used to develop the model could lead to over-optimistic predictive accuracy measures and thus, external validation is crucial [<xref ref-type="bibr" rid="CR18">18</xref>]. In the absence of external validation data set, a strategy suggested by Simon et al. [<xref ref-type="bibr" rid="CR19">19</xref>] and illustrated by Matsui et al. [<xref ref-type="bibr" rid="CR3">3</xref>] consists in performing a double cross-validation (2CV) to mimic an external validation. Indeed, patients are first divided into <italic>k</italic>
<sub>2</sub> subsamples (in this work <italic>k</italic>
<sub>2</sub> = 5); then, for each fold, the data in the fold are put apart and the data in the remaining <italic>k</italic>
<sub>2</sub>&#x02009;&#x02212;&#x02009;1 folds are used to estimate the tuning parameter <italic>&#x003bb;</italic> through <italic>k</italic>
<sub>1</sub>-fold cross validation and to estimate the prediction scores of the left-out patients. The process is iterated for all the <italic>k</italic>
<sub>2</sub> folds to estimate the cross-validated prediction scores of the complete data set. Of note, these scores obtained using the 2CV are only used to compute these prediction accuracy metrics, whereas the 2CV is not used elsewhere in this study.</p></sec><sec id="Sec5"><title>Point estimates of the expected survival probability</title><p>From the estimated model (<xref rid="Equ1" ref-type="">1</xref>), the estimation of the expected survival probability of each patient <italic>i</italic>&#x02009;=&#x02009;(1,&#x02009;&#x02026;,&#x000a0;<italic>n</italic>) at time <italic>t</italic> can be obtained by plugging the estimated parameters in the survival function:<disp-formula id="Equc"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{S}}_i(t)=\widehat{S}\left( t,\ {T}_i,\ {\boldsymbol{X}}_{\boldsymbol{i}}\right)= \exp \left(-{\widehat{H}}_0(t)\times \exp \left(\widehat{\alpha}{T}_i + {\displaystyle \sum_{j=1}^p}{\widehat{\beta}}_j{X}_{i j} + {\displaystyle \sum_{j=1}^p}{\widehat{\gamma}}_j{X}_{i j}{T}_i\right)\right), $$\end{document}</tex-math><mml:math id="M30"><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mfenced close=")" open="("><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>&#x000d7;</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mover accent="true"><mml:mi>&#x003b1;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mspace width="0.25em"/><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover></mml:mstyle><mml:msub><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mspace width="0.25em"/><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover></mml:mstyle><mml:msub><mml:mover accent="true"><mml:mi>&#x003b3;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mtext>,</mml:mtext></mml:math><graphic xlink:href="12874_2017_354_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>
</p><p>with <italic>&#x00124;</italic>
<sub>0</sub>(<italic>t</italic>) the cumulative baseline hazard at time <italic>t</italic>, that is commonly estimated through the non-parametric Breslow estimator [<xref ref-type="bibr" rid="CR20">20</xref>].</p></sec><sec id="Sec6"><title>Estimation of confidence intervals of the expected survival probability</title><p>We compared two strategies to estimate the confidence intervals at level 1&#x000a0;&#x02013; <italic>&#x003b8;</italic> of the expected survival probabilities: one based on analytical expressions deriving from the normal approximation of the estimator and one based on a non-parametric bootstrap approach.</p><p>The analytical approach [<xref ref-type="bibr" rid="CR21">21</xref>] consists in estimating the variance of the cumulative risk <italic>&#x00124;</italic>
<sub><italic>i</italic></sub>(<italic>t</italic>)&#x02009;=&#x02009;<italic>&#x00124;</italic>(<italic>t</italic>,&#x02009;<italic>T</italic>
<sub><italic>i</italic></sub>,&#x000a0;<bold><italic>X</italic></bold>
<sub><bold><italic>i</italic></bold></sub>) based on the Breslow estimator [<xref ref-type="bibr" rid="CR22">22</xref>] in the Cox model. Thus, the confidence interval of <italic>&#x0015c;</italic>
<sub><italic>i</italic></sub>(<italic>t</italic>) is approximated as<disp-formula id="Equd"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathrm{CI}}_{1-\theta}\left({\widehat{S}}_i(t)\right)=\left[{q}_{\frac{\theta}{2}}\left({\widehat{S}}_i(t)\right);\ {q}_{1-\frac{\theta}{2}}\left({\widehat{S}}_i(t)\right)\right] $$\end{document}</tex-math><mml:math id="M32"><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mfrac><mml:mi>&#x003b8;</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>;</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mi>&#x003b8;</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12874_2017_354_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>
</p><p>with <inline-formula id="IEq12"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {q}_{\alpha}\left({\widehat{S}}_i(t)\right)= \exp \left(-{\widehat{H}}_i(t)+{z}_{\alpha}\sqrt{\widehat{\mathrm{var}}\left({\widehat{H}}_i(t)\right)}\right). $$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>q</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:msub><mml:msqrt><mml:mrow><mml:mover accent="true"><mml:mtext>var</mml:mtext><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>H</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:msqrt></mml:mrow></mml:mfenced><mml:mtext>.</mml:mtext></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq12.gif"/></alternatives></inline-formula> This can be directly implemented via the R-package survival [<xref ref-type="bibr" rid="CR23">23</xref>]. In the case that penalized coefficients are taken without re-estimation, a practical solution to estimate their standard errors can be to compute the Hessian matrix based on the estimated parameter values.</p><p>The non-parametric bootstrap approach consists in generating <italic>B</italic> bootstrap samples of the original data (<italic>B</italic> = 200 in this work) and in estimating the model (1) for each of them. Thus, <italic>B</italic> models <italic>&#x00125;</italic>
<sub>1</sub>(<italic>t</italic>,&#x02009;<italic>T</italic>,&#x02009;<bold><italic>X</italic></bold>), &#x02026;, <italic>&#x00125;</italic>
<sub><italic>B</italic></sub>(<italic>t</italic>,&#x02009;<italic>T</italic>,&#x02009;<bold><italic>X</italic></bold>) are obtained, allowing to estimate <italic>B</italic> times the expected survival probability for each patient <italic>i</italic> at time <italic>t</italic>, noted <italic>&#x0015c;</italic>
<sub><italic>i</italic>,boot</sub>(<italic>t</italic>) = {<italic>&#x0015c;</italic>
<sub><italic>i</italic>,1</sub>(<italic>t</italic>),&#x000a0;&#x02026;,&#x000a0;<italic>&#x0015c;</italic>
<sub><italic>i</italic>,<italic>B</italic></sub>(<italic>t</italic>)}. Then, the non-parametric confidence interval of the <italic>&#x0015c;</italic>
<sub><italic>i</italic></sub>(<italic>t</italic>) based on the empirical percentiles <italic>q</italic>
<sub><italic>&#x003b1;</italic></sub>(&#x022c5;) of the distribution of <italic>&#x0015c;</italic>
<sub><italic>i</italic>,&#x000a0;boot</sub>(<italic>t</italic>) is given by<disp-formula id="Eque"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathrm{CI}}_{1-\theta}\left({\widehat{S}}_i(t)\right)=\left[{q}_{\frac{\theta}{2}}\left({\widehat{S}}_{i,\ \mathrm{boot}}(t)\right);\ {q}_{1-\frac{\theta}{2}}\left({\widehat{S}}_{i,\ \mathrm{boot}}(t)\right)\right]. $$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mfrac><mml:mi>&#x003b8;</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">boot</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mo>;</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mi>&#x003b8;</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">boot</mml:mi></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mtext>.</mml:mtext></mml:math><graphic xlink:href="12874_2017_354_Article_Eque.gif" position="anchor"/></alternatives></disp-formula>
</p><p>Of note, both the analytical and bootstrap confidence intervals are based on the model (<xref rid="Equ1" ref-type="">1</xref>) which is estimated using a penalty parameter determined via a single cross-validation (1CV).</p></sec><sec id="Sec7"><title>Graphical visualization</title><p>We visualize the expected survival probability of the patients according to their treatment-effect modifying score <inline-formula id="IEq13"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\eta}}_i = {\displaystyle \sum_{j=1}^p}{\widehat{\gamma}}_j{X}_{i j} $$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover></mml:mstyle><mml:msub><mml:mover accent="true"><mml:mi>&#x003b3;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq13.gif"/></alternatives></inline-formula> at a given horizon &#x003c4;. A toy example is used for illustration in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>.<fig id="Fig2"><label>Fig. 2</label><caption><p>Graphical illustration of the expected survival probability at a given timepoint against the treatment-effect modifying ore. Expected survival probability against the treatment-effect modifying score <inline-formula id="IEq14"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \widehat{\eta} $$\end{document}</tex-math><mml:math id="M40"><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq14.gif"/></alternatives></inline-formula> in the setting of: no prognostic biomarker identified and one (<bold>a</bold>) or multiple (<bold>b</bold>) treatment-effect modifiers; multiple prognostic markers and treatment-modifiers in the lowest (<bold>c</bold>) and higher (<bold>d</bold>) prognostic risk group. Dot: point estimate, vertical line: 95% pointwise confidence interval, solid curves: average smoothed splines for point estimates, dashed curves: average smoothed splines for confidence bounds. Graphical illustrations are coming from several selected models based on a simulated dataset from the scenario 6</p></caption><graphic xlink:href="12874_2017_354_Fig2_HTML" id="MO2"/></fig>
</p><p>For the graphical visualization, the scores <inline-formula id="IEq15"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \widehat{\boldsymbol{\eta}}=\left({\widehat{\eta}}_1,\dots, {\widehat{\eta}}_n\right) $$\end{document}</tex-math><mml:math id="M42"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfenced close=")" open="(" separators=",,"><mml:msub><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02026;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq15.gif"/></alternatives></inline-formula> are scaled so that the 2.5% (i.e. <inline-formula id="IEq16"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {q}_{0.025}\left(\widehat{\boldsymbol{\eta}}\right) $$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>q</mml:mi><mml:mn>0.025</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq16.gif"/></alternatives></inline-formula>) and 97.5% (i.e. <inline-formula id="IEq17"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {q}_{0.975}\left(\widehat{\boldsymbol{\eta}}\right) $$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>q</mml:mi><mml:mn>0.975</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq17.gif"/></alternatives></inline-formula>) quantiles equal 0 and 1 respectively in the training set:<disp-formula id="Equf"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\eta}}_i=\frac{{\widehat{\eta}}_i - {q}_{0.025}\left(\widehat{\eta}\right)}{q_{0.975}\left(\widehat{\eta}\right)-{q}_{0.025}\left(\widehat{\eta}\right)}\ . $$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>q</mml:mi><mml:mn>0.025</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>0.975</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>0.025</mml:mn></mml:msub><mml:mfenced close=")" open="("><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mfenced></mml:mrow></mml:mfrac><mml:mspace width="0.25em"/><mml:mtext>.</mml:mtext></mml:math><graphic xlink:href="12874_2017_354_Article_Equf.gif" position="anchor"/></alternatives></disp-formula>
</p><p>In the simplest case in which only one treatment-effect modifier and no prognostic biomarker (<inline-formula id="IEq18"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\beta}}_j=0,\ \forall j $$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mo>&#x02200;</mml:mo><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq18.gif"/></alternatives></inline-formula>) are included in the model, the relationship between <inline-formula id="IEq19"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\eta}}_i $$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq19.gif"/></alternatives></inline-formula> and <italic>&#x0015c;</italic>
<sub><italic>i</italic></sub>(<italic>t</italic>) (and its confidence interval bounds) is strictly monotone (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2a</xref>). However, in the setting of many treatment-effect modifiers and no prognostic biomarker, two patients with equal scores <inline-formula id="IEq20"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\eta}}_i $$\end{document}</tex-math><mml:math id="M54"><mml:msub><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq20.gif"/></alternatives></inline-formula> have the same <italic>&#x0015c;</italic>
<sub><italic>i</italic></sub>(<italic>t</italic>), but their confidence intervals may be different (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2b</xref>), due to different biomarker values. In order to obtain smoothed average confidence bounds, we considered constrained basis splines (B-splines) <italic>spl</italic>(<italic>t</italic>) [<xref ref-type="bibr" rid="CR24">24</xref>]. Splines are numerical functions that can be used for curve-fitting by approximately fitting the data at particular nodes. The number of nodes was estimated through the Akaike Information Criterion (AIC, default criterion in the chosen R-package cobs [<xref ref-type="bibr" rid="CR25">25</xref>]). We also forced the constraint that 0 &#x02264; <italic>spl</italic>(<italic>t</italic>) &#x02264; 1.</p><p>When the model contains also prognostic biomarkers, patients with the same treatment-effect modifying score <inline-formula id="IEq21"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\eta}}_i $$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq21.gif"/></alternatives></inline-formula> may have different survival probability <italic>&#x0015c;</italic>
<sub><italic>i</italic></sub>(<italic>t</italic>) due to different prognostic scores <inline-formula id="IEq22"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\varphi}}_i = {\displaystyle \sum_{j=1}^p}{\widehat{\beta}}_j{X}_{i j}. $$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mover accent="true"><mml:mi>&#x003c6;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>p</mml:mi></mml:munderover></mml:mstyle><mml:msub><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mtext>.</mml:mtext></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq22.gif"/></alternatives></inline-formula> Due to the possible large heterogeneity of <italic>&#x0015c;</italic>
<sub><italic>i</italic></sub>(<italic>t</italic>) for equal scores <inline-formula id="IEq23"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\eta}}_i $$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq23.gif"/></alternatives></inline-formula>, we stratified the treatment-effect modifying plot into four groups according to the prognostic score, using the percentiles proposed by Cox [<xref ref-type="bibr" rid="CR26">26</xref>]: 16.4%, 33.6%, 33.6% and 16.4%. For our toy example, Fig. <xref rid="Fig2" ref-type="fig">2c</xref> and <xref rid="Fig2" ref-type="fig">2d</xref> represent the relationship between <italic>&#x0015c;</italic>
<sub><italic>i</italic></sub>(<italic>t</italic>) and <inline-formula id="IEq24"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\eta}}_i $$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq24.gif"/></alternatives></inline-formula> for the best and worst prognostic risk groups, respectively. Heterogeneity within groups is still present for both point estimates of the expected survival probability and confidence interval bounds; therefore we also considered smoothing the point estimates through B-splines. Even though categorization reduces the available information [<xref ref-type="bibr" rid="CR27">27</xref>], it leads to a more meaningful graphical representation of the prediction model.</p><p>In the rest of the study, we investigated both the <italic>spline</italic> strategy with prognostic categorization and the <italic>pointwise</italic> strategy.</p></sec></sec><sec id="Sec8"><title>Simulation study</title><p>In this section, we present a simulation study covering several null (i.e. with no treatment-effect modifier) and alternative (i.e. with at least one true treatment-effect modifier) scenarios to evaluate the operating characteristics of the different approaches.</p><sec id="Sec9"><title>Data generation and scenarios</title><p>For each simulated data set, we generated <italic>p</italic> = 500 Gaussian unit-variance variables, including prognostic biomarkers and/or treatment-effect modifiers. Data were generated for a total of <italic>n</italic> = 1500 patients, randomly assigned to the experimental or control group with equal probability of 0.5. We generated random survival times <italic>t</italic> with constant hazard. Table&#x000a0;<xref rid="Tab1" ref-type="table">1</xref> shows the three null and three alternative scenarios considered in the simulations. Simulation parameters such as the desired baseline (i.e. <bold>x</bold>&#x02009;=&#x02009;(0,&#x02002;&#x02026;,&#x000a0;0)<sup>T</sup>) survival probability <italic>S</italic>
<sub>0</sub>(&#x022c5;) at the horizon <italic>&#x003c4;</italic> (5&#x000a0;years in our simulations) and the regression parameters <italic>&#x003b1;</italic>, <bold><italic>&#x003b2;</italic></bold> and <bold><italic>&#x003b3;</italic></bold> were chosen on the basis of the early breast cancer trial presented in the section &#x0201c;Application&#x0201d;. Thus, we fixed <italic>S</italic>
<sub>0</sub>(5) = 77%. All the scenarios included censoring and an autoregressive correlation structure [<xref ref-type="bibr" rid="CR28">28</xref>] between biomarkers <inline-formula id="IEq25"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left({\rho}_{j{ j}^{\hbox{'}}}={0.8}^{\left| j-{j}^{\hbox{'}}\right|}\right) $$\end{document}</tex-math><mml:math id="M64"><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msup><mml:mi>j</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>0.8</mml:mn><mml:mfenced close="|" open="|"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:mfenced></mml:msup></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq25.gif"/></alternatives></inline-formula> within 25-biomarker blocks. As sensitivity analyses, we also investigated other values for: the baseline survival probability <italic>S</italic>
<sub>0</sub>(5) (i.e. 50%), the number of biomarkers <italic>p</italic> (i.e. 100 and 1000) and the empirical censoring rate (i.e. between 36% and 62%) to assess their impact on the results. For each scenario, 250 data sets were generated and 250 additional ones were generated for external validation, each with the same parameters as each of the training data sets.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Simulation scenarios</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="2">Scenarios</th><th colspan="3">Effect size</th><th colspan="2">Censoring rate</th></tr><tr><th>
<bold><italic>&#x003b1;</italic></bold>
</th><th>
<bold><italic>&#x003b2;</italic></bold>
<sub><bold><italic>j</italic></bold></sub>
</th><th>
<bold><italic>&#x003b3;</italic></bold>
<sub><bold><italic>j</italic></bold></sub>
</th><th>T<sup>&#x02212;</sup>
</th><th>T<sup>+</sup>
</th></tr></thead><tbody><tr><td>(1) Complete null</td><td>0</td><td>0</td><td>0</td><td>0.72</td><td>0.72</td></tr><tr><td>(2) Treatment effect only</td><td>&#x02212;&#x02009;0.8</td><td>0</td><td>0</td><td>0.62</td><td>0.80</td></tr><tr><td>(3) 20 prognostic markers</td><td>0</td><td>~&#x000a0;<italic>U</italic>(&#x02212;0.05,&#x000a0;&#x02212;&#x02009;0.20)</td><td>0</td><td>0.70</td><td>0.70</td></tr><tr><td>(4) 15 treatment-effect modifiers</td><td>0</td><td>0</td><td>~&#x000a0;<italic>U</italic>(&#x02212;0.10,&#x000a0;&#x02212;&#x02009;0.40)</td><td>0.71</td><td>0.71</td></tr><tr><td>(5) Treatment effect&#x02009;+&#x02009;(4)</td><td>&#x02212;&#x02009;0.8</td><td>0</td><td>~&#x000a0;<italic>U</italic>(&#x02212;0.10,&#x000a0;&#x02212;&#x02009;0.40)</td><td>0.61</td><td>0.78</td></tr><tr><td>(6) 20 prognostic markers&#x02009;+&#x02009;(5)</td><td>&#x02212;&#x02009;0.8</td><td>~&#x000a0;<italic>U</italic>(&#x02212;0.05,&#x000a0;&#x02212;&#x02009;0.20)</td><td>~&#x000a0;<italic>U</italic>(&#x02212;0.10,&#x000a0;&#x02212;&#x02009;0.40)</td><td>0.60</td><td>0.76</td></tr></tbody></table><table-wrap-foot><p>T<sup>+</sup>: experimental arm, T<sup>&#x02212;</sup>: control arm</p></table-wrap-foot></table-wrap>
</p></sec><sec id="Sec10"><title>Evaluation criteria</title><p>All the evaluation criteria have been measured at <italic>&#x003c4;</italic>&#x02009;=&#x02009;5 years.</p><p>
<bold>Integrated brier score.</bold> As a measure of overall prediction error of the models, we used the integrated Brier score (iBrier score, [<xref ref-type="bibr" rid="CR29">29</xref>]). The time-dependent Brier score is a quadratic score based on the predicted time-dependent survival probability defined by<disp-formula id="Equg"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{Brier}\left(\tau \right) = \frac{1}{n}{\displaystyle \sum_{i=1}^n}\left[\frac{{\left({\widehat{S}}_C\left({t}_i\right)\right)}^2\mathbf{I}\left({t}_i\le \tau, {\delta}_i=1\ \right)}{{\widehat{S}}_C\left({t}_i\right)}+\frac{{\left(1-{\widehat{S}}_i(t)\right)}^2\mathbf{I}\left({t}_i&#x0003e;\tau \right)}{{\widehat{S}}_C\left(\tau \right)}\right], $$\end{document}</tex-math><mml:math id="M66"><mml:mi mathvariant="normal">Brier</mml:mi><mml:mfenced close=")" open="("><mml:mi>&#x003c4;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover></mml:mstyle><mml:mfenced close="]" open="["><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>C</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="bold">I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.25em"/></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>C</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mi mathvariant="bold">I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x0003e;</mml:mo><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>C</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c4;</mml:mi></mml:mfenced></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mtext>,</mml:mtext></mml:math><graphic xlink:href="12874_2017_354_Article_Equg.gif" position="anchor"/></alternatives></disp-formula>
</p><p>and takes censoring into account through <italic>&#x0015c;</italic>
<sub><italic>C</italic></sub>(<italic>t</italic>
<sub><italic>i</italic></sub>)&#x02009;=&#x02009;P(<italic>C</italic>&#x02009;&#x0003e;&#x02009;<italic>t</italic>
<sub><italic>i</italic></sub>), the Kaplan-Meier estimate of the censoring distribution with <italic>t</italic>
<sub><italic>i</italic></sub> the survival time of patient <italic>i</italic>. The integration of the Brier score can be done by over time <italic>t</italic>&#x02009;&#x02208;&#x02009;[0,&#x000a0;<italic>&#x003c4;</italic>] with respect to some weight function <italic>W</italic>(<italic>t</italic>) for which a natural choice is (1&#x02009;&#x02212;&#x02009;<italic>&#x0015c;</italic>(<italic>t</italic>))/(1&#x02009;&#x02212;&#x02009;<italic>&#x0015c;</italic>(<italic>&#x003c4;</italic>)) [<xref ref-type="bibr" rid="CR29">29</xref>]. The lower the iBrier score, the larger the prediction accuracy is.</p><p>
<bold>Uno&#x02019;s C-statistic.</bold> To evaluate the discrimination of the prediction model, we also measured the concordance between <inline-formula id="IEq26"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\pi}}_i $$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mover accent="true"><mml:mi>&#x003c0;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq26.gif"/></alternatives></inline-formula>, the linear predictor of (<xref rid="Equ1" ref-type="">1</xref>), and the survival time based on the Uno&#x02019;s C-statistic, one of the least biased concordance statistic estimator in the presence of censoring [<xref ref-type="bibr" rid="CR30">30</xref>]. For the entire model, we computed<disp-formula id="Equh"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{C}\left(\tau \right)= UnoC\left(\widehat{\boldsymbol{\pi}},\tau \right) = \frac{{\displaystyle {\sum}_{i,{i}^{\hbox{'}}}}{\left({\widehat{S}}_C\left({t}_i\right)\right)}^{-2}\mathbf{I}\left({t}_i&#x0003c;{t}_{i^{\hbox{'}}},{t}_i&#x0003c;\tau \right)\ \mathbf{I}\left({\widehat{\pi}}_i&#x0003e;{\widehat{\pi}}_{i^{\hbox{'}}}\right){\delta}_i}{{\displaystyle {\sum}_{i,{i}^{\hbox{'}}}}{\left({\widehat{S}}_C\left({t}_i\right)\right)}^{-2}\mathbf{I}\left({t}_i&#x0003c;{t}_{i^{\hbox{'}}},\ {t}_i&#x0003c;\tau \right){\delta}_i}. $$\end{document}</tex-math><mml:math id="M70"><mml:mi mathvariant="normal">C</mml:mi><mml:mfenced close=")" open="("><mml:mi>&#x003c4;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="italic">UnoC</mml:mi><mml:mfenced close=")" open="(" separators=","><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003c0;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>&#x003c4;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mstyle><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>C</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfenced><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:mfenced><mml:mspace width="0.25em"/><mml:mi mathvariant="bold">I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003c0;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x0003e;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003c0;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:msup><mml:mi>i</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:msub></mml:mrow></mml:mfenced><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:mrow></mml:msub></mml:mstyle><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>C</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:mfenced><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi mathvariant="bold">I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:msup><mml:mi>i</mml:mi><mml:mo>'</mml:mo></mml:msup></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:mfenced><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mtext>.</mml:mtext></mml:math><graphic xlink:href="12874_2017_354_Article_Equh.gif" position="anchor"/></alternatives></disp-formula>
</p><p>The larger the C(<italic>&#x003c4;</italic>), the higher the overall discrimination is. <bold>&#x00394;Uno&#x02019;s C-statistic.</bold> For the treatment-effect modifying component <inline-formula id="IEq27"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\widehat{\eta}}_i $$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mover accent="true"><mml:mi>&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq27.gif"/></alternatives></inline-formula>, we computed the absolute difference of the arm-specific Uno&#x02019;s C-statistics as we proposed previously [<xref ref-type="bibr" rid="CR10">10</xref>] to evaluate the biomarker-by-treatment interaction strength:</p><p>
<disp-formula id="Equi"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \Delta \mathrm{C}\left(\tau \right)=\left| UnoC\left(\widehat{\boldsymbol{\eta}},\ \tau;\ \boldsymbol{T}=+0.5\right)- UnoC\left(\widehat{\boldsymbol{\eta}},\ \tau;\ \boldsymbol{T} = -0.5\right)\right| $$\end{document}</tex-math><mml:math id="M74"><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mi mathvariant="normal">C</mml:mi><mml:mfenced close=")" open="("><mml:mi>&#x003c4;</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:mi mathvariant="italic">UnoC</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>&#x003c4;</mml:mi><mml:mo>;</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>=</mml:mo><mml:mo>+</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:mi mathvariant="italic">UnoC</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>&#x003c4;</mml:mi><mml:mo>;</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo>&#x02212;</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12874_2017_354_Article_Equi.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq28"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ UnoC\left(\widehat{\boldsymbol{\eta}},\ \tau; \boldsymbol{T}= T\right) $$\end{document}</tex-math><mml:math id="M76"><mml:mi mathvariant="italic">UnoC</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>&#x003c4;</mml:mi><mml:mo>;</mml:mo><mml:mi mathvariant="bold-italic">T</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq28.gif"/></alternatives></inline-formula> is the Uno&#x02019;s C-statistic computed within the arm <italic>T</italic> only. The larger the &#x00394;C(<italic>&#x003c4;</italic>), the higher the interaction strength is.</p><p>As a comparator, we also computed these prediction accuracy metrics (iBrier, Uno and &#x00394;Uno) for the &#x0201c;oracle model&#x0201d; that is the unpenalized Cox proportional hazards model fitted to the truly related biomarkers in the training set and applied to the validation set.</p></sec><sec id="Sec14"><title>Bias and precision of the expected survival probability</title><p>To assess reliability of the estimation of the expected survival probability, we compared for each patient <italic>i</italic>, its estimated survival probability <italic>&#x0015c;</italic>
<sub><italic>i</italic></sub>(<italic>&#x003c4;</italic>) to its theoretical survival probability <italic>S</italic>
<sub><italic>i</italic></sub>(<italic>&#x003c4;</italic>). The theoretical survival probability is computed from the baseline survival and the regression parameters of the simulation model. We evaluated the accuracy of <italic>&#x0015c;</italic>
<sub><italic>i</italic></sub>(<italic>&#x003c4;</italic>) through the mean bias<disp-formula id="Equj"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{Mean}\ \mathrm{Bias}\ \left(\mathrm{MB}\right) = \frac{1}{n}{\displaystyle \sum_{i=1}^n}\left({\widehat{S}}_i\left(\tau \right) - {S}_i\left(\tau \right)\right) $$\end{document}</tex-math><mml:math id="M78"><mml:mi mathvariant="normal">Mean</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">Bias</mml:mi><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="normal">M</mml:mi><mml:mi mathvariant="normal">B</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover></mml:mstyle><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c4;</mml:mi></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c4;</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="12874_2017_354_Article_Equj.gif" position="anchor"/></alternatives></disp-formula>
</p><p>and its precision through its standard error<disp-formula id="Equk"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{Standard}\ \mathrm{E}\mathrm{rror}\ \left(\mathrm{SE}\right)=\sqrt{\frac{1}{n-1}{\displaystyle \sum_{i=1}^{\mathrm{n}}}{\left({\widehat{S}}_i\left(\tau \right) - \mathrm{E}\left({\widehat{S}}_i\left(\tau \right)\right)\right)}^2}. $$\end{document}</tex-math><mml:math id="M80"><mml:mi mathvariant="normal">Standard</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">Error</mml:mi><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="normal">S</mml:mi><mml:mi mathvariant="normal">E</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="normal">n</mml:mi></mml:munderover></mml:mstyle><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c4;</mml:mi></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c4;</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mtext>.</mml:mtext></mml:math><graphic xlink:href="12874_2017_354_Article_Equk.gif" position="anchor"/></alternatives></disp-formula>
</p><p>Finally, to evaluate the accuracy of the developed confidence intervals, we also evaluated their empirical coverage probability as<disp-formula id="Equl"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{Coverage}\ \mathrm{Probability}\ \left(\mathrm{CP}\right)=\frac{1}{n}{\displaystyle \sum_{i=1}^n}\mathbf{I}\left({q}_{\frac{\theta}{2}}\left({\widehat{S}}_i\left(\tau \right)\right)\le {S}_i\left(\tau \right)\le {q}_{1-\frac{\theta}{2}}\left({\widehat{S}}_i\left(\tau \right)\right)\right). $$\end{document}</tex-math><mml:math id="M82"><mml:mi mathvariant="normal">Coverage</mml:mi><mml:mspace width="0.25em"/><mml:mi mathvariant="normal">Probability</mml:mi><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">P</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover></mml:mstyle><mml:mi mathvariant="bold">I</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mfrac><mml:mi>&#x003b8;</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c4;</mml:mi></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c4;</mml:mi></mml:mfenced><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mi>&#x003b8;</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>&#x003c4;</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mtext>.</mml:mtext></mml:math><graphic xlink:href="12874_2017_354_Article_Equl.gif" position="anchor"/></alternatives></disp-formula>
</p></sec></sec><sec id="Sec15"><title>Results</title><p>The results of the simulation study are summarized in Tables&#x000a0;<xref rid="Tab2" ref-type="table">2</xref> and <xref rid="Tab3" ref-type="table">3</xref>. These tables summarize both the predictive accuracy metrics and the accuracy and precision of survival estimates of the time-to-event regression models subject to the adaptive lasso penalty. As the lasso penalty provided slightly worse coverage of the confidence intervals and obtained slightly less good biomarker-selection performance in some scenarios [<xref ref-type="bibr" rid="CR10">10</xref>], its results are given in the Additional files <xref rid="MOESM1" ref-type="media">1</xref> and <xref rid="MOESM2" ref-type="media">2</xref>.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Prediction measures of the selected models by the adaptive lasso penalty</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="3">Scenarios</th><th colspan="4">Integrated Brier score (iBrier)</th><th colspan="4">Uno&#x02019;s C-statistic (C)</th><th colspan="4">&#x00394; Uno&#x02019;s C-statistic (&#x00394;C)</th></tr><tr><th colspan="2">Training</th><th colspan="2">Validation</th><th colspan="2">Training</th><th colspan="2">Validation</th><th colspan="2">Training</th><th colspan="2">Validation</th></tr><tr><th>1cv</th><th>2cv</th><th>Selected model</th><th>Oracle model</th><th>1cv</th><th>2cv</th><th>Selected model</th><th>Oracle model</th><th>1cv</th><th>2cv</th><th>Selected model</th><th>Oracle model</th></tr></thead><tbody><tr><td>(1) Complete null</td><td char="." align="char">0.094</td><td char="." align="char">0.099</td><td char="." align="char">0.099</td><td char="." align="char">0.098</td><td char="." align="char">0.636</td><td char="." align="char">0.497</td><td char="." align="char">0.499</td><td char="." align="char">0.500</td><td char="." align="char">0.070</td><td char="." align="char">0.030</td><td char="." align="char">0.002</td><td char="." align="char">0.000</td></tr><tr><td>(2) Treatment effect only</td><td char="." align="char">0.096</td><td char="." align="char">0.102</td><td char="." align="char">0.101</td><td char="." align="char">0.100</td><td char="." align="char">0.663</td><td char="." align="char">0.586</td><td char="." align="char">0.586</td><td char="." align="char">0.558</td><td char="." align="char">0.062</td><td char="." align="char">&#x02212;0.001</td><td char="." align="char">&#x02212;0.001</td><td char="." align="char">0.000</td></tr><tr><td>(3) 20 prognostic markers</td><td char="." align="char">0.097</td><td char="." align="char">0.105</td><td char="." align="char">0.105</td><td char="." align="char">0.102</td><td char="." align="char">0.717</td><td char="." align="char">0.630</td><td char="." align="char">0.630</td><td char="." align="char">0.665</td><td char="." align="char">0.062</td><td char="." align="char">&#x02212;0.003</td><td char="." align="char">0.000</td><td char="." align="char">0.000</td></tr><tr><td>(4) 15 treatment-effect modifiers</td><td char="." align="char">0.094</td><td char="." align="char">0.106</td><td char="." align="char">0.105</td><td char="." align="char">0.101</td><td char="." align="char">0.726</td><td char="." align="char">0.570</td><td char="." align="char">0.571</td><td char="." align="char">0.641</td><td char="." align="char">0.334</td><td char="." align="char">0.209</td><td char="." align="char">0.229</td><td char="." align="char">0.283</td></tr><tr><td>(5) Treatment effect&#x02009;+&#x02009;(4)</td><td char="." align="char">0.094</td><td char="." align="char">0.107</td><td char="." align="char">0.106</td><td char="." align="char">0.102</td><td char="." align="char">0.740</td><td char="." align="char">0.621</td><td char="." align="char">0.621</td><td char="." align="char">0.675</td><td char="." align="char">0.332</td><td char="." align="char">0.206</td><td char="." align="char">0.225</td><td char="." align="char">0.284</td></tr><tr><td>(6) 20 prognostic markers&#x02009;+&#x02009;(5)</td><td char="." align="char">0.096</td><td char="." align="char">0.111</td><td char="." align="char">0.109</td><td char="." align="char">0.104</td><td char="." align="char">0.767</td><td char="." align="char">0.669</td><td char="." align="char">0.670</td><td char="." align="char">0.718</td><td char="." align="char">0.296</td><td char="." align="char">0.183</td><td char="." align="char">0.207</td><td char="." align="char">0.266</td></tr></tbody></table><table-wrap-foot><p>1cv and 2cv: single and double cross-validation in the training set. The selected model is the penalized model obtained by single cross-validation in the training set (1cv) and applied to the validation set. The oracle model is the unpenalized Cox proportional hazards model fitted to the truly related biomarkers in the training set and applied to the validation set. Average quantities across 250 replications</p></table-wrap-foot></table-wrap>
<table-wrap id="Tab3"><label>Table 3</label><caption><p>Accuracy and precision of the survival probabilities, and coverage probability of their 95% confidence intervals of the selected models by the adaptive lasso penalty</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="4">Scenarios</th><th colspan="4">Point estimate of the 5-year survival probability</th><th colspan="4">95% CI of the expected survival</th></tr><tr><th colspan="2">Mean bias</th><th colspan="2">Standard error</th><th colspan="4">Coverage probability</th></tr><tr><th>Pointwise</th><th>Spline</th><th>Pointwise</th><th>Spline</th><th colspan="2">Pointwise</th><th colspan="2">Spline</th></tr><tr><th/><th/><th/><th/><th>Anly</th><th>Boot</th><th>Anly</th><th>Boot</th></tr></thead><tbody><tr><td>(1) Complete null</td><td char="." align="char">&#x02212;0.002</td><td char="." align="char">&#x02212;0.001</td><td char="." align="char">0.05</td><td char="." align="char">0.05</td><td char="." align="char">0.93</td><td char="." align="char">0.97</td><td char="." align="char">0.94</td><td char="." align="char">1.00</td></tr><tr><td>(2) Treatment effect only</td><td char="." align="char">&#x02212;0.001</td><td char="." align="char">&#x02212;0.001</td><td char="." align="char">0.06</td><td char="." align="char">0.05</td><td char="." align="char">0.93</td><td char="." align="char">0.96</td><td char="." align="char">0.93</td><td char="." align="char">1.00</td></tr><tr><td>(3) 20 prognostic biomarkers</td><td char="." align="char">&#x02212;0.002</td><td char="." align="char">0.001</td><td char="." align="char">0.09</td><td char="." align="char">0.09</td><td char="." align="char">0.91</td><td char="." align="char">0.97</td><td char="." align="char">0.89</td><td char="." align="char">0.98</td></tr><tr><td>(4) 15 treatment-effect modifiers</td><td char="." align="char">&#x02212;0.003</td><td char="." align="char">&#x02212;0.001</td><td char="." align="char">0.11</td><td char="." align="char">0.10</td><td char="." align="char">0.88</td><td char="." align="char">0.96</td><td char="." align="char">0.89</td><td char="." align="char">0.98</td></tr><tr><td>(5) Treatment effect&#x02009;+&#x02009;(4)</td><td char="." align="char">&#x02212;0.002</td><td char="." align="char">0.000</td><td char="." align="char">0.11</td><td char="." align="char">0.10</td><td char="." align="char">0.88</td><td char="." align="char">0.96</td><td char="." align="char">0.89</td><td char="." align="char">0.98</td></tr><tr><td>(6) 20 prognostic biomarkers&#x02009;+&#x02009;(5)</td><td char="." align="char">&#x02212;0.005</td><td char="." align="char">0.000</td><td char="." align="char">0.13</td><td char="." align="char">0.13</td><td char="." align="char">0.88</td><td char="." align="char">0.96</td><td char="." align="char">0.87</td><td char="." align="char">0.96</td></tr></tbody></table><table-wrap-foot><p>Anly: analytical approach, Boot: non-parametric bootstrap approach, CI: confidence interval. Average quantities across 250 replications</p></table-wrap-foot></table-wrap>
</p><p>The models identified through the adaptive lasso penalty provided predictive accuracy (Table&#x000a0;<xref rid="Tab2" ref-type="table">2</xref>) relatively close to the oracle models. Computed on an external validation data set, the iBrier score was quite low (varying from 0.099 to 0.109) and the Uno&#x02019;s C-statistic was quite large in presence of prognostic effects (scenarios 2 and 6, varying from 0.586 to 0.670). The &#x00394;Uno&#x02019;s C-statistic was also large in presence of true treatment-effect modifiers (scenarios 4&#x02013;6, varying from +0.207 to +0.229). When evaluating these criteria on the training set used to compute the prediction model, we observed overrated performances of the models as compared to results in external data (training 1cv <italic>vs.</italic> validation: from +0.077 to +0.155 for C and from +0.062 to +0.107 for &#x00394;C). The double cross-validation technique (training 2cv) gave internal results close to those of an external validation (validation).</p><p>When focusing on the estimation of the survival probability (Table&#x000a0;<xref rid="Tab3" ref-type="table">3</xref>), the mean bias was close to zero in all scenarios. Nonetheless, for <italic>S</italic>
<sub>0</sub>&#x000a0;~&#x000a0;50% (Additional file <xref rid="MOESM3" ref-type="media">3</xref>), a slight negative bias was observed (from &#x02212;0.007 to &#x02212;0.020). In terms of precision, the standard error of the survival point estimate was low in absence of biomarker effects (null scenarios 1&#x02013;2, from 0.05 to 0.06) and was higher in presence of prognostic biomarkers (null scenario 3, 0.09) and even higher with treatment-effect modifiers (scenarios 4&#x02013;5, from 0.10 to 0.11). The variability was the largest when both prognostic and treatment-modifiers were present (scenario 6, SE from 0.13). No relevant difference in terms of accuracy and precision of survival point estimate was observed between the pointwise and spline strategy (Table&#x000a0;<xref rid="Tab3" ref-type="table">3</xref>). The standard error was inflated, too, when refitting the selected regression model in a second step (&#x0201c;refit adaptive lasso&#x0201d;) to obtain unpenalized coefficients (e.g. scenario 6: SE from 0.16 to 0.17, Additional file <xref rid="MOESM4" ref-type="media">4</xref>).</p><p>For the computation of the 95% confidence interval of the estimated survival probability, the non-parametric bootstrap approach outperformed the analytical approach in terms of empirical coverage (Table&#x000a0;<xref rid="Tab3" ref-type="table">3</xref>). Despite the former (through the pointwise strategy) produced slightly overly conservative confidence intervals (CP from 0.96 to 0.97), the latter was more biased and in the opposite direction (CP from 0.91 to 0.93 in null scenarios and 0.88 in alternative scenarios). These probabilities for the analytical approach were even lower when using the refit model (CP from 0.68 to 0.73, Additional file <xref rid="MOESM4" ref-type="media">4</xref>), whereas remained unchanged for the bootstrap approach.</p><p>The categorization of the prognostic scores into risk groups and the use of splines slightly increased the coverage probability of the confidence intervals for the bootstrap approach (increase from 0.96&#x02013;0.97 to 0.96&#x02013;1.00) whereas the coverage probability remained unchanged for the analytical approach.</p><p>In sensitivity analyses, the overall number of biomarkers <italic>p</italic> and the empirical censoring rate slightly impacted the results. Indeed, for smaller <italic>p</italic> and lower censoring rate, the prediction accuracy metrics were closer to the oracle models and the overfitting issue was smaller (Additional files <xref rid="MOESM5" ref-type="media">5</xref> and <xref rid="MOESM6" ref-type="media">6</xref>). Also, the precision of the expected survival estimates was higher for this setting (Additional files <xref rid="MOESM7" ref-type="media">7</xref> and <xref rid="MOESM8" ref-type="media">8</xref>).</p></sec><sec id="Sec16"><title>Application</title><p>A retrospective biomarker study was performed on tumor samples from <italic>n</italic> = 1574 patients in an early breast cancer randomized clinical trial comparing chemotherapy plus adjuvant trastuzumab (arm C&#x02009;+&#x02009;T, <italic>n</italic> = 779) or not (arm C, <italic>n</italic> = 795). The comprehensive description of this data set is provided in Pogue-Geile et al. [<xref ref-type="bibr" rid="CR1">1</xref>]. Gene expression data had been collected for <italic>p</italic> = 462 genes and normalized as in the original publication. Clinicopathological covariates such as ER and nodal status, and tumor size were also available. Median follow-up time for distant-recurrence free survival (DRFS) was 7.1&#x000a0;years and the censoring rate was 73% (i.e. 431 events for DRFS). The arm-specific 5-year DRFS was 84% (CI95%: 81%&#x02013;86%) and 64% (CI95%: 61%&#x02013;68%) for patients in arm C&#x02009;+&#x02009;T and C, respectively (Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>). In the 1574 patients, adjuvant trastuzumab led to significant better DRFS as compared to chemotherapy alone (Hazard Ratio&#x02009;=&#x02009;0.46 [95% CI: 0.38&#x02013;0.56]).<fig id="Fig3"><label>Fig. 3</label><caption><p>Arm-specific distant-recurrence free survival in the illustrated breast cancer trial. Vertical lines: 95% confidence interval at 5&#x000a0;years</p></caption><graphic xlink:href="12874_2017_354_Fig3_HTML" id="MO3"/></fig>
</p><p>The clinico-genomic prediction model, established through the model (<xref rid="Equ1" ref-type="">1</xref>) subject to the adaptive lasso penalty, is presented in Table&#x000a0;<xref rid="Tab4" ref-type="table">4</xref>. It contains 102 prognostic variables (4 clinical and 98 genomic variables) and 24 treatment-effect modifiers. Interestingly, some prognostic biomarkers have already been identified in the biomedical literature, such as SOX4 [<xref ref-type="bibr" rid="CR31">31</xref>] or CSNK1D [<xref ref-type="bibr" rid="CR32">32</xref>]. In addition, some immune genes were also identified in the treatment-effect modifying component: CD9 and CCL21, which is consistent with some articles highlighting the involvement of immune pathways in the efficacy of trastuzumab [<xref ref-type="bibr" rid="CR33">33</xref>, <xref ref-type="bibr" rid="CR34">34</xref>]. Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref> provides a graphical visualization of the model representing the 5-year DRFS according to the treatment-effect modifying score for different prognostic risk groups. Confidence intervals were estimated through the non-parametric bootstrap approach (<italic>B</italic> = 200) and were smoothed via B-splines using two or three nodes estimated by AIC.&#x000a0;The prognostic score was categorized through the distribution proposed by Cox [<xref ref-type="bibr" rid="CR26">26</xref>], i.e. group 1 (<inline-formula id="IEq29"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \widehat{\boldsymbol{\varphi}} $$\end{document}</tex-math><mml:math id="M84"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003c6;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq29.gif"/></alternatives></inline-formula> &#x0003c; 0.20), group 2 (0.20 &#x02264; <inline-formula id="IEq30"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \widehat{\boldsymbol{\varphi}} $$\end{document}</tex-math><mml:math id="M86"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003c6;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq30.gif"/></alternatives></inline-formula> &#x0003c; 0.99), group 3 (0.99 &#x02264; <inline-formula id="IEq31"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \widehat{\boldsymbol{\varphi}} $$\end{document}</tex-math><mml:math id="M88"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003c6;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq31.gif"/></alternatives></inline-formula> &#x0003c; 1.85) and group 4 (1.85 &#x02265; <inline-formula id="IEq32"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \widehat{\boldsymbol{\varphi}} $$\end{document}</tex-math><mml:math id="M90"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003c6;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12874_2017_354_Article_IEq32.gif"/></alternatives></inline-formula>). The entire prediction model (i.e. 126 variables) has a moderate ability to discriminate patients according to their survival probability (C&#x02009;=&#x02009;0.67 for a double cross-validation). Regarding the treatment-effect modifying component of the model, it only slightly discriminates patients for their treatment benefit (&#x00394;C&#x02009;=&#x02009;+0.02 for a double cross-validation): the lowest the treatment-effect modifying score, the highest the benefit of the trastuzumab is. As expected, when performing a single cross-validation the prediction measures are higher (C&#x02009;=&#x02009;0.80 and &#x00394;C&#x02009;=&#x02009;0.23). In terms of point estimates, the effect of treatment with trastuzumab on absolute DRFS seems higher for the low treatment-effect modifying scores. However, the width of the confidence intervals is extremely large and the confidence intervals largely overlap between the two arms. The selected model subject to the lasso penalty identified only the SIAH2 gene as treatment-effect modifier (Additional file <xref rid="MOESM9" ref-type="media">9</xref>). Some recent articles have been proposed to reduce the number of selected biomarkers by selecting a more stringent tuning parameter. We previously proposed the <italic>pcvl</italic> criterion [<xref ref-type="bibr" rid="CR35">35</xref>] that reduces the number of selected penalized biomarkers in the present application from 122 to 64 for the adaptive lasso&#x000a0;(Additional file <xref rid="MOESM10" ref-type="media">10</xref>).<table-wrap id="Tab4"><label>Table 4</label><caption><p>Developed clinico-genomic model through the full biomarker-by-treatment interaction Cox model subject to the adaptive lasso penalty</p></caption><table frame="hsides" rules="groups"><tbody><tr><td colspan="2">Prognostic component</td></tr><tr><td>&#x02003;
<italic>Clinical variables</italic> (<italic>p</italic>&#x02009;=&#x02009;4)</td><td>Treatment (&#x02212;0.889<sup>u</sup>), ER status (&#x02212;0.091<sup>u</sup>), Tumor size (0.175<sup>u</sup>), Nodal status (0.418<sup>u</sup>)</td></tr><tr><td>&#x02003;
<italic>Genomic variables</italic> (<italic>p</italic>&#x02009;=&#x02009;98)</td><td>ACTB (0.020), ADCYAP1 (0.009), ANGPTL4 (0.034), ARL8A (0.020), BBC3 (&#x02212;0.088), BDH2 (&#x02212;0.067), CAPS (0.064), CASC3 (&#x02212;0.058), CCDC74A (0.080), CDC6 (&#x02212;0.069),<break/>CDH3 (0.027), CFLP1 (&#x02212;0.143), CSNK1A1 (&#x02212;0.079), CSNK1D (&#x02212;0.063), CXXC5 (&#x02212;0.141), DHPS (0.148), DNAJC4 (&#x02212;0.154), DPY19L4 (0.015), ELAVL4 (&#x02212;0.107), ELN (0.015), ENO1 (0.012), ERBB4 (&#x02212;0.047), FABP5 (0.063), FAM84B (&#x02212;0.084), FBXW11 (0.069),<break/>FKSG30 (&#x02212;0.049), FLJ22659 (0.006), FLJ22795 (0.009), FLJ35390 (0.096), FRAG1 (0.075),<break/>FRMD4A (0.106), GHR (&#x02212;0.067), GPRIN1 (0.009), GSN (0.039), HIST1H2AA (&#x02212;0.085), HIST2H2BE (0.009), IDUA (0.038), IGJ (&#x02212;0.110), IGKV2.24 (0.029), ILF2 (0.014),<break/>KCNE4 (&#x02212;0.075), KIAA1920 (&#x02212;0.025), KIF2C (0.093), KRT81 (&#x02212;0.106), L3MBTL2 (&#x02212;0.057), LCE3E (&#x02212;0.101), LOC400590 (&#x02212;0.021), MAD2L2 (&#x02212;0.098), MAP3K13 (0.115),<break/>MBOAT2 (0.101), MED13L (&#x02212;0.090), METTL3 (&#x02212;0.138), MSI2 (&#x02212;0.039), MTCH2 (0.018), MVP (0.068), NAT1 (&#x02212;0.019), NAT10 (&#x02212;0.085), NDC80 (0.082), NECAB3 (0.075),<break/>NXPH3 (0.001), OGFR (&#x02212;0.040), PCK2 (&#x02212;0.061), PGM5 (0.139), PHGDH (0.107),<break/>PITPNC1 (0.089), PRPF40A (0.041), PTTG1 (0.091), RBM14 (0.090), RELB (&#x02212;0.016), RHBDD1 (&#x02212;0.070), RND3 (0.022), RPL34 (&#x0003c;0,001), RPS2 (&#x02212;0.050), SFRP1 (&#x02212;0.121),<break/>SLC25A28 (&#x02212;0.057), SLC25A31 (0.154), SLC25A5 (&#x02212;0.047), SLC30A10 (0.018),<break/>SLC6A19 (&#x02212;0.056), SMCP (0.055), SOX4 (0.112), SPDEF (0.079), SPP1 (0.090), ST6GALNAC4 (&#x02212;0.058), STEAP3 (&#x02212;0.005), STK11IP (&#x02212;0.009), SULT1A2 (&#x02212;0.085),<break/>TBXAS1 (&#x0003c;0,001), TCEB2 (0.058), TFRC (&#x02212;0.132), TMSB10 (&#x02212;0.096), TRABD (&#x02212;0.037), TUBB2C (0.103), UBE2W (0.116), UGDH (0.039), XYLT1 (0.082), ZNF592 (0.072), ZNF609 (&#x02212;0.081)</td></tr><tr><td colspan="2">Treatment-effect modifying component</td></tr><tr><td>&#x02003;
<italic>Genomic variables</italic> (<italic>p</italic>&#x02009;=&#x02009;24)</td><td>ATAD3A (&#x02212;0.100), C16orf14 (0.165), C1orf93 (&#x02212;0.115), CCL21 (&#x02212;0.046), CD9 (&#x02212;0.191), CIAPIN1 (&#x02212;0.063), CLIC1 (0.148), DKFZP434A0131 (0.167), FAM148A (&#x02212;0.085),<break/>FNDC4 (0.010), FURIN (0.030), KRTAP2.4 (0.256), MED13L (0.046), MIA (&#x02212;0.064), MMD (&#x02212;0.104), ORMDL3 (&#x02212;0.023), RPLP0 (0.006), SIAH2 (0.123), SLC39A14 (0.007), SSBP2 (&#x02212;0.099), THOP1 (&#x02212;0.279), THRAP1 (&#x02212;0.049), TMEM45B (&#x02212;0.169), UNC119 (0.017)</td></tr><tr><td colspan="2">Prediction measures</td></tr><tr><td>&#x02003;C-statistic (C)</td><td>0.80 (1CV), 0.67 (2CV)</td></tr><tr><td>&#x02003;&#x00394;C-statistic (&#x00394;C)</td><td>0.23 (1CV), 0.02 (2CV)</td></tr></tbody></table><table-wrap-foot><p>
<sup>u</sup>unpenalized regression coefficient, 1CV and 2CV: single and double cross-validation</p></table-wrap-foot></table-wrap>
<fig id="Fig4"><label>Fig. 4</label><caption><p>5-year distant-recurrence free survival against the treatment-effect modifying score of the effect of trastuzumab in early breast cancer. Graphical representation of the model showed in Table&#x000a0;<xref rid="Tab4" ref-type="table">4</xref>. DRFS: distant-recurrence free survival, dot: point estimate, solid curves: average smoothed splines for point estimates, dashed curves: average smoothed splines for confidence bounds</p></caption><graphic xlink:href="12874_2017_354_Fig4_HTML" id="MO4"/></fig>
</p></sec><sec id="Sec17"><title>Discussion</title><p>Individual predictions for future patients are the ultimate goal of the stratified medicine era [<xref ref-type="bibr" rid="CR36">36</xref>]. Individual outcome predictions from population risks are most often affected by an inherently large amount of uncertainty. Nevertheless, the expected survival probabilities under different treatment alternatives can be a valuable tool to inform therapeutic decision-making.</p><p>In the present study, we proposed a unified framework for developing, evaluating and visualizing a prediction tool for future patients in the setting of randomized clinical trials with a survival endpoint in a high-dimensional space. We performed a simulation study covering null and alternative scenarios to evaluate different approaches. Based on simulations, the models identified either with the lasso or the adaptive lasso penalties give close results, with accurate and precise estimations of the expected survival probability. The lasso penalty give slightly worse results than the adaptive lasso penalty for the construction of confidence intervals through the analytical approach; however, for both penalized models, the coverage probabilities of their non-parametric 95% confidence intervals are close to the nominal level.</p><p>The simulations also highlighted that refitting the regression model after biomarker selection to obtain unpenalized coefficients reduced the precision of the expected survival probability estimations. In case no external data is available, a double cross-validation is useful to reduce the over-optimism of the measures computed internally (prediction error through the iBrier score and discrimination through the Uno&#x02019;s C-statistics). Other resampling techniques such as bootstrap or jackknife could have been also proposed, but are known to be more time consuming. In addition, a previous study comparing resampling methods highlighted that the cross-validation performed well for predictive accuracy [<xref ref-type="bibr" rid="CR37">37</xref>]. Regarding the construction of confidence intervals, the non-parametric (bootstrap) confidence intervals outperform the analytical approach in our simulation study. A possible explanation is that standard errors of penalized regression coefficients are difficult to estimate, we used the Hessian matrix based on the estimated parameter values in this study. Furthermore, this approach does not take into account the upstream variable selection process, which adds variability and could explain why the coverage probability is lower than the nominal level.</p><p>Finally, we also considered to possibly use smoothing splines and to categorize the prognostic score into four risk groups to obtain a more meaningful graphical visualization of the model. Of course, the cut-offs are arbitrary and should be predefined by warranting a sufficient number of patients per group. Even if the categorization of the prognostic scores slightly reduces the information, this is counterbalanced by a more straightforward graphical representation of the model predictions. In particular, this reduction in coverage probability is minimal with the bootstrap approach.</p><p>To the best of our knowledge, no simulation study has previously investigated the accuracy and precision of expected survival probabilities from a penalized Cox regression model investigating in high-dimensional spaces both prognostic biomarkers and treatment-effect modifiers in a randomized clinical trial. Matsui et al. [<xref ref-type="bibr" rid="CR3">3</xref>] showed in a real data example how to obtain individual estimations from prediction models based on both prognostic biomarkers and treatment-effect modifiers. However, they did not mention the problem of computing confidence intervals and selected the biomarkers through a univariate approach, which is suboptimal in a high-dimensional setting [<xref ref-type="bibr" rid="CR10">10</xref>]. The inference of survival probabilities is a topic increasingly discussed in the literature. Two recent articles [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>] focused on a prognostic setting, mainly in low-dimensional spaces. Sinnott and Cai [<xref ref-type="bibr" rid="CR5">5</xref>] proposed a two-step ensemble voting approach and Lin and Halabi [<xref ref-type="bibr" rid="CR6">6</xref>] proposed a perturbation approach to better estimate the standard errors, but did not investigate the impact on expected survival probabilities.</p><p>We also applied the proposed strategies to a randomized clinical trial of early breast cancer. Interestingly, the identified model contains some biomarkers already known in the biomedical literature but the interaction strength seemed low based on double cross-validation. Due to the low number of events of the complete data set, we did not separate it into training and validation sets. Of note, the large width of the confidence intervals of the survival predictions translates the high uncertainty around these measures, as also discussed by [<xref ref-type="bibr" rid="CR5">5</xref>]. The identified model contains a very large number of biomarkers, but parsimonious models could be preferred. Some strategies have been proposed to reduce the number of selected biomarkers by selecting a more stringent tuning parameter such as the <italic>pcvl</italic> criterion [<xref ref-type="bibr" rid="CR35">35</xref>]. Finally, a remaining open question concerns the integration of clinical and genomic variables. Ongoing research focuses on this topic, but no consensus has been reached yet [<xref ref-type="bibr" rid="CR38">38</xref>, <xref ref-type="bibr" rid="CR39">39</xref>]. In the application shown, we left the clinical variables unpenalized because they are known to have a strong prognostic main effect in the early breast cancer setting.</p></sec><sec id="Sec18"><title>Conclusions</title><p>In this paper, we propose a unified framework for developing and validating a prediction model with treatment-effect modifiers from high-dimensional survival data in a randomized clinical trial. We suggest to: internally estimate the performance of the model through a double cross-validation; estimate the expected survival probabilities at a given horizon for future patients and construct confidence intervals thereof using bootstrap; and visualize them using different plots for different prognostic risk groups with smoothed splines to obtain a meaningful graphical visualization.</p></sec><sec sec-type="supplementary-material"><title>Additional files</title><sec id="Sec19"><p>
<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="12874_2017_354_MOESM1_ESM.docx"><label>Additional file 1:</label><caption><p>Prediction measures of the selected models by the lasso penalty. Additional results of the simulation study. (DOCX 16 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM2"><media xlink:href="12874_2017_354_MOESM2_ESM.docx"><label>Additional file 2:</label><caption><p>Accuracy and precision of the survival probabilities, and coverage probability of their 95% confidence intervals of the selected models by the lasso penalty. Additional results of the simulation study. (DOCX 16 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM3"><media xlink:href="12874_2017_354_MOESM3_ESM.docx"><label>Additional file 3:</label><caption><p>Accuracy and precision of the survival probabilities, and coverage probability of the associated 95% confidence intervals of the selected models by the adaptive lasso penalty (scenarios with <italic>S</italic>
<sub>0</sub>&#x02009;~&#x000a0;50%). Additional results of the simulation study. (DOCX 17 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM4"><media xlink:href="12874_2017_354_MOESM4_ESM.docx"><label>Additional file 4:</label><caption><p>Accuracy and precision of the survival probabilities, and coverage probability of the associated 95% confidence intervals of the selected models by the refit adaptive lasso penalty. Additional results of the simulation study. (DOCX 16 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM5"><media xlink:href="12874_2017_354_MOESM5_ESM.docx"><label>Additional file 5:</label><caption><p>Prediction measures of the selected models by the adaptive lasso penalty (scenarios with <italic>p</italic>&#x02009;=&#x02009;100 and 1000). Additional results of the simulation study. (DOCX 21 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM6"><media xlink:href="12874_2017_354_MOESM6_ESM.docx"><label>Additional file 6:</label><caption><p>Prediction measures of the selected models by the adaptive lasso penalty (scenarios with lower censoring rate). Additional results of the simulation study. (DOCX 18 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM7"><media xlink:href="12874_2017_354_MOESM7_ESM.docx"><label>Additional file 7:</label><caption><p>Accuracy and precision of the survival probabilities, and coverage probability of the associated 95% confidence intervals of the selected models by the adaptive lasso penalty (scenarios with <italic>p</italic>&#x02009;=&#x02009;100 and 1000). Additional results of the simulation study. (DOCX 18 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM8"><media xlink:href="12874_2017_354_MOESM8_ESM.docx"><label>Additional file 8:</label><caption><p>Accuracy and precision of the survival probabilities, and coverage probability of the associated 95% confidence intervals of the selected models by the adaptive lasso penalty (scenarios with lower censoring rate). Additional results of the simulation study. (DOCX 18 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM9"><media xlink:href="12874_2017_354_MOESM9_ESM.docx"><label>Additional file 9:</label><caption><p>Developed clinico-genomic model through the full biomarker-by-treatment interaction Cox model subject to the lasso penalty. Additional results of the breast cancer application. (DOCX 15 kb)</p></caption></media></supplementary-material>
<supplementary-material content-type="local-data" id="MOESM10"><media xlink:href="12874_2017_354_MOESM10_ESM.docx"><label>Additional file 10:</label><caption><p>Developed clinico-genomic model through the full biomarker-by-treatment interaction Cox model subject to the adaptive lasso penalty with &#x003bb; selected through the <italic>pcvl</italic> criterion. Additional results of the breast cancer application. (DOCX 15 kb)</p></caption></media></supplementary-material>
</p></sec></sec></body><back><glossary><title>Abbreviations</title><def-list><def-item><term>Anly</term><def><p>Analytical approach</p></def></def-item><def-item><term>Boot</term><def><p>Bootstrap approach</p></def></def-item><def-item><term>B-splines</term><def><p>Basis splines</p></def></def-item><def-item><term>C</term><def><p>Uno&#x02019;s C-statistic</p></def></def-item><def-item><term>CI</term><def><p>Confidence interval</p></def></def-item><def-item><term>CP</term><def><p>Coverage probability</p></def></def-item><def-item><term>CV</term><def><p>Cross-validation</p></def></def-item><def-item><term>DRFS</term><def><p>Distant-recurrence free survival</p></def></def-item><def-item><term>iBrier</term><def><p>Integrated Brier score</p></def></def-item><def-item><term>MB</term><def><p>Mean bias</p></def></def-item><def-item><term>SE</term><def><p>Standard error</p></def></def-item><def-item><term>&#x00394;C</term><def><p>Difference in Uno&#x02019;s C-statistic between the two treatment arms</p></def></def-item></def-list></glossary><fn-group><fn><p><bold>Electronic supplementary material</bold></p><p>The online version of this article (doi:10.1186/s12874-017-0354-0) contains supplementary material, which is available to authorized users.</p></fn></fn-group><ack><p>Nils Tern&#x000e8;s acknowledges financial support by Foundation Philanthropia Lombard-Odier. The authors also acknowledge the National Surgical Adjuvant Breast and Bowel Project (NSABP) investigators of the B-31 trial who submitted data from the original study to dbGaP (dbGaP Study Accession: phs000826.v1.p1) and the NIH data repository. The B-31 trial was supported by: National Cancer Institute, Department of Health and Human Services, Public Health Service, Grants U10-CA-12027, U10-CA-69651, U10-CA-37377, and U10-CA-69974, and by a grant from the Pennsylvania Department of Health.</p><sec id="FPar1"><title>Funding</title><p>This work was supported by the Foundation Philanthropia Lombard-Odier as a PhD scholarship. The funding sources had no role in study design, data collection, data analysis, data interpretation, or manuscript writing.</p></sec><sec id="FPar2"><title>Availability of data and materials</title><p>The R code implementing all the different approaches is provided in the R package biospear, publicly available on the CRAN.</p></sec><sec id="FPar3"><title>Authors&#x02019; contributions</title><p>NT performed the statistical analyses and drafted the manuscript. NT, FR and SM jointly contributed to writing the study protocol, interpreting and discussing results, and to writing the article. NT, FR and SM read and approved the final manuscript.</p></sec><sec id="FPar4"><title>Competing interests</title><p>The authors declare that they have no competing interests.</p></sec><sec id="FPar5"><title>Consent for publication</title><p>Not applicable.</p></sec><sec id="FPar6"><title>Ethics approval and consent to participate</title><p>Not applicable.</p></sec><sec id="FPar7"><title>Publisher&#x02019;s Note</title><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></sec></ack><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pogue-Geile</surname><given-names>KL</given-names></name><name><surname>Kim</surname><given-names>C</given-names></name><name><surname>Jeong</surname><given-names>J-H</given-names></name><name><surname>Tanaka</surname><given-names>N</given-names></name><name><surname>Bandos</surname><given-names>H</given-names></name><name><surname>Gavin</surname><given-names>PG</given-names></name><etal/></person-group><article-title>Predicting degree of benefit from adjuvant trastuzumab in NSABP trial B-31</article-title><source>J Natl Cancer Inst</source><year>2013</year><volume>105</volume><fpage>1782</fpage><lpage>1788</lpage><pub-id pub-id-type="doi">10.1093/jnci/djt321</pub-id><pub-id pub-id-type="pmid">24262440</pub-id></element-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Perez</surname><given-names>EA</given-names></name><name><surname>Thompson</surname><given-names>EA</given-names></name><name><surname>Ballman</surname><given-names>KV</given-names></name><name><surname>Anderson</surname><given-names>SK</given-names></name><name><surname>Asmann</surname><given-names>YW</given-names></name><name><surname>Kalari</surname><given-names>KR</given-names></name><etal/></person-group><article-title>Genomic analysis reveals that immune function genes are strongly linked to clinical outcome in the North Central Cancer Treatment Group n9831 Adjuvant Trastuzumab Trial</article-title><source>J Clin Oncol</source><year>2015</year><volume>33</volume><fpage>701</fpage><lpage>708</lpage><pub-id pub-id-type="doi">10.1200/JCO.2014.57.6298</pub-id><pub-id pub-id-type="pmid">25605861</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Matsui</surname><given-names>S</given-names></name><name><surname>Simon</surname><given-names>R</given-names></name><name><surname>Qu</surname><given-names>P</given-names></name><name><surname>Matsui</surname><given-names>S</given-names></name><name><surname>Shaughnessy</surname><given-names>JD</given-names></name><name><surname>Barlogie</surname><given-names>B</given-names></name><name><surname>Crowley</surname><given-names>J</given-names></name></person-group><article-title>Developing and Validating Continuous Genomic Signatures in Randomized Clinical Trials for Predictive Medicine</article-title><source>Clin Cancer Res</source><year>2012</year><volume>18</volume><fpage>6065</fpage><lpage>6073</lpage><pub-id pub-id-type="doi">10.1158/1078-0432.CCR-12-1206</pub-id><pub-id pub-id-type="pmid">22927484</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yang</surname><given-names>H</given-names></name><name><surname>Tang</surname><given-names>R</given-names></name><name><surname>Hale</surname><given-names>M</given-names></name><name><surname>Huang</surname><given-names>J</given-names></name></person-group><article-title>A visualization method measuring the performance of biomarkers for guiding treatment decisions</article-title><source>Pharm Stat</source><year>2016</year><volume>15</volume><fpage>152</fpage><lpage>164</lpage><pub-id pub-id-type="doi">10.1002/pst.1728</pub-id><pub-id pub-id-type="pmid">26632104</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="other">Sinnott JA, Cai T. Inference for survival prediction under the regularized Cox model. Biostatistics 2016;17:692&#x02013;707.</mixed-citation></ref><ref id="CR6"><label>6.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>C</given-names></name><name><surname>Halabi</surname><given-names>S</given-names></name></person-group><source>A Simple Method for Deriving the Confidence Regions for the Penalized Cox&#x02019;s Model via the Minimand Perturbation. Commun Stat - Theory Methods</source><year>2016</year></element-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rothwell</surname><given-names>PM</given-names></name></person-group><article-title>Subgroup analysis in randomised controlled trials: importance, indications, and interpretation</article-title><source>Lancet</source><year>2005</year><volume>365</volume><fpage>176</fpage><lpage>186</lpage><pub-id pub-id-type="doi">10.1016/S0140-6736(05)17709-5</pub-id><pub-id pub-id-type="pmid">15639301</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Windeler</surname><given-names>J</given-names></name></person-group><article-title>Prognosis - what does the clinician associate with this notion?</article-title><source>Stat Med</source><year>2000</year><volume>19</volume><fpage>425</fpage><lpage>430</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1097-0258(20000229)19:4&#x0003c;425::AID-SIM347&#x0003e;3.0.CO;2-J</pub-id><pub-id pub-id-type="pmid">10694727</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cox</surname><given-names>DR</given-names></name></person-group><article-title>Regression models and life-tables (with discussion)</article-title><source>J R Stat Soc Ser B</source><year>1972</year><volume>34</volume><fpage>187</fpage><lpage>220</lpage></element-citation></ref><ref id="CR10"><label>10.</label><mixed-citation publication-type="other">Tern&#x000e8;s N, Rotolo F, Heinze G, Michiels S. Identification of biomarker-by-treatment interactions in randomized clinical trials with survival outcomes and high-dimensional spaces. Biometrical J. doi: 10.1002/bimj.201500234. [Epub ahead of print]</mixed-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tibshirani</surname><given-names>R</given-names></name></person-group><article-title>Regression shrinkage and selection via the lasso</article-title><source>J R Stat Soc Ser B</source><year>1996</year><volume>58</volume><fpage>267</fpage><lpage>288</lpage></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zou</surname><given-names>H</given-names></name></person-group><article-title>The adaptive lasso and its oracle properties</article-title><source>J Am Stat Assoc</source><year>2006</year><volume>101</volume><fpage>1418</fpage><lpage>1429</lpage><pub-id pub-id-type="doi">10.1198/016214506000000735</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>HH</given-names></name><name><surname>Lu</surname><given-names>W</given-names></name></person-group><article-title>Adaptive lasso for Cox&#x02019;s proportional hazards model</article-title><source>Biometrika</source><year>2007</year><volume>94</volume><fpage>691</fpage><lpage>703</lpage><pub-id pub-id-type="doi">10.1093/biomet/asm037</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fan</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>R</given-names></name></person-group><article-title>Variable selection via nonconcave penalized likelihood and its oracle properties</article-title><source>J Am Stat Assoc</source><year>2001</year><volume>96</volume><fpage>1348</fpage><lpage>1360</lpage><pub-id pub-id-type="doi">10.1198/016214501753382273</pub-id></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Verweij</surname><given-names>PJ</given-names></name><name><surname>van Houwelingen</surname><given-names>HC</given-names></name></person-group><article-title>Cross-validation in survival analysis</article-title><source>Stat Med</source><year>1993</year><volume>12</volume><fpage>2305</fpage><lpage>2314</lpage><pub-id pub-id-type="doi">10.1002/sim.4780122407</pub-id><pub-id pub-id-type="pmid">8134734</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><mixed-citation publication-type="other">Friedman J, Hastie T, Tibshirani R. Regularization paths for generalized linear models via coordinate descent. J Stat Softw. 2010;33:1&#x02013;22.</mixed-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="other">Friedman J, Hastie T, Simon N, Tibshirani R. Lasso and Elastic-Net Regularized Generalized Linear Models. R-package version 2.0-5. 2016. <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=glmnet">https://cran.r-project.org/package=glmnet</ext-link>. Accessed 12 Dec 2016.</mixed-citation></ref><ref id="CR18"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Harrell</surname><given-names>FEJ</given-names></name><name><surname>Lee</surname><given-names>KL</given-names></name><name><surname>Mark</surname><given-names>DB</given-names></name></person-group><article-title>Multivariable prognostic models: issues in developing models, evaluating assumptions and adequacy, and measuring and reducing errors</article-title><source>Stat Med</source><year>1996</year><volume>15</volume><fpage>361</fpage><lpage>87</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1097-0258(19960229)15:4&#x0003c;361::AID-SIM168&#x0003e;3.0.CO;2-4</pub-id><pub-id pub-id-type="pmid">8668867</pub-id></element-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simon</surname><given-names>RM</given-names></name><name><surname>Subramanian</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>M-C</given-names></name><name><surname>Menezes</surname><given-names>S</given-names></name></person-group><article-title>Using cross-validation to evaluate predictive accuracy of survival risk classifiers based on high-dimensional data</article-title><source>Brief Bioinform</source><year>2011</year><volume>12</volume><issue>3</issue><fpage>203</fpage><lpage>214</lpage><pub-id pub-id-type="doi">10.1093/bib/bbr001</pub-id><pub-id pub-id-type="pmid">21324971</pub-id></element-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Breslow</surname><given-names>NE</given-names></name></person-group><article-title>Contribution to the discussion of the paper by DR Cox</article-title><source>J R Stat Soc Ser B</source><year>1972</year><volume>34</volume><fpage>216</fpage><lpage>217</lpage></element-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="other">Therneau TM, Grambsch PM. Modeling survival data: extending the Cox model. New York: Springer Science &#x00026; Business Media; 2000.</mixed-citation></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="other">Breslow N. Covariance analysis of censored survival data. Biometrics. 1974;30:89&#x02013;99.</mixed-citation></ref><ref id="CR23"><label>23.</label><mixed-citation publication-type="other">Therneau TM, Lumley T. survival: Survival Analysis. R-package version 2.40-1. 2016. <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=survival">https://cran.r-project.org/package=survival</ext-link>. Accessed 12 Dec 2016.</mixed-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ng</surname><given-names>P</given-names></name><name><surname>Maechler</surname><given-names>M</given-names></name></person-group><article-title>A fast and efficient implementation of qualitatively constrained quantile smoothing splines</article-title><source>Stat Model</source><year>2007</year><volume>7</volume><fpage>315</fpage><lpage>328</lpage><pub-id pub-id-type="doi">10.1177/1471082X0700700403</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><mixed-citation publication-type="other">Ng P, Maechler M. Qualitatively Constrained (Regression) Smoothing Splines via Linear Programming and Sparse Matrices. R-package version 1.3-1. 2015. <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/package=cobs">https://cran.r-project.org/package=cobs</ext-link>. Accessed 12 Dec 2016.</mixed-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cox</surname><given-names>DR</given-names></name></person-group><article-title>Note on grouping</article-title><source>J Am Stat Assoc</source><year>1957</year><volume>52</volume><fpage>543</fpage><lpage>547</lpage><pub-id pub-id-type="doi">10.1080/01621459.1957.10501411</pub-id></element-citation></ref><ref id="CR27"><label>27.</label><mixed-citation publication-type="other">Royston P, Altman DG, Sauerbrei W. Dichotomizing continuous predictors in multiple regression&#x0202f;: a bad idea. Stat Med. 2006;127&#x02013;141.</mixed-citation></ref><ref id="CR28"><label>28.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pang</surname><given-names>H</given-names></name><name><surname>Tong</surname><given-names>T</given-names></name><name><surname>Zhao</surname><given-names>H</given-names></name></person-group><article-title>Shrinkage-based diagonal discriminant analysis and its applications in high-dimensional data</article-title><source>Biometrics</source><year>2009</year><volume>65</volume><fpage>1021</fpage><lpage>1029</lpage><pub-id pub-id-type="doi">10.1111/j.1541-0420.2009.01200.x</pub-id><pub-id pub-id-type="pmid">19302409</pub-id></element-citation></ref><ref id="CR29"><label>29.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Graf</surname><given-names>E</given-names></name><name><surname>Schmoor</surname><given-names>C</given-names></name><name><surname>Sauerbrei</surname><given-names>W</given-names></name><name><surname>Schumacher</surname><given-names>M</given-names></name></person-group><article-title>Assessment and comparison of prognostic classification schemes for survival data</article-title><source>Stat Med</source><year>1999</year><volume>18</volume><fpage>2529</fpage><lpage>2545</lpage><pub-id pub-id-type="doi">10.1002/(SICI)1097-0258(19990915/30)18:17/18&#x0003c;2529::AID-SIM274&#x0003e;3.0.CO;2-5</pub-id><pub-id pub-id-type="pmid">10474158</pub-id></element-citation></ref><ref id="CR30"><label>30.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Uno</surname><given-names>H</given-names></name><name><surname>Cai</surname><given-names>T</given-names></name><name><surname>Pencina</surname><given-names>MJ</given-names></name><name><surname>D&#x02019;Agostino</surname><given-names>RB</given-names></name><name><surname>Wei</surname><given-names>LJ</given-names></name></person-group><article-title>On the C-statistics for evaluating overall adequacy of risk prediction procedures with censored survival data</article-title><source>Stat Med</source><year>2011</year><volume>30</volume><fpage>1105</fpage><lpage>1117</lpage><pub-id pub-id-type="pmid">21484848</pub-id></element-citation></ref><ref id="CR31"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Song</surname><given-names>G-D</given-names></name><name><surname>Sun</surname><given-names>Y</given-names></name><name><surname>Shen</surname><given-names>H</given-names></name><name><surname>Li</surname><given-names>W</given-names></name></person-group><article-title>SOX4 overexpression is a novel biomarker of malignant status and poor prognosis in breast cancer patients</article-title><source>Tumor Biol</source><year>2015</year><volume>36</volume><fpage>4167</fpage><lpage>4173</lpage><pub-id pub-id-type="doi">10.1007/s13277-015-3051-9</pub-id></element-citation></ref><ref id="CR32"><label>32.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Abba</surname><given-names>MC</given-names></name><name><surname>Sun</surname><given-names>H</given-names></name><name><surname>Hawkins</surname><given-names>KA</given-names></name><name><surname>Drake</surname><given-names>JA</given-names></name><name><surname>Hu</surname><given-names>Y</given-names></name><name><surname>Nunez</surname><given-names>MI</given-names></name><etal/></person-group><article-title>Breast cancer molecular signatures as determined by SAGE: correlation with lymph node status</article-title><source>Mol Cancer Res</source><year>2007</year><volume>5</volume><fpage>881</fpage><lpage>890</lpage><pub-id pub-id-type="doi">10.1158/1541-7786.MCR-07-0055</pub-id><pub-id pub-id-type="pmid">17855657</pub-id></element-citation></ref><ref id="CR33"><label>33.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Andre</surname><given-names>F</given-names></name><name><surname>Dieci</surname><given-names>MV</given-names></name><name><surname>Dubsky</surname><given-names>P</given-names></name><name><surname>Sotiriou</surname><given-names>C</given-names></name><name><surname>Curigliano</surname><given-names>G</given-names></name><name><surname>Denkert</surname><given-names>C</given-names></name><etal/></person-group><article-title>Molecular pathways: involvement of immune pathways in the therapeutic response and outcome in breast cancer</article-title><source>Clin Cancer Res</source><year>2013</year><volume>19</volume><fpage>28</fpage><lpage>33</lpage><pub-id pub-id-type="doi">10.1158/1078-0432.CCR-11-2701</pub-id><pub-id pub-id-type="pmid">23258741</pub-id></element-citation></ref><ref id="CR34"><label>34.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loi</surname><given-names>S</given-names></name><name><surname>Michiels</surname><given-names>S</given-names></name><name><surname>Salgado</surname><given-names>R</given-names></name><name><surname>Sirtaine</surname><given-names>N</given-names></name><name><surname>Jose</surname><given-names>V</given-names></name><name><surname>Fumagalli</surname><given-names>D</given-names></name><etal/></person-group><article-title>Tumor infiltrating lymphocytes is prognostic and predictive for trastuzumab benefit in early breast cancer: results from the FinHER trial</article-title><source>Ann Oncol</source><year>2014</year><volume>25</volume><fpage>1544</fpage><lpage>1550</lpage><pub-id pub-id-type="doi">10.1093/annonc/mdu112</pub-id><pub-id pub-id-type="pmid">24608200</pub-id></element-citation></ref><ref id="CR35"><label>35.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tern&#x000e8;s</surname><given-names>N</given-names></name><name><surname>Rotolo</surname><given-names>F</given-names></name><name><surname>Michiels</surname><given-names>S</given-names></name></person-group><article-title>Empirical extensions of the lasso penalty to reduce the false discovery rate in high- dimensional Cox regression models</article-title><source>Stat Med</source><year>2016</year><volume>35</volume><fpage>2561</fpage><lpage>2573</lpage><pub-id pub-id-type="doi">10.1002/sim.6927</pub-id><pub-id pub-id-type="pmid">26970107</pub-id></element-citation></ref><ref id="CR36"><label>36.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hayes</surname><given-names>DF</given-names></name><name><surname>Markus</surname><given-names>HS</given-names></name><name><surname>Leslie</surname><given-names>RD</given-names></name><name><surname>Topol</surname><given-names>EJ</given-names></name></person-group><article-title>Personalized medicine: risk prediction, targeted therapies and mobile health technology</article-title><source>BMC Med</source><year>2014</year><volume>12</volume><fpage>37</fpage><pub-id pub-id-type="doi">10.1186/1741-7015-12-37</pub-id><pub-id pub-id-type="pmid">24580858</pub-id></element-citation></ref><ref id="CR37"><label>37.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Molinaro</surname><given-names>AM</given-names></name><name><surname>Simon</surname><given-names>R</given-names></name><name><surname>Pfeiffer</surname><given-names>RM</given-names></name></person-group><article-title>Prediction error estimation: a comparison of resampling methods</article-title><source>Bioinformatics</source><year>2005</year><volume>21</volume><fpage>3301</fpage><lpage>3307</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/bti499</pub-id><pub-id pub-id-type="pmid">15905277</pub-id></element-citation></ref><ref id="CR38"><label>38.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>B&#x000f8;velstad</surname><given-names>HM</given-names></name><name><surname>Nyg&#x000e5;rd</surname><given-names>S</given-names></name><name><surname>Borgan</surname><given-names>&#x000d8;</given-names></name></person-group><article-title>Survival prediction from clinico-genomic models-a comparative study</article-title><source>BMC Bioinformatics</source><year>2009</year><volume>10</volume><fpage>413</fpage><pub-id pub-id-type="doi">10.1186/1471-2105-10-413</pub-id><pub-id pub-id-type="pmid">20003386</pub-id></element-citation></ref><ref id="CR39"><label>39.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>De Bin</surname><given-names>R</given-names></name><name><surname>Sauerbrei</surname><given-names>W</given-names></name><name><surname>Boulesteix</surname><given-names>A</given-names></name></person-group><article-title>Investigating the prediction ability of survival models based on both clinical and omics data : two case studies</article-title><source>Stat Med</source><year>2014</year><volume>33</volume><fpage>5310</fpage><lpage>5329</lpage><pub-id pub-id-type="doi">10.1002/sim.6246</pub-id><pub-id pub-id-type="pmid">25042390</pub-id></element-citation></ref></ref-list></back></article>