<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-id journal-id-type="hwp">bioinfo</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">21803803</article-id><article-id pub-id-type="pmc">3179655</article-id><article-id pub-id-type="doi">10.1093/bioinformatics/btr448</article-id><article-id pub-id-type="publisher-id">btr448</article-id><article-categories><subj-group subj-group-type="heading"><subject>Applications Note</subject><subj-group><subject>Systems Biology</subject></subj-group></subj-group></article-categories><title-group><article-title><italic>JMassBalance</italic>: mass-balanced randomization and analysis of metabolic networks</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Basler</surname><given-names>Georg</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="corresp" rid="COR1"><sup>*</sup></xref></contrib><contrib contrib-type="author"><name><surname>Nikoloski</surname><given-names>Zoran</given-names></name><xref ref-type="aff" rid="AFF1"><sup>1</sup></xref><xref ref-type="aff" rid="AFF1"><sup>2</sup></xref></contrib></contrib-group><aff id="AFF1"><sup>1</sup>University of Potsdam, Institute for Biochemistry and Biology and <sup>2</sup>Max Planck Institute for Molecular Plant Physiology, D-14476 Potsdam, Germany</aff><author-notes><corresp id="COR1">* To whom correspondence should be addressed.</corresp><fn><p>Associate Editor: Mario Albrecht</p></fn></author-notes><pub-date pub-type="ppub"><day>1</day><month>10</month><year>2011</year></pub-date><pub-date pub-type="epub"><day>29</day><month>7</month><year>2011</year></pub-date><pub-date pub-type="pmc-release"><day>29</day><month>7</month><year>2011</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. --><volume>27</volume><issue>19</issue><fpage>2761</fpage><lpage>2762</lpage><history><date date-type="received"><day>30</day><month>5</month><year>2011</year></date><date date-type="rev-recd"><day>26</day><month>7</month><year>2011</year></date><date date-type="accepted"><day>27</day><month>7</month><year>2011</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2011. Published by Oxford University Press.</copyright-statement><copyright-year>2011</copyright-year><license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.5"><license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5">http://creativecommons.org/licenses/by-nc/2.5</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><abstract><p><bold>Summary:</bold> Analysis of biological networks requires assessing the statistical significance of network-based predictions by using a realistic null model. However, the existing network null model, <italic>switch randomization</italic>, is unsuitable for metabolic networks, as it does not include physical constraints and generates unrealistic reactions. We present <italic>JMassBalance</italic>, a tool for mass-balanced randomization and analysis of metabolic networks. The tool allows efficient generation of large sets of randomized networks under the physical constraint of mass balance. In addition, various structural properties of the original and randomized networks can be calculated, facilitating the identification of the salient properties of metabolic networks with a biologically meaningful null model.</p><p><bold>Availability and Implementation:</bold> <italic>JMassBalance</italic> is implemented in Java and freely available on the web at <ext-link ext-link-type="uri" xlink:href="http://mathbiol.mpimp-golm.mpg.de/massbalance/">http://mathbiol.mpimp-golm.mpg.de/massbalance/</ext-link>.</p><p><bold>Contact:</bold> <email>basler@mpimp-golm.mpg.de</email></p></abstract><counts><page-count count="2"/></counts></article-meta></front><body><sec sec-type="intro" id="SEC1"><title>1 INTRODUCTION</title><p>Network-based studies of biological systems attempt to relate topological properties to biological function. The first step in drawing this connection involves determining the network properties which do not arise by chance. To this end, a network null model can be used to assess the statistical significance of network properties.</p><p>The common approach for determining the statistical significance of a given property is to determine a <italic>P</italic>-value based on the following procedure: (i) determine the chosen property from an investigated biological network; (ii) sample a large number of random networks under biologically meaningful constraints; and (iii) estimate the mean and variance of the property from the simulated networks to calculate a <italic>z</italic>-score (with the corresponding <italic>P</italic>-value) under the assumption of normal distribution.</p><p>Clearly, the significance of a network property strongly depends on the null model. The commonly used method, <italic>switch randomization</italic> (<xref ref-type="bibr" rid="B3">Guimer&#x000e0; <italic>et al.</italic>, 2007</xref>; <xref ref-type="bibr" rid="B6">Milo <italic>et al.</italic>, 2002</xref>; <xref ref-type="bibr" rid="B7">Sales-Pardo <italic>et al.</italic>, 2007</xref>), does not account for physical constraints, and thus generates unrealistic biochemical reactions (see <xref ref-type="bibr" rid="B1">Basler <italic>et al.</italic>, 2011</xref>, for an example). Thus, it is questionable whether the significance determined by this generic randomization scheme helps to elucidate the relation between network properties and biological functions.</p><p>Motivated by the lack of a biologically meaningful null model for metabolic networks, we developed a method for randomizing metabolic networks under the constraint of mass balance, and analyzed its computational complexity and uniformity of sampling (<xref ref-type="bibr" rid="B1">Basler <italic>et al.</italic>, 2011</xref>). Here, we present a tool which can be run via a graphical user interface (GUI) or from the command line, and implements mass-balanced randomization of metabolic networks provided in one of three standard data formats: (i) BioCyc (<ext-link ext-link-type="uri" xlink:href="http://www.biocyc.org">http://www.biocyc.org</ext-link>); (ii) Systems Biology Markup Language (SBML, <ext-link ext-link-type="uri" xlink:href="http://sbml.org">http://sbml.org</ext-link>); or (iii) a customizable text file format.</p></sec><sec sec-type="methods" id="SEC2"><title>2 METHOD</title><p>A metabolic network is represented as a weighted directed bipartite graph <italic>G</italic>=(<italic>V</italic><sub><italic>c</italic></sub>&#x0222a;<italic>V</italic><sub><italic>r</italic></sub>, <italic>E</italic>), where <italic>V</italic><sub><italic>c</italic></sub> is the set of compound nodes, <italic>V</italic><sub><italic>r</italic></sub> the set of reaction nodes, and <italic>E</italic>&#x02286;(<italic>V</italic><sub><italic>c</italic></sub>&#x000d7;<italic>V</italic><sub><italic>r</italic></sub>)&#x0222a;(<italic>V</italic><sub><italic>r</italic></sub>&#x000d7;<italic>V</italic><sub><italic>c</italic></sub>) is the set of weighted, directed edges denoting stoichiometric substrate-reaction and product&#x02013;reaction relationships. For example, an edge (<italic>c</italic>,<italic>r</italic>) specifies that compound <italic>c</italic> is a substrate of reaction <italic>r</italic>, while the stoichiometric coefficient <italic>s</italic><sub><italic>c</italic>,<italic>r</italic></sub> of <italic>c</italic> in <italic>r</italic> is represented as the weight of (<italic>c</italic>,<italic>r</italic>).</p><p>A compound node is uniquely represented by a name, a compartment and a mass vector, <italic>m</italic><sub><italic>c</italic></sub>&#x02208;&#x02115;<sup><italic>n</italic></sup>, i.e. the vector representation of the compound <italic>c</italic> over <italic>n</italic> chemical elements. For instance, when considering the six most abundant elements in biological systems: carbon (C), hydrogen (H), nitrogen (N), oxygen (O), phosphorus (P) and sulfur (S), then the mass vector of water is <italic>m</italic><sub><italic>H</italic><sub>2</sub><italic>O</italic></sub>=(0, 2, 0, 1, 0, 0)&#x000b7;(<italic>C</italic>, <italic>H</italic>, <italic>N</italic>, <italic>O</italic>, <italic>P</italic>, <italic>S</italic>)<sup><italic>T</italic></sup>. The set of considered chemical elements can be specified in a configuration file (see Reference Manual, available online at <ext-link ext-link-type="uri" xlink:href="http://mathbiol.mpimp-golm.mpg.de/massbalance/">http://mathbiol.mpimp-golm.mpg.de/massbalance/</ext-link>).</p><p>For a reaction <italic>r</italic>, <italic>r</italic><sub><italic>in</italic></sub> denotes the set of substrates, and <italic>r</italic><sub><italic>out</italic></sub> the set of products. A reaction node is uniquely represented by a name and its direction: reversible reactions are represented by one reaction node for each direction, <italic>r</italic><sup>+</sup> and <italic>r</italic><sup>&#x02212;</sup>, where <italic>r</italic><sup>+</sup><sub><italic>in</italic></sub>=<italic>r</italic><sup>&#x02212;</sup><sub><italic>out</italic></sub> and <italic>r</italic><sup>+</sup><sub><italic>out</italic></sub>=<italic>r</italic><sup>&#x02212;</sup><sub><italic>in</italic></sub>. A reaction is <italic>mass balanced</italic>, i.e. chemically feasible with respect to the conservation of mass, if the sum of its substrate atoms equals the sum of its product atoms:
<disp-formula id="M1"><label>(1)</label><graphic xlink:href="btr448m1"/></disp-formula></p><p>The randomization procedure consists of a pre-calculation step, which classifies the compounds from the network according to their chemical sum formula (see <xref ref-type="bibr" rid="B1">Basler <italic>et al.</italic>, 2011</xref>), followed by the actual randomization. The pre-calculation is executed only once for all subsequent randomizations of the same network, and renders the method applicable to large networks. A network is randomized by replacing the substrates and products of randomly chosen reactions by compounds from within the same network, and choosing their stoichiometric coefficients, such that Equation (<xref ref-type="disp-formula" rid="M1">1</xref>) is satisfied (<xref ref-type="fig" rid="F1">Fig. 1</xref>). The polynomial-time algorithm generates randomized networks uniformly at random and clearly outperforms switch randomization (see <xref ref-type="bibr" rid="B1">Basler <italic>et al.</italic>, 2011</xref>, <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/cgi/content/full/btr448/DC1">Supplementary Table S1</ext-link>).
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>Mass-balanced substitution of a substrate. A large number of substitutions is applied in order to obtain fully randomized networks.</p></caption><graphic xlink:href="btr448f1"/></fig></p></sec><sec id="SEC3"><title>3 APPLICATION</title><p><italic>JMassBalance</italic> is written in Java and comes with all required libraries. Hence, an installation is not required, and it can be used on any operating system with installed Java (<ext-link ext-link-type="uri" xlink:href="http://www.oracle.com">http://www.oracle.com</ext-link>).</p><p>The randomization procedure accepts network files in BioCyc, SBML, or a customizable text format. Additional optional parameters allow specifying whether unbalanced reactions in the original network should be fixed, whether compartments should be considered, the randomization depth and probability, and the number of randomized networks to generate. All calculations can easily be parallelized by executing the program multiple times with different network indices (see online Reference Manual). Switch randomization is also implemented, and can be applied to compare the results of the two null models.</p><p>In addition to randomization, the following structural properties can be calculated for the original and randomized networks, respectively, which allows to determine their statistical significance in a biologically meaningful context:
<list list-type="bullet"><list-item><p>Average path length: the average number of reactions on the shortest path between two compounds.</p></list-item><list-item><p>Clustering coefficient: average fraction of mutually connected neighbors of a node in the corresponding (unipartite) metabolite&#x02013;metabolite network.</p></list-item><list-item><p>Assortativity: correlation coefficient of the in-/out-degree of a node and the average in-/out-degree of its predecessors/successors in the corresponding (unipartite) metabolite&#x02013;metabolite network.</p></list-item><list-item><p><italic>n</italic>-cycles: the number of directed cycles of length <italic>n</italic> in the corresponding (unipartite) metabolite&#x02013;metabolite network.</p></list-item><list-item><p>Path: test whether the given compounds constitute a path.</p></list-item><list-item><p>Connectedness: test whether the given compounds are connected via paths.</p></list-item><list-item><p>Transition degree: the number of possible mass-balanced substitutions.</p></list-item><list-item><p>Local essentiality: the ratio of successor reactions affected by the knockout of a reaction.</p></list-item><list-item><p>Reaction centrality: the ratio of reactions globally affected by the knockout of a reaction.</p></list-item><list-item><p>Knockout set: the set of reactions globally affected by the knockout of a given reaction.</p></list-item><list-item><p>Degree distribution: the compound degree distribution.</p></list-item><list-item><p>Weight distribution: the distribution of edge weights.</p></list-item><list-item><p>Scope size distribution (<xref ref-type="bibr" rid="B4">Handorf <italic>et al.</italic>, 2005</xref>): the distribution of the number of compounds producible from a random set of seed compounds of the given size.</p></list-item><list-item><p>Distribution of &#x00394;<sup>0</sup><sub><italic>r</italic></sub> <italic>G</italic> (<xref ref-type="bibr" rid="B5">Mavrovouniotis, 1991</xref>): the distribution of the standard Gibbs free energy change of reactions.</p></list-item></list>
The randomized networks may be printed as stoichiometric matrices or as text files, thus enabling subsequent investigations, such as constraint-based analysis (<xref ref-type="bibr" rid="B2">Feist <italic>et al.</italic>, 2010</xref>).</p></sec><sec sec-type="conclusions" id="SEC4"><title>4 CONCLUSION</title><p><italic>JMassBalance</italic> is a flexible and efficient tool for assessing the significance of metabolic network properties through a biologically meaningful null model. It can be used to determine the salient structural properties of metabolic networks and to identify new properties, which are statistically significant and independent of basic physical constraints. Thus, we believe the tool is useful for the initial analysis of reconstructed metabolic networks, as well as subsequent network-based research.</p><p><italic>Funding</italic>: <funding-source>German Federal Ministry of Education and Research</funding-source> (grant number <award-id>0313924</award-id>).</p><p><italic>Conflict of Interest</italic>: none declared.</p></sec></body><back><ref-list><title>REFERENCES</title><ref id="B1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Basler</surname><given-names>G.</given-names></name><etal/></person-group><article-title>Mass-balanced randomization of metabolic networks</article-title><source>Bioinformatics</source><year>2011</year><volume>27</volume><fpage>1397</fpage><lpage>1403</lpage><pub-id pub-id-type="pmid">21436128</pub-id></element-citation></ref><ref id="B2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Feist</surname><given-names>A.M.</given-names></name><etal/></person-group><article-title>Model-driven evaluation of the production potential for growth-coupled products of escherichia coli</article-title><source>Metab Eng.</source><year>2010</year><volume>12</volume><fpage>173</fpage><lpage>186</lpage><pub-id pub-id-type="pmid">19840862</pub-id></element-citation></ref><ref id="B3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Guimer&#x000e0;</surname><given-names>R.</given-names></name><etal/></person-group><article-title>Classes of complex networks defined by role-to-role connectivity profiles</article-title><source>Nature Physics</source><year>2007</year><volume>3</volume><fpage>63</fpage><lpage>69</lpage></element-citation></ref><ref id="B4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Handorf</surname><given-names>T.</given-names></name><etal/></person-group><article-title>Expanding metabolic networks: Scopes of compounds, robustness, and evolution</article-title><source>J. Mol. Evol.</source><year>2005</year><volume>61</volume><fpage>498</fpage><lpage>512</lpage><pub-id pub-id-type="pmid">16155745</pub-id></element-citation></ref><ref id="B5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mavrovouniotis</surname><given-names>M.</given-names></name></person-group><article-title>Estimation of standard gibbs energy changes of biotransformations</article-title><source>J. Biol. Chem.</source><year>1991</year><volume>266</volume><fpage>14440</fpage><lpage>14445</lpage><pub-id pub-id-type="pmid">1860851</pub-id></element-citation></ref><ref id="B6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Milo</surname><given-names>R.</given-names></name><etal/></person-group><article-title>Network motifs: simple building blocks of complex networks</article-title><source>Science</source><year>2002</year><volume>298</volume><fpage>824</fpage><lpage>827</lpage><pub-id pub-id-type="pmid">12399590</pub-id></element-citation></ref><ref id="B7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sales-Pardo</surname><given-names>M.</given-names></name><etal/></person-group><article-title>Extracting the hierarchical organization of complex systems</article-title><source>Proc. Natl Acad. Sci. USA</source><year>2007</year><volume>104</volume><fpage>15224</fpage><lpage>15229</lpage><pub-id pub-id-type="pmid">17881571</pub-id></element-citation></ref></ref-list></back></article>