<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?properties manuscript?><front><journal-meta><journal-id journal-id-type="nlm-journal-id">100960938</journal-id><journal-id journal-id-type="pubmed-jr-id">32989</journal-id><journal-id journal-id-type="nlm-ta">Comput Stat Data Anal</journal-id><journal-id journal-id-type="iso-abbrev">Comput Stat Data Anal</journal-id><journal-title-group><journal-title>Computational statistics &#x00026; data analysis</journal-title></journal-title-group><issn pub-type="ppub">0167-9473</issn><issn pub-type="epub">1872-7352</issn></journal-meta><article-meta><article-id pub-id-type="pmid">28630525</article-id><article-id pub-id-type="pmc">5473477</article-id><article-id pub-id-type="doi">10.1016/j.csda.2016.09.006</article-id><article-id pub-id-type="manuscript">EMS71936</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>A Bayesian adaptive design for clinical trials in rare diseases</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Williamson</surname><given-names>S. Faye</given-names></name><xref ref-type="aff" rid="A1">a</xref><xref ref-type="corresp" rid="CR1">*</xref></contrib><contrib contrib-type="author"><name><surname>Jacko</surname><given-names>Peter</given-names></name><xref ref-type="aff" rid="A2">b</xref></contrib><contrib contrib-type="author"><name><surname>Villar</surname><given-names>Sof&#x000ed;a S.</given-names></name><xref ref-type="aff" rid="A3">c</xref></contrib><contrib contrib-type="author"><name><surname>Jaki</surname><given-names>Thomas</given-names></name><xref ref-type="aff" rid="A1">a</xref></contrib></contrib-group><aff id="A1"><label>a</label>Department of Mathematics and Statistics, Lancaster University, UK</aff><aff id="A2"><label>b</label>Department of Management Science, Lancaster University, UK</aff><aff id="A3"><label>c</label>MRC Biostatistics Unit, Cambridge, UK</aff><author-notes><corresp id="CR1"><label>*</label>Corresponding author. <email>s.f.williamson@lancaster.ac.uk</email> (S.F. Williamson).</corresp></author-notes><pub-date pub-type="nihms-submitted"><day>23</day><month>3</month><year>2017</year></pub-date><pub-date pub-type="epub"><day>28</day><month>9</month><year>2016</year></pub-date><pub-date pub-type="ppub"><month>9</month><year>2017</year></pub-date><pub-date pub-type="pmc-release"><day>01</day><month>9</month><year>2017</year></pub-date><volume>113</volume><fpage>136</fpage><lpage>153</lpage><!--elocation-id from pubmed: 10.1016/j.csda.2016.09.006--><permissions><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/4.0/"><license-p>This is an open access article under the CC BY license (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>).</license-p></license></permissions><abstract><p id="P1">Development of treatments for rare diseases is challenging due to the limited number of patients available for participation. Learning about treatment effectiveness with a view to treat patients in the larger outside population, as in the traditional fixed randomised design, may not be a plausible goal. An alternative goal is to treat the patients within the trial as effectively as possible. Using the framework of finite-horizon Markov decision processes and dynamic programming (DP), a novel randomised response-adaptive design is proposed which maximises the total number of patient successes in the trial and penalises if a minimum number of patients are not recruited to each treatment arm. Several performance measures of the proposed design are evaluated and compared to alternative designs through extensive simulation studies using a recently published trial as motivation. For simplicity, a two-armed trial with binary endpoints and immediate responses is considered. Simulation results for the proposed design show that: (i) the percentage of patients allocated to the superior arm is much higher than in the traditional fixed randomised design; (ii) relative to the optimal DP design, the power is largely improved upon and (iii) it exhibits only a very small bias and mean squared error of the treatment effect estimator. Furthermore, this design is fully randomised which is an advantage from a practical point of view because it protects the trial against various sources of bias. As such, the proposed design addresses some of the key issues that have been suggested as preventing so-called bandit models from being implemented in clinical practice.</p></abstract><kwd-group><kwd>Clinical trials</kwd><kwd>Rare diseases</kwd><kwd>Bayesian adaptive designs</kwd><kwd>Sequential allocation</kwd><kwd>Bandit models</kwd><kwd>Dynamic programming</kwd></kwd-group></article-meta></front><body><sec sec-type="intro" id="S1"><label>1</label><title>Introduction</title><p id="P2">Before any new medical treatment is made available to the public, clinical trials must be undertaken to ensure that the treatment is safe and efficacious. Development of treatments for rare diseases is particularly challenging due to the limited number of patients available for experimentation.</p><p id="P3">The current gold standard design is the randomised controlled trial, in which patients are randomised to either the experimental or control treatment in a pre-fixed proportion. Its main goal is to learn about treatment effectiveness with a view to prioritising future patients outside of the trial. Although this design can detect a significant treatment difference with a high probability, i.e. it maximises the statistical power, which is of benefit to future patients, it lacks the flexibility to incorporate other desirable criteria, such as the trial participant&#x02019;s well-being. As such, a large number of patients within the trial receive the inferior treatment. This is particularly concerning for rare disease trials in which a substantial proportion of all patients with the disease may be included in the trial. Moreover, there will be fewer patients available outside of the trial to benefit from the learning. Therefore, in this case, the priority should be on treating those patients within the trial as effectively as possible.</p><p id="P4">This motivates the use of response-adaptive designs for clinical trials involving rare diseases in which the accruing data on patient responses are used to skew the allocation towards the superior treatments, thus reducing patient exposure to inferior treatments. Although it does not fully eliminate the ethical problem of randomising patients to the inferior treatment, it certainly mitigates it by reducing the probability of allocation to the inferior treatment, if it exists.</p><p id="P5"><xref rid="R5" ref-type="bibr">Berry and Eick (1995)</xref> compare the performance of the traditional design, in which half of the participants receive treatment <italic>A</italic> and the other half receive treatment <italic>B</italic>, to four response-adaptive designs. They conclude that if the condition being treated is rare, then response-adaptive methods can perform substantially better and might be a more suitable alternative.</p><p id="P6">Despite the long history in clinical trials methodology, very few response-adaptive designs have actually occurred in practice and applications thus far have been disappointing (<xref rid="R14" ref-type="bibr">Rosenberger, 1999</xref>). This is largely attributable to the extracorporeal membrane oxygenation (ECMO) trial by <xref rid="R2" ref-type="bibr">Bartlett et al. (1985)</xref> which employed the randomised play-the-winner rule, a response-adaptive design described briefly in <xref ref-type="sec" rid="S2">Section 2</xref>.</p><p id="P7">The problem of designing a clinical trial which aims to identify the superior treatment (exploration or learning) whilst treating the trial participants as effectively as possible (exploitation or earning) is a natural application area for bandit models, a type of response-adaptive design. Bandit models seek to balance the exploration versus exploitation trade-off in order to obtain an optimal allocation policy which maximises the expected number of patient successes over a finite number of patients. As such, they present an appealing alternative to the traditional approach used in clinical trials. Across the bandit literature, the use of bandit models to optimally design a clinical trial is often referred to as the primary motivation for their study (<xref rid="R10" ref-type="bibr">Gittins, 1979</xref>). However, to the best of our knowledge, they have never been implemented in real clinical practice for reasons including lack of randomisation and biased treatment effect estimates. Moreover, in contrast to the traditional approach taken in clinical trials, bandit models exhibit very low power since it is not possible to maximise both power and patient successes simultaneously. For a discussion of the benefits and challenges of bandit models in clinical trial practice, see <xref rid="R16" ref-type="bibr">Villar et al. (2015a)</xref>.</p><p id="P8">In this paper, we propose a novel bandit-based design which provides a very appealing compromise between these two conflicting objectives and addresses some of the key issues that have prevented bandit models from being implemented in clinical trial practice. We modify the optimal design, which aims to maximise the expected number of patient successes, in such a way that we overcome its limitations without having a significant negative impact on the patient benefit.</p><p id="P9">The modifications involve incorporating randomisation into a currently deterministic design, which was considered by <xref rid="R8" ref-type="bibr">Cheng and Berry (2007)</xref>, and adding a constraint which forces a minimum number of patients on each treatment. These are described in <xref ref-type="sec" rid="S4">Sections 2.2</xref> and <xref ref-type="sec" rid="S5">2.3</xref>, respectively, building on the standard dynamic programming approach presented in <xref ref-type="sec" rid="S3">Section 2.1</xref>. In <xref ref-type="sec" rid="S8">Section 4</xref>, we compare our design to alternative designs via extensive simulations in several scenarios in the context of a recently published Phase II clinical trial of isotonic fluid resuscitation in children with severe malnutrition and hypovolaemia (<xref rid="R1" ref-type="bibr">Akech et al., 2010</xref>). We evaluate each design&#x02019;s performance according to the measures set out in <xref ref-type="sec" rid="S6">Section 3</xref>. We summarise the main conclusions in <xref ref-type="sec" rid="S15">Section 5</xref> and highlight areas for future research.</p></sec><sec sec-type="methods" id="S2"><label>2</label><title>Methods</title><p id="P10">In this section, we introduce different methods for allocating patients to treatments in a clinical trial. For simplicity of exposition, we consider a two-armed clinical trial with a binary endpoint and a finite number of patients within the trial, <italic>n</italic>. Patients enter the trial sequentially over time, one-by-one, and each patient is allocated to either treatment <italic>A</italic> or <italic>B</italic> on arrival. We assume that <italic>n</italic> is fixed but that the sample sizes for treatment groups <italic>A</italic> and <italic>B</italic>, denoted by <italic>N<sub>A</sub></italic> and <italic>N<sub>B</sub></italic> respectively, are random, where <italic>N<sub>A</sub></italic> + <italic>N<sub>B</sub></italic> = <italic>n</italic>. Let <italic>X</italic> and <italic>Y</italic> denote the patient&#x02019;s response (either a success or failure) from treatments <italic>A</italic> and <italic>B</italic> respectively, which we model as independent Bernoulli random variables. That is, <disp-formula id="FD1"><mml:math display="block" id="M1" overflow="scroll"><mml:mrow><mml:mi>X</mml:mi><mml:mo>&#x0223c;</mml:mo><mml:mtext>Bernoulli</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.2em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.2em"/><mml:mi>Y</mml:mi><mml:mo>&#x0223c;</mml:mo><mml:mtext>Bernoulli</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.2em"/><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where <italic>&#x003b8;<sub>A</sub></italic> and <italic>&#x003b8;<sub>B</sub></italic> are the unknown success probabilities of treatments <italic>A</italic> and <italic>B</italic> respectively. Further, assume that each patient&#x02019;s response from the allocated treatment becomes immediately available.</p><p id="P11">The <italic>fixed randomised</italic> design randomises patients to either treatment <italic>A</italic> or <italic>B</italic> with an equal, fixed probability, i.e. 50% in a two-armed trial. This will act as a reference to which each of the response-adaptive designs described below will be compared against.</p><p id="P12">One of the most well-known response-adaptive designs is the <italic>randomised play-the-winner</italic> (RPW) rule, a type of urn model, proposed by <xref rid="R18" ref-type="bibr">Wei and Durham (1978)</xref>. This design is very intuitive and applies specifically to clinical trials comparing two treatments with binary responses. Initially, an urn contains <italic>u</italic> balls of type <italic>A</italic> and <italic>u</italic> balls of type <italic>B</italic>. When a patient is recruited, a ball is drawn randomly from the urn with replacement; if it is a type <italic>A</italic> ball, the patient receives treatment <italic>A</italic> and if it is a type <italic>B</italic> ball, the patient receives treatment <italic>B</italic>. After each patient&#x02019;s outcome is observed, a decision about the urn composition is made depending on the observed result. Thus, a success on treatment <italic>A</italic>, or a failure on treatment <italic>B</italic>, generates an additional <italic>&#x003b2;</italic> type <italic>A</italic> balls and <italic>&#x003b1;</italic> type <italic>B</italic> balls in the urn. Similarly, a success on treatment <italic>B</italic>, or a failure on treatment <italic>A</italic>, will generate an additional <italic>&#x003b2;</italic> type <italic>B</italic> balls and <italic>&#x003b1;</italic> type <italic>A</italic> balls in the urn, where 0 &#x02264; <italic>&#x003b1;</italic> &#x02264; <italic>&#x003b2;</italic> are integers. In this way, the urn accumulates more balls representing the superior treatment, thus increasing the probability that a patient receives the current best treatment. Note that the RPW is essentially myopic (as are most response-adaptive designs) in the sense that it uses all of the past observations to treat the next patient as if this were the last patient in the trial.</p><sec id="S3"><label>2.1</label><title>Optimal design using dynamic programming (DP)</title><p id="P13">The RPW described above is not constructed based on any formal optimality criterion so we now turn our attention to an alternative approach which utilises dynamic programming. With this approach, prior information on the unknown parameters is used in conjunction with the incoming data (and the number of remaining patients in the trial) to determine the optimal treatment allocation for every patient of the trial.</p><p id="P14">Note that we use <italic>t</italic> to denote both time and the last patient treated in this model since they are analogous, that is, at time <italic>t</italic> we have treated <italic>t</italic> patients. The trial time is therefore bounded by 0 &#x02264; <italic>t</italic> &#x02264; <italic>n</italic>.</p><p id="P15">Since the treatment effects take values between zero and one, it is sensible to assign
the parameters independent Beta prior distributions <disp-formula id="FD2"><mml:math display="block" id="M2" overflow="scroll"><mml:mrow><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mtext>Beta</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.7em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.7em"/><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mtext>Beta</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.7em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.3em"/><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mn>1.</mml:mn></mml:mrow></mml:math></disp-formula> Since this is a conjugate prior with respect to
the Bernoulli likelihood function, the posterior distribution follows another
Beta distribution with parameters summarising the relevant information from the
trial to date (that is, the combination of the initial prior plus the
accumulated data). At time <italic>t</italic> &#x02265; 1, after observing
<italic>s<sub>A,t</sub></italic> (<italic>f<sub>A,t</sub></italic>)
successes (failures) on treatment <italic>A</italic>, and
<italic>s<sub>B,t</sub></italic> (<italic>f<sub>B,t</sub></italic>)
successes (failures) on treatment <italic>B</italic>, the posterior distribution
is expressed by <disp-formula id="FD3"><mml:math display="block" id="M3" overflow="scroll"><mml:mrow><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mtext>Beta</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.2em"/><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.7em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.7em"/><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mtext>Beta</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.2em"/><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> where <italic>s<sub>A,t</sub></italic> +
<italic>f<sub>A,t</sub></italic> + <italic>S<sub>B,t</sub></italic> +
<italic>f<sub>B,t</sub></italic> = <italic>t</italic> for
<italic>t</italic> &#x02265; 1. Therefore, it will only be necessary to
update the parameters of these distributions as the trial progresses. For
simplicity, let the prior information and data combined be denoted as
<disp-formula id="FD4"><label>(1)</label><mml:math display="block" id="M4" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.5em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.5em"/><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula> Therefore, <inline-formula><mml:math display="inline" id="M5" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> is the posterior probability (i.e. the
<italic>current belief</italic>) of success for treatment <italic>j</italic>
given the prior information and data up to patient <italic>t</italic>.</p><p id="P16">Let <italic>&#x003b4;<sub>j,t</sub></italic>, for <italic>t</italic> = 0, &#x02026; , <italic>n</italic> &#x02212; 1, be the binary indicator variable representing whether patient <italic>t</italic> + 1 is allocated to treatment <italic>j</italic> &#x02208; {<italic>A, B</italic>}, where <disp-formula id="FD5"><label>(2)</label><mml:math display="display" id="M6" overflow="scroll"><mml:mrow><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>patient</mml:mtext><mml:mspace width="0.2em"/><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.2em"/><mml:mtext>is</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>allocated</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>to</mml:mtext><mml:mspace width="0.2em"/><mml:mtext>treatment</mml:mtext><mml:mspace width="0.2em"/><mml:mi>j</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula> Using the jargon of dynamic programming, <italic>&#x003b4;<sub>j,t</sub></italic> is the reward for every successfully treated patient, and thus <inline-formula><mml:math display="inline" id="M7" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>&#x022c5;</mml:mo><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the expected (one-period) reward, where expectation is taken in the Bayesian sense, i.e. according to the current belief.</p><p id="P17">Let <italic>&#x003a0;</italic> be the family of admissible designs (i.e. allocation
policies) <italic>&#x003c0;</italic>, which are those such that
<inline-formula><mml:math display="inline" id="M8" overflow="scroll"><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mo>&#x02211;</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:mrow></mml:math></inline-formula> for all <italic>t</italic> since only one
treatment is allocated per patient. Let <italic>&#x02131;<sub>t</sub></italic>
(<italic>s<sub>A</sub></italic>, <italic>f<sub>A</sub></italic>,
<italic>s<sub>B</sub></italic>, <italic>f<sub>B</sub></italic>) be the
value function representing the maximum expected total reward, i.e. the maximum
Bayes-expected number of successes, in the rest of the trial after
<italic>t</italic> patients have been treated when the combined information
is (<italic>s<sub>A</sub></italic>, <italic>f<sub>A</sub></italic>,
<italic>s<sub>B</sub></italic>, <italic>f<sub>B</sub></italic>),
<disp-formula id="FD6"><mml:math display="block" id="M9" overflow="scroll"><mml:mrow><mml:msub><mml:mi>&#x02131;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>max</mml:mtext><mml:msup><mml:mi>&#x1d53c;</mml:mi><mml:mi>&#x003c0;</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>&#x003c0;</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi>&#x0220f;</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo>{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>&#x022c5;</mml:mo><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>u</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mo>|</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P18">Note that this depends on the total number of patients <italic>n</italic> even though we do not state it explicitly to simplify the notation.</p><p id="P19">The ultimate optimisation problem is to find an optimal design which maximises the expected total reward, i.e. the Bayes-expected number of successes, over the set of all policies in the whole trial for a given prior at time <italic>t</italic> = 0, namely, <disp-formula id="FD7"><label>(3)</label><mml:math display="block" id="M10" overflow="scroll"><mml:mrow><mml:msub><mml:mi>&#x02131;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P20">The problem summarised in <xref ref-type="disp-formula" rid="FD7">Eq. (3)</xref> is known as a <italic>finite-horizon Bayesian Bernoulli two-armed bandit problem</italic> which can be solved exactly using dynamic programming methods, giving rise to an optimal adaptive treatment allocation sequence. Specifically, one can implement a backward induction algorithm which starts with the last patient, patient <italic>n</italic>, and proceeds iteratively towards the first patient. Details of this algorithm can be found in <xref ref-type="supplementary-material" rid="SD1">Appendix A.1</xref>.</p><p id="P21">Suppose that <italic>t</italic> &#x0003c; <italic>n</italic>. If treatment <italic>A</italic> is allocated to the next patient, then the expected total reward, i.e. the Bayes-expected number of successes, for patients <italic>t</italic> + 1 to <italic>n</italic> under an optimal policy is <disp-formula id="FD8"><mml:math display="block" id="M11" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>&#x02131;</mml:mi><mml:mi>t</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>&#x022c5;</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x02131;</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>&#x022c5;</mml:mo><mml:msub><mml:mi>&#x02131;</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P22">Alternatively, if treatment <italic>B</italic> is allocated to the next patient, then the expected total reward, i.e. the Bayes-expected number of successes, for patients <italic>t</italic> + 1 to <italic>n</italic> under an optimal policy is <disp-formula id="FD9"><mml:math display="block" id="M12" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>&#x02131;</mml:mi><mml:mi>t</mml:mi><mml:mi>B</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>&#x022c5;</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x02131;</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo><mml:msub><mml:mi>&#x02131;</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P23">Therefore, the value function satisfies the following recurrence known as the <italic>principle of optimality</italic>, <disp-formula id="FD10"><label>(4)</label><mml:math display="block" id="M13" overflow="scroll"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>&#x02131;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>&#x02131;</mml:mi><mml:mi>t</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.2em"/><mml:msubsup><mml:mi>&#x02131;</mml:mi><mml:mi>t</mml:mi><mml:mi>B</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1.5em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.2em"/><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>&#x02131;</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.3em"/><mml:mtext>otherwise</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p id="P24">Unlike most response-adaptive designs, this is not a myopic allocation rule. Instead, all possible sequences of treatment allocations and responses are enumerated, and the sequence that maximises the expected number of patient successes over the finite planning horizon is selected (<xref rid="R12" ref-type="bibr">Hu and Rosenberger, 2006</xref>). As such, this approach is computationally intensive and suffers from the curse of dimensionality (<xref rid="R4" ref-type="bibr">Bellman, 1961</xref>). However, we provide an efficient algorithm for the optimal DP design, implemented in the statistical software R; the computational times are shown in Table A.2 of <xref ref-type="supplementary-material" rid="SD1">Appendix A.1</xref>.</p><p id="P25">The computational complexity of the dynamic programming methods to solve this problem is the main motivation behind the implementation of simpler index-based solutions which circumvent the aforementioned problem of dimensionality. One such solution, which we include as a comparator, is the <italic>Whittle index</italic> (WI) proposed by <xref rid="R19" ref-type="bibr">Whittle (1988)</xref>. This can be applied when the horizon is finite, which is the case with a clinical trial since there are a finite number of patients in the trial. It is derived from a relaxation of problem (<xref ref-type="disp-formula" rid="FD7">3</xref>), allowing the multi-armed problem to be decomposed into single-armed problems in which the states are augmented, adding the number of patients remaining to be treated as an additional state. Although the WI is a heuristic solution, it has been found to be near-optimal in several cases. See <xref rid="R16" ref-type="bibr">Villar et al. (2015a)</xref> for a detailed review of the WI as a potential patient allocation rule in a clinical trial.</p><p id="P26">It is shown in <xref rid="R16" ref-type="bibr">Villar et al. (2015a</xref>,<xref rid="R17" ref-type="bibr">b</xref>), and further illustrated by our results, that optimal designs which achieve the highest patient benefit suffer from very low power. Moreover, optimal designs are completely deterministic (<xref rid="R8" ref-type="bibr">Cheng and Berry, 2007</xref>) which means there is a risk of introducing various sources of bias into the trial, e.g. selection bias (<xref rid="R6" ref-type="bibr">Blackwell and Hodges, 1957</xref>). Both of these factors contribute to making the optimal design unsuitable to implement in clinical trial practice. Therefore, in the rest of this section we focus on modifications to the DP design which address these shortcomings, i.e. its determinism and low power, while improving over a fixed randomised design in terms of patient benefit measures, such as overall response.</p></sec><sec id="S4"><label>2.2</label><title>Optimal design using randomised dynamic programming (RDP)</title><p id="P27">Randomisation is a critical component in the design of clinical trials, not least to minimise the bias and confounding of results in order to achieve the desired accuracy and reliability (<xref rid="R9" ref-type="bibr">Chow and Liu, 2014</xref>). Therefore, a natural first step is to modify the optimal design by forcing actions to be randomised; see <xref rid="R8" ref-type="bibr">Cheng and Berry (2007)</xref>. This is achieved by assigning a probability to the allocation rule at each stage. In particular, we define the following actions so that each treatment has a probability of at least 1 &#x02212; <italic>p</italic> of being allocated to each patient, where 0.5 &#x02264; <italic>p</italic> &#x02264; 1 for two-armed trials and will be referred to as the degree of randomisation. Note that <italic>p</italic> = 0.5 and <italic>p</italic> = 1 correspond to fixed, equal randomisation and the DP design, respectively.</p><list list-type="simple" id="L1"><list-item><label>(i)</label><p id="P28">Action 1 (<italic>a</italic> = 1): The next patient receives treatment <italic>A</italic> with probability <italic>p</italic> and treatment <italic>B</italic> with probability 1 &#x02212; <italic>p</italic>.</p></list-item><list-item><label>(ii)</label><p id="P29">Action 2 (<italic>a</italic> = 2): The next patient receives treatment <italic>B</italic> with probability <italic>p</italic> and treatment <italic>A</italic> with probability 1 &#x02212; <italic>p</italic>.</p></list-item></list><p id="P30">The associated expected total reward under this new action definition changes, along with the corresponding value function. Specifically, the expected total reward, i.e. the Bayes-expected number of successes, for patients <italic>t</italic> + 1 to <italic>n</italic> when <italic>a</italic> = 1 is now given by <disp-formula id="FD11"><mml:math display="block" id="M14" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>&#x02131;</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mo>&#x022c5;</mml:mo><mml:msubsup><mml:mi>&#x02131;</mml:mi><mml:mi>t</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x022c5;</mml:mo><mml:msubsup><mml:mi>&#x02131;</mml:mi><mml:mi>t</mml:mi><mml:mi>B</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> and analogously when <italic>a</italic> = 2, <disp-formula id="FD12"><mml:math display="block" id="M15" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>&#x02131;</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x022c5;</mml:mo><mml:msubsup><mml:mi>&#x02131;</mml:mi><mml:mi>t</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mo>&#x022c5;</mml:mo><mml:msubsup><mml:mi>&#x02131;</mml:mi><mml:mi>t</mml:mi><mml:mi>B</mml:mi></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p><p id="P31">Thus, in contrast to that shown in (<xref ref-type="disp-formula" rid="FD10">4</xref>), the value function satisfies <disp-formula id="FD13"><mml:math display="block" id="M16" overflow="scroll"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>&#x02131;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>&#x02131;</mml:mi><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x02131;</mml:mi><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext>for</mml:mtext><mml:mspace width="0.2em"/><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>&#x02131;</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mtext>otherwise</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p id="P32">We refer to this design as the <italic>randomised dynamic programming</italic> (RDP) design hereafter.</p><p id="P33">Preferably, we would like <italic>p</italic> to be as close to one as possible so that the action that allocates to the superior treatment with probability <italic>p</italic> is as effective as possible. However, this would entail that sometimes, by chance, the inferior treatment is sampled too few times or not at all. The possibility of this undesirable event occurring makes this design unsuitable to implement in practice as it results in low power and largely biased estimates.</p></sec><sec id="S5"><label>2.3</label><title>Optimal design using constrained randomised dynamic programming (CRDP)</title><p id="P34">In order to circumvent having few or no observations on a treatment, we modify the optimal design further by adding a constraint to ensure that we always obtain at least <italic>&#x1d4c1;</italic> observations from each treatment arm, where <italic>&#x1d4c1;</italic> is a fixed predefined value and will be referred to as the degree of constraining. To do this, we add a penalty to the reward function for every combination of the states that give rise to less than <italic>&#x1d4c1;</italic> observations on a treatment arm at the end of the trial.</p><p id="P35">We formulate this model as a Markov decision process with the following elements: <list list-type="simple" id="L2"><list-item><label>(i)</label><p id="P36">Let <inline-formula><mml:math display="inline" id="M17" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be the vector of states
representing all the information that is needed in order to choose
an action for patient <italic>t</italic>, where
<inline-formula><mml:math display="inline" id="M18" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are as defined previously in (<xref ref-type="disp-formula" rid="FD4">1</xref>), and
<inline-formula><mml:math display="inline" id="M19" overflow="scroll"><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> is the number of patients in the
trial remaining to be treated.</p></list-item><list-item><label>(ii)</label><p id="P37">The action set, <inline-formula><mml:math display="inline" id="M300" overflow="scroll"><mml:mi>&#x1d4d0;</mml:mi></mml:math></inline-formula>; = {1, 2}, is composed of Action 1 (<italic>a</italic> = 1) and Action 2 (<italic>a</italic> = 2) as defined in <xref ref-type="sec" rid="S4">Section 2.2.</xref></p></list-item><list-item><label>(iii)</label><p id="P38">The expected (one-period) reward under action <italic>a</italic> is given by <inline-formula><mml:math display="inline" id="M20" overflow="scroll"><mml:mrow><mml:msup><mml:mi>&#x0211b;</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> If we are not at the end of the trial (<inline-formula><mml:math display="inline" id="M21" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mo>&#x02265;</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> then <disp-formula id="FD14"><mml:math display="block" id="M22" overflow="scroll"><mml:mrow><mml:msup><mml:mo>&#x0211b;</mml:mo><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mo>&#x02265;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi><mml:mspace width="0.5em"/><mml:mo>.</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.5em"/><mml:mo>.</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="0.2em"/><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.5em"/><mml:mo>.</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>p</mml:mi><mml:mspace width="0.5em"/><mml:mo>.</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="0.2em"/><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>2.</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula> Otherwise, if we are at the end of the trial with no more patients left to treat <inline-formula><mml:math display="inline" id="M23" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, then <disp-formula id="FD15"><mml:math display="block" id="M24" overflow="scroll"><mml:mrow><mml:mo>&#x0211b;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mo>&#x0003c;</mml:mo><mml:mspace width="0.2em"/><mml:mi>l</mml:mi><mml:mspace width="0.2em"/><mml:mtext>or</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.2em"/><mml:mo>&#x0003c;</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>otherwise</mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula> where &#x02013;<italic>n</italic> is the penalty chosen because it is a large negative value which will cause the algorithm to avoid the undesirable states.</p></list-item><list-item><label>(iv)</label><p id="P39">The non-zero transition probabilities, <inline-formula><mml:math display="inline" id="M25" overflow="scroll"><mml:mrow><mml:mi>&#x02119;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mtext mathvariant="bold-italic">z</mml:mtext><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mtext mathvariant="bold-italic">z</mml:mtext><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> representing the evolution of the states from patient <italic>t</italic> to <italic>t</italic> + 1 under Action 1 and Action 2, respectively, are given as follows (where w.p. means &#x0201c;with probability&#x0201d;).</p><p id="P40">When <italic>a</italic> = 1: <disp-formula id="FD16"><mml:math display="block" id="M26" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>w</mml:mtext><mml:mo>.</mml:mo><mml:mtext>p</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi><mml:mo>.</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>w</mml:mtext><mml:mo>.</mml:mo><mml:mtext>p</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi><mml:mo>.</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>w</mml:mtext><mml:mo>.p</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>w</mml:mtext><mml:mo>.</mml:mo><mml:mtext>p</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula> When <italic>a</italic> = 2:
<disp-formula id="FD17"><mml:math display="block" id="M27" overflow="scroll"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>w</mml:mtext><mml:mo>.</mml:mo><mml:mtext>p</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>w</mml:mtext><mml:mo>.</mml:mo><mml:mtext>p</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>w</mml:mtext><mml:mo>.</mml:mo><mml:mtext>p</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi><mml:mo>.</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>n</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>w</mml:mtext><mml:mo>.</mml:mo><mml:mtext>p</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi>p</mml:mi><mml:mo>.</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p></list-item></list>
</p><p id="P41">We refer to our proposed design as the <italic>constrained randomised dynamic programming</italic> (CRDP) design hereafter. For details of how this design was implemented in R, refer to the supplementary material which can be found online at <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.csda.2016.09.006">http://dx.doi.org/10.1016/j.csda.2016.09.006</ext-link>.</p></sec></sec><sec id="S6"><label>3</label><title>Simulation set-up</title><p id="P42">We implement all of the above designs in several two-arm trial scenarios via simulations which will now be discussed, along with the performance measures that we use to compare and evaluate each design. The scenarios created are motivated by a recently published trial, as reported by <xref rid="R1" ref-type="bibr">Akech et al. (2010)</xref>, which evaluated the effect of two different resuscitation treatments for children aged over six months with severe malnutrition and shock. The aim of the trial was to recruit 90 eligible patients, where 45 would be randomly assigned to group 0 (low dose hypotonic fluid: HSD/5D) and 45 to group 1 (Ringer&#x02019;s Lactate: RL). The original trial allocated patients between the two arms with a fixed and equal randomisation probability of 0.5. The primary response outcomes were binary and available at eight and 24 h after randomisation (resolution of shock by 8/24 h). For this trial, 61 children were recruited, 26 received arm 0 and 29 received arm 1. At the end of the trial, the success rates observed in groups 0 and 1 at eight hours were 32% and 44%, respectively, and at 24 h were 22% and 44%, respectively. Although these differences were not statistically significant, the relatively quickly observed primary endpoint, the life-threatening nature of the disease, and the fact that patient recruitment is challenging, makes this trial an ideal motivating scenario for testing our proposed design.</p><p id="P43">Assuming that we begin the trial (at <italic>t</italic> = 0) in a state of equipoise, that is, a state of genuine uncertainty about which treatment is superior, we let <italic>s</italic><sub><italic>A</italic>,0</sub> = <italic>f</italic><sub><italic>A</italic>,0</sub> = <italic>s</italic><sub><italic>B,0</italic></sub> = <italic>f</italic><sub><italic>B,</italic>0</sub> = 1, reducing this to a uniform prior.</p><p id="P44">We consider the following hypothesis <disp-formula id="FD18"><mml:math display="block" id="M28" overflow="scroll"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mspace width="0.4em"/><mml:mtext>versus</mml:mtext><mml:mspace width="0.4em"/><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:mspace width="0.2em"/><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>&#x02260;</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> which will be tested using Fisher&#x02019;s exact test (<xref rid="R15" ref-type="bibr">Routledge, 2005</xref>) for comparing the success probabilities of two binomial distributions. Fisher&#x02019;s exact test is probably the most common choice for binary outcomes and a small sample size. This test is a conditional test (conditioning on the marginals), which increases the discreteness and thus the conservatism of the test (<xref rid="R13" ref-type="bibr">Kateri, 2014</xref>). This means that the observed rejection rate is often far below the nominal significance level. Therefore, we set the nominal significance level to 0.1 throughout so that the observed type I error value will be closer to 0.05.</p><p id="P45">Alternatively, we could have followed a Bayesian inference procedure. However, in a clinical trial context a traditional hypothesis test is expected (due to both this being a common practice and because of regulatory requirements). Also, since all the simulations included in this paper use an uninformative prior, the impact of using a Bayesian estimator instead of the sample proportion for point estimation and decision making would be negligible.</p><p id="P46">In order to create a comprehensive picture of our proposed design, we run our simulations for a range of combinations of the success probability parameters <italic>&#x003b8;<sub>A</sub></italic> and <italic>&#x003b8;<sub>B</sub></italic>. Specifically, we consider <italic>&#x003b8;<sub>A</sub></italic> = 0.2 against <italic>&#x003b8;<sub>B</sub></italic> = (0.1, 0.2, &#x02026; , 0.9), and similarly for <italic>&#x003b8;<sub>A</sub></italic> = 0.5 and 0.8. In the following, we focus on the scenario where <italic>&#x003b8;<sub>A</sub></italic> is fixed at 0.5 for all <italic>&#x003b8;<sub>B</sub></italic> &#x02208; (0.1, 0.9) since the patterns observed for the other cases are very similar.</p><p id="P47">Furthermore, we repeat the simulations for different total sample sizes. The results for <italic>n</italic> = 75 are reported throughout because this shows a good range of power values across all scenarios and clearly highlights the differences between each design, thus enabling us to make better comparisons. The results for <italic>n</italic> = 25, 50 and 100 are shown in Figs. A.10&#x02013;A.12 of <xref ref-type="supplementary-material" rid="SD1">Appendix A.6</xref>.</p><p id="P48">We evaluate the performance of these designs by simulating 10,000 replications of each trial and taking the average values over these runs.</p><sec id="S7"><label>3.1</label><title>Performance measures</title><p id="P49">In addition to the operating characteristics, such as the power and type I error rate, we also consider the ethical performance of each design since this is one of the major advantages of response-adaptive designs over traditional fixed designs. Specifically, the criteria we focus on to assess the performance of each design are: <list list-type="order" id="L4"><list-item><p id="P50"><bold>Power</bold>. The proportion of times we <italic>correctly</italic> reject <italic>H</italic><sub>0</sub> in the 10,000 trial replicas, i.e. the probability of making the correct decision at the end of the trial, so we want this to be high. This provides an informative measure of how well a test performs. This is calculated when <italic>&#x003b8;<sub>A</sub></italic> &#x02260; <italic>&#x003b8;<sub>B</sub></italic>.</p></list-item><list-item><p id="P51"><bold>Type I error rate</bold>. The proportion of times we <italic>incorrectly</italic> reject <italic>H</italic><sub>0</sub>, i.e. the probability of making the incorrect decision at the end of the trial, so we want this to be low. This is calculated when <italic>&#x003b8;<sub>A</sub></italic> = <italic>&#x003b8;<sub>B</sub></italic>.</p></list-item><list-item><p id="P52"><bold>Percentage of patients allocated to the superior treatment arm</bold>. This measures the ethical performance of each design, which we wish to maximise.</p></list-item><list-item><p id="P53"><bold>Average bias of the estimator</bold>. This provides a measure of bias in the estimate of the treatment effect, where we define treatment effect as the treatment difference, <inline-formula><mml:math display="inline" id="M29" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>&#x00394;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>B</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> The estimator of <italic>&#x003b8;<sub>A</sub></italic> and <italic>&#x003b8;<sub>B</sub></italic> is simply the sample proportion <inline-formula><mml:math display="inline" id="M30" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mspace width="0.2em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.2em"/><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>B</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> respectively. This is the observed proportion of successes in either treatment group by the end of the trial (at time <italic>t</italic> = <italic>n</italic>). The average bias of this estimator is defined to be the difference between the estimated success probability difference and the true success probability difference, that is, <disp-formula id="FD19"><label>(5)</label><mml:math display="block" id="M31" overflow="scroll"><mml:mrow><mml:mtext>Bias</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>&#x00394;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>&#x1d53c;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>&#x00394;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>&#x02212;</mml:mo><mml:mi>&#x00394;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></list-item><list-item><p id="P54"><bold>Mean squared error (MSE) of the estimator</bold>. The MSE provides a measure of
the quality and variability of the estimator, <mml:math display="inline" id="M100" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>&#x00394;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math>, and is defined by <disp-formula id="FD20"><mml:math display="block" id="M32" overflow="scroll"><mml:mrow><mml:mtext>MSE(</mml:mtext><mml:mover accent="true"><mml:mi>&#x00394;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mtext>)</mml:mtext><mml:mo>=</mml:mo><mml:mo>&#x1d53c;</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mi>&#x00394;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mi>&#x00394;</mml:mi><mml:msup><mml:mo>)</mml:mo><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula> which can be expressed in terms of
the bias and variance of the estimator as, <disp-formula id="FD21"><label>(6)</label><mml:math display="block" id="M33" overflow="scroll"><mml:mrow><mml:mtext>MSE</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>&#x00394;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>Bias</mml:mtext><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>&#x00394;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mtext>Var</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>&#x00394;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p></list-item></list>
</p></sec></sec><sec id="S8"><label>4</label><title>Simulation results and design comparison</title><p id="P55">We compare our proposed design to the alternative designs outlined in <xref ref-type="sec" rid="S2">Section 2</xref> based upon the performance measures highlighted in <xref ref-type="sec" rid="S7">Section 3.1</xref>. We set <italic>p</italic> = 0.9 as the degree of randomisation and <italic>&#x1d4c1;</italic> = 0.15<italic>n</italic> as the degree of constraining in our proposed CRDP design, which we believe yields robust design characteristics for many scenarios of interest and could be used as a quick rule of thumb. Alternatively, <italic>&#x1d4c1;</italic> could be heuristically determined as the minimum sample size per arm required to attain a power of (1 &#x02212; <italic>&#x003b3;</italic>) in a fixed randomised design, where (1 &#x02212; <italic>&#x003b3;</italic>) &#x02264; (1 &#x02212; <italic>&#x003b2;</italic>) and (1 &#x02212; <italic>&#x003b2;</italic>) is the power level obtained by a fixed randomised trial of size <italic>n</italic>. In the following two paragraphs, we describe a more formal heuristic approach to determine <italic>p</italic> and <italic>&#x1d4c1;</italic> when higher precision is needed to trade-off power and patient benefit.</p><p id="P56">We tried a range of values for <italic>&#x1d4c1;</italic> &#x02208; (0.05<italic>n</italic>, 0.50<italic>n</italic>) (where 0.50<italic>n</italic> corresponds to fixed equal randomisation) and found that as <italic>&#x1d4c1;</italic> increases, the power of the design increases hyperbolically, while the percentage of patients allocated to the superior treatment decreases linearly. This is illustrated in Fig. A.8 of <xref ref-type="supplementary-material" rid="SD1">Appendix A.2</xref>. We recommend choosing <italic>&#x1d4c1;</italic> &#x02208; (0.10<italic>n,</italic> 0.15<italic>n</italic>) because for values of <italic>&#x1d4c1;</italic> &#x0003c; 0.10<italic>n</italic>, the power is insufficient, and for values of <italic>&#x1d4c1;</italic> &#x0003e; 0.15<italic>n</italic>, the very small gains in power do not outweigh the considerable reduction in the percentage of patients allocated to the superior treatment.</p><p id="P57">Similarly, we tried a range of values for <italic>p</italic> &#x02208; (0.5, 1) (where <italic>p</italic> = 0.5 and <italic>p</italic> = 1 correspond to fixed equal randomisation and the DP design, respectively) and found that there is only a slight decrease in power, but a very large increase in the percentage of patients allocated to the superior treatment as <italic>p</italic> increases from 0.5 to 0.9; see Tables A.3&#x02013;A.6 in <xref ref-type="supplementary-material" rid="SD1">Appendix A.3</xref>. Therefore, we take <italic>p</italic> = 0.9 since this produces a good balance between the power and patient benefit across a wide range of scenarios and sample sizes.</p><sec id="S9"><label>4.1</label><title>Power and type I error</title><p id="P58"><xref ref-type="fig" rid="F1">Fig. 1</xref> illustrates the statistical power, and type I error, of a study with 75 observations, where the result for <italic>&#x003b8;<sub>A</sub></italic> = <italic>&#x003b8;<sub>B</sub></italic> corresponds to the type I error rate. It can be seen that the fixed randomised design attains the highest power for all scenarios, as expected since this design aims to maximise the power and prioritise future patients.</p><p id="P59">In contrast, the power of the DP design, and the WI policy, is drastically reduced, even for large treatment differences. This is what we would expect since it is not possible to maximise both power and patient successes simultaneously, and unlike the fixed design, the optimal design aims to maximise the expected number of successes within the trial. Therefore, although the DP and WI designs are able to identify the superior treatment arm, they are unable to do so with sufficient statistical significance. We can see that the power of these designs lies below 0.3 for all <italic>&#x003b8;<sub>B</sub></italic> &#x02208; (0.1, 0.9), confirming that they are severely underpowered. As a result, they are clearly unsuitable to implement in practice.</p><p id="P60"><xref ref-type="fig" rid="F1">Fig. 1</xref> also shows that although the power of the RDP design is not as high as that of the fixed design, it greatly improves on the power of the other bandit designs aforementioned, and even exceeds the 0.8 level (illustrated by the upper dashed line) for some scenarios. Our proposed CRDP achieves even better power, with its power values lying much closer to those for the fixed design than the other bandit designs.</p><p id="P61">The obvious patterns, such as the power increasing with the size of the treatment difference for each design, are apparent in <xref ref-type="fig" rid="F1">Fig. 1</xref>. Furthermore, additional evaluations for other sample sizes show similar patterns and can be seen in Fig. A.10 of the <xref ref-type="supplementary-material" rid="SD1">Appendix A.6</xref>.</p><p id="P62">Turning our attention to the type I error rates, we see that the type I error rate of both the DP and WI designs lies markedly below the nominal significance level at 0.1 (illustrated by the lower dashed line in <xref ref-type="fig" rid="F1">Fig. 1</xref>) and is therefore greatly deflated for both designs. However, all of the other designs attain similar, higher observed type I error rates which are much closer to the nominal significance level and thus have better controlled type I error rates.</p></sec><sec id="S10"><label>4.2</label><title>Patient benefit</title><p id="P63"><xref ref-type="fig" rid="F2">Fig. 2</xref> shows the percentage of patients (out of a total of 75) that receive the superior treatment within the trial. Note that when <italic>&#x003b8;<sub>A</sub></italic> = <italic>&#x003b8;<sub>B</sub></italic>, we define treatment <italic>A</italic> as the superior treatment for illustrative purposes and all designs show that approximately 50% of patients receive the superior treatment in this case, as expected.</p><p id="P64">The DP and WI designs perform the best, resulting in the highest percentage of patients receiving the superior treatment. This is not at all surprising considering they are designed to maximise the expected total reward (patient successes) within the trial in order to satisfy the patient benefit criterion.</p><p id="P65">At the other extreme, by design, the fixed randomised design allocates only 50% of the patients to the superior treatment in every scenario. Although the RPW does outperform the fixed design in terms of the patient benefit, the percentage of patients that are on the superior treatment is still much lower compared to all the other designs.</p><p id="P66"><xref ref-type="fig" rid="F2">Fig. 2</xref> shows that the RDP and CRDP designs perform very well and the percentage of patients receiving the superior treatment is still sufficiently high, with the CRDP line lying slightly below the RDP line due to the addition of the constraint. The largest difference between our proposed CRDP and DP designs is approximately 10%, which occurs at either end of the plot when the size of the treatment difference is at its largest. Moreover, our proposed CRDP design allocates a maximum of approximately 21% and 35% more patients to the superior treatment than the RPW and fixed designs, respectively.</p><p id="P67">For all designs (excluding the fixed), <xref ref-type="fig" rid="F2">Fig. 2</xref> shows that the percentage of patients allocated to the superior treatment increases with the magnitude of the treatment difference, with the higher values occurring at the tails of the graph which correspond to the larger treatment differences. Furthermore, similar patterns are observed for other sample sizes; see Fig. A.11 in <xref ref-type="supplementary-material" rid="SD1">Appendix A.6</xref>.</p></sec><sec id="S11"><label>4.3</label><title>Average Bias</title><p id="P68"><xref ref-type="fig" rid="F3">Fig. 3</xref> shows the average bias of the sample proportion as an estimator for the treatment effect, as defined by (<xref ref-type="disp-formula" rid="FD19">5</xref>), in a study with 75 observations. We see that the fixed randomised design produces the best result in terms of the bias, with its associated estimator attaining zero bias for all scenarios, as it should.</p><p id="P69">At the other extreme, the DP and WI designs exhibit the largest statistical bias with a maximum absolute value of 0.2 occurring when <italic>&#x003b8;<sub>B</sub></italic> = 0.9. Therefore, the corresponding estimates following such bandit designs will be biased due to the underlying dependence structure induced in the resulting observations. This is reflected in <xref ref-type="table" rid="T1">Table 1</xref> which directly reports the raw estimates of the success probabilities, <inline-formula><mml:math display="inline" id="M34" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math display="inline" id="M35" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>B</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula>
<xref ref-type="table" rid="T1">Table 1</xref> shows that in the DP design, the estimate of the success probability for the inferior arm is substantially underestimated. The estimate for the superior arm is also underestimated, but less than for the inferior arm, particularly when the treatment difference is relatively small. This implies that the estimate of the treatment difference, <mml:math display="inline" id="M101" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>&#x00394;</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math>, is generally overestimated. Since bandit designs allocate fewer patients to the inferior treatment, it makes sense that the estimate corresponding to this arm is worse than that of the superior arm because there are fewer observations to base the inference on.</p><p id="P70">Once randomisation is incorporated into the DP design, we see that the bias is
drastically reduced across all scenarios, with a maximum absolute value of 0.027
which is 85% smaller than the worst-case bias of the other bandit designs.
Moreover, our proposed CRDP design performs significantly better than the RDP,
reducing the bias of the treatment effect estimator even further. In fact, the
bias values for our proposed CRDP are very close to zero for all scenarios with
a maximum bias value of only 0.014 which is 93% smaller than the worst-case bias
for the DP design. As such, the bias following our proposed CRDP is negligible
compared to the very large bias exhibited by the other bandit designs and hence,
the estimate of the treatment effect following our proposed CRDP design is
essentially mean-unbiased. Again, this is reflected in <xref ref-type="table" rid="T1">Table 1</xref> which shows that in our proposed CRDP design,
<inline-formula><mml:math display="inline" id="M36" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math display="inline" id="M37" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>B</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> are now much closer to their true values.
Moreover, there is a large improvement in the estimate of the success
probability for the inferior arm compared to the DP design since it is now only
slightly underestimated.</p><p id="P71">Note that we can clearly see from <xref ref-type="fig" rid="F3">Fig. 3</xref> that all designs correctly attain a bias of zero for the treatment effect estimate when <italic>&#x003b8;<sub>A</sub></italic> = <italic>&#x003b8;<sub>B</sub></italic>. Similar results for different <italic>n</italic> are provided in Fig. A.12 of <xref ref-type="supplementary-material" rid="SD1">Appendix A.6</xref>.</p></sec><sec id="S12"><label>4.4</label><title>Mean squared error</title><p id="P72"><xref ref-type="fig" rid="F4">Fig. 4</xref> shows the mean squared error (MSE) of the treatment effect estimator, as defined by (<xref ref-type="disp-formula" rid="FD21">6</xref>), for a study with 75 observations. The fixed randomised design results in the smallest MSE, with values fairly constant and close to zero for all scenarios.</p><p id="P73">The DP and WI designs exhibit the largest MSE values, with the MSE of the WI design exceeding those of the DP design for all scenarios. This is a direct consequence of the large bias observed in <xref ref-type="fig" rid="F3">Fig. 3</xref>. Moreover, these designs experience the largest increase in MSE as <italic>&#x003b8;<sub>B</sub></italic> increases from 0.1 to 0.7, after which point they remain fairly constant. Specifically, as <italic>&#x003b8;<sub>B</sub></italic> increases from 0.1 to 0.7, the MSE jumps from 0.016 to 0.141 for the WI design, and from 0.015 to 0.133 for the DP design. We also notice from <xref ref-type="fig" rid="F4">Fig. 4</xref> that the associated MSE plots for the DP and WI designs are not symmetric about <italic>&#x003b8;<sub>B</sub></italic> = 0.5 (represented by the dashed vertical line). This is a result of the variance of the estimator increasing markedly as <italic>&#x003b8;<sub>B</sub></italic> increases from 0.1 to 0.6, in addition to the bias for the DP and WI being much larger for larger values of <italic>&#x003b8;<sub>B</sub></italic>.</p><p id="P74">Once randomisation is incorporated into the DP, the MSE is reduced for all scenarios, from a worst-case value of 0.141 in the WI design to a worst-case value of 0.032 in the RDP design which is a 77.3% improvement. Moreover, our proposed CRDP design improves the MSE values even further, with a lower and an upper bound of 0.011 and 0.026, respectively. The majority of the MSE values lie around 0.030 for the RDP design and 0.020 for our proposed CRDP design. In contrast to the steep curves of the DP and WI designs, the MSE values associated with the RDP and our proposed CRDP designs remain fairly constant (as with the fixed and RPW designs), thus giving rise to the relatively flat curves visible in <xref ref-type="fig" rid="F4">Fig. 4</xref>. Furthermore, we see that the curve corresponding to our proposed CRDP lies fairly close to the curve for the fixed design. Thus, the MSE values of the treatment effect estimator following our proposed CRDP design are comparable to that of the fixed design, staying close to zero for all scenarios, and are a huge improvement on those exhibited by the DP and WI bandit designs.</p></sec><sec id="S13"><label>4.5</label><title>Overall performance</title><p id="P75"><xref ref-type="fig" rid="F5">Fig. 5</xref> shows a star plot for each design against power, patient benefit, average bias of the treatment effect estimator and MSE in a trial with 75 patients when <italic>&#x003b8;<sub>A</sub></italic> = 0.5 and <italic>&#x003b8;<sub>B</sub></italic> = 0.2. The most desirable values lie towards the outer edge of the star plot with the least favourable values towards the centre. <xref ref-type="fig" rid="F5">Fig. 5</xref> summarises the key features of each design showing that the fixed design performs very well with respect to power, average bias and MSE but poorly with respect to patient benefit, whilst in contrast the DP design performs poorly with respect to power, average bias and MSE but very well with respect to patient benefit. Our proposed CRDP design, on the other hand, has values lying near to the outer edge of the star plot for power, average bias, MSE and patient benefit, thus showing that it performs well with respect to all of the performance measures. Table A.7 in <xref ref-type="supplementary-material" rid="SD1">Appendix A.5</xref> reports additional combined measures that complement <xref ref-type="fig" rid="F5">Fig. 5</xref> to compare the designs.</p></sec><sec id="S14"><label>4.6</label><title>CRDP patient allocation</title><p id="P76"><xref ref-type="fig" rid="F6">Fig. 6</xref> shows the average allocation probability to the superior treatment <italic>B</italic> under the CRDP design for every patient <italic>t</italic> in a trial with 75 patients when <italic>&#x003b8;<sub>A</sub></italic> = 0.5 and <italic>&#x003b8;<sub>B</sub></italic> = 0.7. This figure illustrates how the CRDP design adaptively allocates patients between the two treatments over time. The average allocation probability to a superior arm grows steadily through the trial towards the degree of randomisation selected (<italic>p</italic> = 0.9), but without reaching it in this scenario. As the trial approaches the treatment decisions for its final 15 patients, this probability markedly oscillates in order to satisfy the degree of constraining. This indicates that an important number of allocations to the inferior arm under the CRDP design tend to occur by the end of the trial rather than at the beginning of it. <xref ref-type="fig" rid="F7">Fig. 7</xref> also illustrates this point by plotting the observed patient allocations during five different trial realisations.</p></sec></sec><sec sec-type="discussion" id="S15"><label>5</label><title>Discussion</title><p id="P77">In this paper, we evaluate different methods for allocating patients to treatments. The DP design performs very well when considering patient benefit compared to traditional fixed randomisation. However, this method suffers from an extremely low power to detect a significant treatment difference, biased estimates of the treatment effect and a large MSE. Moreover, it is completely deterministic and thus at risk of many possible sources of bias.</p><p id="P78">At the other extreme, fixed randomisation performs very well in terms of the statistical criteria, exhibiting high power, unbiased estimates of the treatment effect and small MSE. However, it allocates a large proportion of patients to the inferior treatment arm. This is particularly detrimental for rare, and fatal, diseases in which a substantial proportion of patients exhibiting the disease may be included in the trial and therefore the priority should be to treat these patients as effectively as possible.</p><p id="P79">We propose modifications to the DP design which overcome its current limitations and offer patient benefit advantages over a fixed randomised design by randomising in an optimal way and forcing a minimum number of patients on each arm. Our formal, mathematical approach grounded in decision theory creates a continuum of designs, with DP and fixed randomisation at the extremes, which offers freedom in choosing the most appropriate balance by fixing a degree of randomisation and a degree of constraining. This greatly increases the prospects of a bandit-based design being implemented in real clinical trial practice, particularly for trials involving rare diseases and small populations where the fixed randomisation approach is no longer the most appropriate design to use and is often not feasible due to the small sample sizes involved.</p><p id="P80">Our proposed CRDP design, with suggested degree of randomisation <italic>p</italic> = 0.9 and degree of constraining <italic>&#x1d4c1;</italic> = 0.15<italic>n</italic>, seems to perform robustly in a range of simulated scenarios (not all of which are reported in the paper). The power is only slightly lower than with fixed randomisation, while almost as many patients are randomised to the superior treatment as in the DP design. Hence, this design strikes a very good balance in terms of the patient benefit and power trade-off, providing both power and ethical advantages, which acknowledges that clinical trials are multiple objective experiments.</p><p id="P81">The average bias and MSE of the treatment effect estimator following our proposed CRDP design are very low. It is well known that selection results in biased estimators (see e.g. <xref rid="R3" ref-type="bibr">Bauer et al., 2010</xref>). This is also true for group-sequential trials which are, however, routinely used in practice nowadays because the benefit from these designs can outweigh the bias incurred, particularly in the case of rare diseases. In order to make this assessment, it is important to determine the magnitude of the bias (as well as the benefits of the design) and hence the evaluations provided are essential for these novel methods to be applied in a real-life trial. In cases where the magnitude of the bias could be considered excessive, there exists a bias-corrected estimator that can be used (which comes at the price of a notably increased variability); see <xref rid="R7" ref-type="bibr">Bowden and Trippa (2015)</xref>.</p><p id="P82">In this paper, we consider a two-armed trial with binary endpoints for simplicity, yet the principles used easily extend to multi-arm trials. An area of further work is to generalise the proposed design so it can be applied to other endpoints. In addition, a natural extension of this work is to modify the heuristic WI policy in a similar way as we have with the optimal DP design since index policies are conceptually more intuitive (we allocate the patient to the treatment with the highest index), and hence easier to communicate and be understood by clinicians. Moreover, the WI is potentially very important for the extension to more than two treatment arms since the DP quickly becomes computationally intractable while the WI is still feasible (<xref rid="R16" ref-type="bibr">Villar et al., 2015a</xref>).</p><p id="P83">In our proposed design, each patient&#x02019;s response is used to inform the subsequent allocation decision. This relies on the assumption that patient responses become available before the next patient receives treatment (which would be the case if patient responses were quickly observed, for example). In many clinical trial settings, this is unrealistic because often a treatment takes a substantial length of time to induce a response and so it is very likely that the accrual rate will exceed the response rate. However, in a rare disease setting, the accrual rate is likely to be relatively slow with some patients being recruited over several years, and hence this assumption would be reasonable. Further research is required to address the problem of incorporating delayed responses into bandit-based designs which would increase the generalisability of our proposed design.</p><p id="P84">Moreover, our proposed design can only be applied to relatively small-scale trials since the underlying backwards induction algorithm suffers from the curse of dimensionality (<xref rid="R4" ref-type="bibr">Bellman, 1961</xref>) and currently attains its practical limit at <italic>n</italic> = 200. Again, this is not an issue for a rare disease setting in which the number of patients available for participation in the trial is limited, or clinical trials involving children, for example, in which recruitment is challenging (<xref rid="R11" ref-type="bibr">Hampson et al., 2014</xref>). In fact, many Phase II trials have no more than 200 patients, even in common diseases.</p><p id="P85">Additional extensions of this work include considering the effect of changing the prior distribution assigned to the unknown success probabilities. For example, a Beta prior with carefully chosen parameters could alternatively be used if the investigator wishes to reflect a greater amount of knowledge or a bias in favour of a particular treatment, without increasing the complexity of the problem. See <xref rid="R11" ref-type="bibr">Hampson et al. (2014)</xref> in which the unknown model parameters of the prior distribution are determined by eliciting expert opinion and incorporating historical data from a related trial.</p></sec><sec sec-type="supplementary-material" id="SM"><title>Supplementary Material</title><supplementary-material content-type="local-data" id="SD1"><label>Appendix</label><media xlink:href="NIHMS71936-supplement-Appendix.pdf" mimetype="application" mime-subtype="pdf" orientation="portrait" xlink:type="simple" id="d36e6026" position="anchor"/></supplementary-material></sec></body><back><ack id="S16"><title>Acknowledgements</title><p>We gratefully acknowledge the support of the EPSRC funded STOR-i Centre for Doctoral Training, Grant No. EP/H023151/1. Sof&#x000ed;a S. Villar is grateful to the Biometrika Trust for its research funding. This report is independent research arising in part from Professor Jaki&#x02019;s Senior Research Fellowship (NIHR-SRF-2015-08-001) supported by the National Institute for Health Research. The views expressed in this publication are those of the authors and not necessarily those of the NHS, the National Institute for Health Research or the Department of Health.</p></ack><ref-list><ref id="R1"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akech</surname><given-names>SO</given-names></name><name><surname>Karisa</surname><given-names>J</given-names></name><name><surname>Nakamya</surname><given-names>P</given-names></name><name><surname>Boga</surname><given-names>M</given-names></name><name><surname>Maitland</surname><given-names>K</given-names></name></person-group><article-title>Phase ii trial of isotonic fluid resuscitation in kenyan children with severe malnutrition and hypovolaemia</article-title><source>BMC Pediatr</source><year>2010</year><volume>10</volume><issue>1</issue><fpage>1</fpage><pub-id pub-id-type="pmid">20078871</pub-id></element-citation></ref><ref id="R2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bartlett</surname><given-names>R</given-names></name><name><surname>Roloff</surname><given-names>D</given-names></name><name><surname>Cornell</surname><given-names>R</given-names></name><name><surname>Andrews</surname><given-names>A</given-names></name><name><surname>Dillon</surname><given-names>P</given-names></name><name><surname>Zwischenberger</surname><given-names>J</given-names></name></person-group><article-title>Extacorporeal circulation in neonatal respiratory failure: A prospective randomized study</article-title><source>Pediatrics</source><year>1985</year><volume>76</volume><issue>4</issue><fpage>479</fpage><lpage>487</lpage><pub-id pub-id-type="pmid">3900904</pub-id></element-citation></ref><ref id="R3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bauer</surname><given-names>P</given-names></name><name><surname>Koenig</surname><given-names>F</given-names></name><name><surname>Brannath</surname><given-names>W</given-names></name><name><surname>Posch</surname><given-names>M</given-names></name></person-group><article-title>Selection and bias - two hostile brothers</article-title><source>Stat Med</source><year>2010</year><volume>29</volume><issue>1</issue><fpage>1</fpage><lpage>13</lpage><pub-id pub-id-type="pmid">19844944</pub-id></element-citation></ref><ref id="R4"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Bellman</surname><given-names>RE</given-names></name></person-group><source>Adaptive Control Processes: A Guided Tour</source><publisher-name>Princeton University Press</publisher-name><publisher-loc>Princeton</publisher-loc><year>1961</year><volume>4</volume></element-citation></ref><ref id="R5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berry</surname><given-names>DA</given-names></name><name><surname>Eick</surname><given-names>SG</given-names></name></person-group><article-title>Adaptive assignment versus balanced randomization in clinical trials: a decision analysis</article-title><source>Stat Med</source><year>1995</year><volume>14</volume><issue>3</issue><fpage>231</fpage><lpage>246</lpage><pub-id pub-id-type="pmid">7724909</pub-id></element-citation></ref><ref id="R6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Blackwell</surname><given-names>D</given-names></name><name><surname>Hodges</surname><given-names>JL</given-names></name></person-group><article-title>Design for the control of selection bias</article-title><source>Ann Math Statist</source><year>1957</year><volume>28</volume><issue>2</issue><fpage>449</fpage><lpage>460</lpage><pub-id pub-id-type="doi">10.1214/aoms/1177706973</pub-id><comment>URL</comment></element-citation></ref><ref id="R7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bowden</surname><given-names>J</given-names></name><name><surname>Trippa</surname><given-names>L</given-names></name></person-group><article-title>Unbiased estimation for response adaptive clinical trials</article-title><source>Stat Methods Med Res</source><year>2015</year></element-citation></ref><ref id="R8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cheng</surname><given-names>Y</given-names></name><name><surname>Berry</surname><given-names>DA</given-names></name></person-group><article-title>Optimal adaptive randomized designs for clinical trials</article-title><source>Biometrika</source><year>2007</year><volume>94</volume><issue>3</issue><fpage>673</fpage><lpage>689</lpage><comment>URL <ext-link ext-link-type="uri" xlink:href="http://biomet.oxfordjournals.org/content/94/3/673.abstract">http://biomet.oxfordjournals.org/content/94/3/673.abstract</ext-link></comment></element-citation></ref><ref id="R9"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Chow</surname><given-names>S-C</given-names></name><name><surname>Liu</surname><given-names>J-P</given-names></name></person-group><source>Design and Analysis of Clinical Trials: Concepts and Methodologies</source><edition>third ed</edition><year>2014</year><publisher-name>Wiley-Blackwell</publisher-name></element-citation></ref><ref id="R10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gittins</surname><given-names>J</given-names></name></person-group><article-title>Bandit processes and dynamic allocation indices</article-title><source>J R Stat Soc Ser B Stat Methodol</source><year>1979</year><volume>41</volume><issue>2</issue><fpage>148</fpage><lpage>177</lpage></element-citation></ref><ref id="R11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hampson</surname><given-names>LV</given-names></name><name><surname>Whitehead</surname><given-names>J</given-names></name><name><surname>Eleftheriou</surname><given-names>D</given-names></name><name><surname>Brogan</surname><given-names>P</given-names></name></person-group><article-title>Bayesian methods for the design and interpretation of clinical trials in very rare diseases</article-title><source>Stat Med</source><year>2014</year><volume>33</volume><issue>24</issue><fpage>4186</fpage><lpage>4201</lpage><pub-id pub-id-type="pmid">24957522</pub-id></element-citation></ref><ref id="R12"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>F</given-names></name><name><surname>Rosenberger</surname><given-names>WF</given-names></name></person-group><source>The Theory of Response-adaptive Randomization in Clinical Trials</source><year>2006</year><volume>525</volume><publisher-name>John Wiley &#x00026; Sons</publisher-name></element-citation></ref><ref id="R13"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kateri</surname><given-names>M</given-names></name></person-group><chapter-title>Contingency Table Analysis</chapter-title><source>Statistics for Industry and Technology</source><publisher-name>Birkh&#x000e4;user</publisher-name><publisher-loc>Basel</publisher-loc><year>2014</year><edition>first ed</edition><volume>525</volume></element-citation></ref><ref id="R14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenberger</surname><given-names>W</given-names></name></person-group><article-title>Randomized play-the-winner clinical trials: review and recommendations</article-title><source>Controlled Clin Trials</source><year>1999</year><volume>20</volume><issue>4</issue><fpage>328</fpage><lpage>342</lpage><pub-id pub-id-type="pmid">10440560</pub-id></element-citation></ref><ref id="R15"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Routledge</surname><given-names>R</given-names></name></person-group><chapter-title>Fisher&#x02019;s exact test</chapter-title><source>Encyclopedia of Biostatistics</source><year>2005</year></element-citation></ref><ref id="R16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Villar</surname><given-names>SS</given-names></name><name><surname>Bowden</surname><given-names>J</given-names></name><name><surname>Wason</surname><given-names>J</given-names></name></person-group><article-title>Multi-armed bandit models for the optimal design of clinical trials: Benefits and challenges</article-title><source>Statist Sci</source><year>2015a</year><volume>30</volume><issue>2</issue><fpage>199</fpage><lpage>215</lpage></element-citation></ref><ref id="R17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Villar</surname><given-names>SS</given-names></name><name><surname>Bowden</surname><given-names>J</given-names></name><name><surname>Wason</surname><given-names>J</given-names></name></person-group><article-title>Response-adaptive randomisation for multi-arm clinical trials using the forward looking gittins index rule</article-title><source>Biometrics</source><year>2015b</year><volume>71</volume><issue>4</issue><fpage>969</fpage><lpage>978</lpage><pub-id pub-id-type="pmid">26098023</pub-id></element-citation></ref><ref id="R18"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wei</surname><given-names>L</given-names></name><name><surname>Durham</surname><given-names>S</given-names></name></person-group><article-title>The randomized play-the-winner rule in medical trials</article-title><source>J Amer Statist Assoc</source><year>1978</year><volume>73</volume><issue>364</issue><fpage>840</fpage><lpage>843</lpage></element-citation></ref><ref id="R19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Whittle</surname><given-names>P</given-names></name></person-group><article-title>Restless bandits: Activity allocation in a changing world</article-title><source>J Appl Probab</source><year>1988</year><fpage>287</fpage><lpage>298</lpage></element-citation></ref></ref-list></back><floats-group><fig id="F1" orientation="portrait" position="float"><label>Fig. 1</label><caption><p>The changes in power and type I error for each design when <italic>n</italic> = 75, <italic>&#x003b8;<sub>A</sub></italic> = 0.5 and <italic>&#x003b8;<sub>B</sub></italic> &#x02208; (0.1, 0.9). The upper dashed line at 0.8 represents the desired power level, and the lower dashed line at 0.1 represents the nominal significance level.</p></caption><graphic xlink:href="emss-71936-f001"/></fig><fig id="F2" orientation="portrait" position="float"><label>Fig. 2</label><caption><p>The percentage of patients on the superior treatment arm for each design when <italic>n</italic> = 75, <italic>&#x003b8;<sub>A</sub></italic> = 0.5 and <italic>&#x003b8;<sub>B</sub></italic> &#x02208; (0.1, 0.9).</p></caption><graphic xlink:href="emss-71936-f002"/></fig><fig id="F3" orientation="portrait" position="float"><label>Fig. 3</label><caption><p>The average bias of the treatment effect estimator when <italic>n</italic> = 75, <italic>&#x003b8;<sub>A</sub></italic> = 0.5 and <italic>&#x003b8;<sub>B</sub></italic> &#x02208; (0.1, 0.9).</p></caption><graphic xlink:href="emss-71936-f003"/></fig><fig id="F4" orientation="portrait" position="float"><label>Fig. 4</label><caption><p>The mean squared error of the treatment effect estimator when <italic>n</italic> = 75, <italic>&#x003b8;<sub>A</sub></italic> = 0.5 and <italic>&#x003b8;<sub>B</sub></italic> &#x02208; (0.1, 0.9).</p></caption><graphic xlink:href="emss-71936-f004"/></fig><fig id="F5" orientation="portrait" position="float"><label>Fig. 5</label><caption><p>Star plot showing the performance of each design with respect to power, patient benefit, absolute average bias of the treatment effect estimator and MSE when <italic>n</italic> = 75, <italic>&#x003b8;<sub>A</sub></italic> = 0.5 and <italic>&#x003b8;<sub>B</sub></italic> = 0.2. The best achieved values for each performance measure are depicted at the outer edge. (Note that the average bias and MSE axes have been inverted so that the smaller (favourable) values are towards the outer edge, unlike the power and patient benefit axes which have their larger values towards the outer edge.)</p></caption><graphic xlink:href="emss-71936-f005"/></fig><fig id="F6" orientation="portrait" position="float"><label>Fig. 6</label><caption><p>Probability of allocating a patient to treatment <italic>B</italic> for CRDP when <italic>&#x003b8;<sub>A</sub></italic> = 0.5 and <italic>&#x003b8;<sub>B</sub></italic> = 0.7 in a trial of size <italic>n</italic> = 75.</p></caption><graphic xlink:href="emss-71936-f006"/></fig><fig id="F7" orientation="portrait" position="float"><label>Fig. 7</label><caption><p>Patient allocations for CRDP when <italic>&#x003b8;<sub>A</sub></italic> = 0.5 and <italic>&#x003b8;<sub>B</sub></italic> = 0.7 in a trial of size <italic>n</italic> = 75 for five different trial realisations. Upper dots represent allocations to treatment <italic>B</italic> while lower dots represent allocations to treatment <italic>A</italic>.</p></caption><graphic xlink:href="emss-71936-f007"/></fig><table-wrap id="T1" position="float" orientation="portrait"><label>Table 1</label><caption><p>The estimates of success probabilities, <mml:math display="inline" id="M200" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub></mml:mrow></mml:math> and <mml:math display="inline" id="M201" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:math>, and corresponding standard errors (s.e.) for the success
probabilities of treatments <italic>A</italic> and <italic>B</italic>,
respectively, compared to their true values
<italic>&#x003b8;<sub>A</sub></italic> and
<italic>&#x003b8;<sub>B</sub></italic>. These results correspond to the
scenario in which <italic>n</italic> = 75, <italic>&#x003b8;<sub>A</sub></italic>
= 0.5 and <italic>&#x003b8;<sub>B</sub></italic> &#x02208; (0.1, 0.9).</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" colspan="2" rowspan="1">True<hr/></th><th align="left" colspan="2" rowspan="1">Fixed<hr/></th><th align="left" colspan="2" rowspan="1">DP<hr/></th><th align="left" colspan="2" rowspan="1">CRDP<hr/></th></tr><tr><th align="left" rowspan="1" colspan="1"><italic>&#x003b8;<sub>A</sub></italic></th><th align="left" rowspan="1" colspan="1"><italic>&#x003b8;<sub>B</sub></italic></th><th align="left" rowspan="1" colspan="1"><mml:math display="inline" id="M202" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub></mml:mrow></mml:math> (s.e.)</th><th align="left" rowspan="1" colspan="1"><mml:math display="inline" id="M203" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:math> (s.e.)</th><th align="left" rowspan="1" colspan="1"><mml:math display="inline" id="M204" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub></mml:mrow></mml:math> (s.e.)</th><th align="left" rowspan="1" colspan="1"><mml:math display="inline" id="M205" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:math> (s.e.)</th><th align="left" rowspan="1" colspan="1"><mml:math display="inline" id="M206" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>A</mml:mi></mml:msub></mml:mrow></mml:math> (s.e.)</th><th align="left" rowspan="1" colspan="1"><mml:math display="inline" id="M207" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b8;</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>B</mml:mi></mml:msub></mml:mrow></mml:math> (s.e.)</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">0.500</td><td align="left" rowspan="1" colspan="1">0.100</td><td align="left" rowspan="1" colspan="1">0.500 (0.083)</td><td align="left" rowspan="1" colspan="1">0.100 (0.050)</td><td align="left" rowspan="1" colspan="1">0.498 (0.062)</td><td align="left" rowspan="1" colspan="1">0.057 (0.096)</td><td align="left" rowspan="1" colspan="1">0.499 (0.064)</td><td align="left" rowspan="1" colspan="1">0.097 (0.085)</td></tr><tr><td align="left" rowspan="1" colspan="1">0.500</td><td align="left" rowspan="1" colspan="1">0.200</td><td align="left" rowspan="1" colspan="1">0.500 (0.083)</td><td align="left" rowspan="1" colspan="1">0.201 (0.065)</td><td align="left" rowspan="1" colspan="1">0.493 (0.080)</td><td align="left" rowspan="1" colspan="1">0.119 (0.132)</td><td align="left" rowspan="1" colspan="1">0.496 (0.070)</td><td align="left" rowspan="1" colspan="1">0.187 (0.105)</td></tr><tr><td align="left" rowspan="1" colspan="1">0.500</td><td align="left" rowspan="1" colspan="1">0.300</td><td align="left" rowspan="1" colspan="1">0.500 (0.083)</td><td align="left" rowspan="1" colspan="1">0.301 (0.075)</td><td align="left" rowspan="1" colspan="1">0.474 (0.118)</td><td align="left" rowspan="1" colspan="1">0.191 (0.156)</td><td align="left" rowspan="1" colspan="1">0.489 (0.084)</td><td align="left" rowspan="1" colspan="1">0.275 (0.109)</td></tr><tr><td align="left" rowspan="1" colspan="1">0.500</td><td align="left" rowspan="1" colspan="1">0.400</td><td align="left" rowspan="1" colspan="1">0.500 (0.083)</td><td align="left" rowspan="1" colspan="1">0.401 (0.080)</td><td align="left" rowspan="1" colspan="1">0.434 (0.162)</td><td align="left" rowspan="1" colspan="1">0.279 (0.176)</td><td align="left" rowspan="1" colspan="1">0.475 (0.098)</td><td align="left" rowspan="1" colspan="1">0.364 (0.107)</td></tr><tr><td align="left" rowspan="1" colspan="1">0.500</td><td align="left" rowspan="1" colspan="1">0.500</td><td align="left" rowspan="1" colspan="1">0.500 (0.083)</td><td align="left" rowspan="1" colspan="1">0.500 (0.082)</td><td align="left" rowspan="1" colspan="1">0.386 (0.192)</td><td align="left" rowspan="1" colspan="1">0.389 (0.192)</td><td align="left" rowspan="1" colspan="1">0.462 (0.105)</td><td align="left" rowspan="1" colspan="1">0.464 (0.106)</td></tr><tr><td align="left" rowspan="1" colspan="1">0.500</td><td align="left" rowspan="1" colspan="1">0.600</td><td align="left" rowspan="1" colspan="1">0.500 (0.083)</td><td align="left" rowspan="1" colspan="1">0.600 (0.080)</td><td align="left" rowspan="1" colspan="1">0.340 (0.216)</td><td align="left" rowspan="1" colspan="1">0.518 (0.193)</td><td align="left" rowspan="1" colspan="1">0.461 (0.111)</td><td align="left" rowspan="1" colspan="1">0.575 (0.099)</td></tr><tr><td align="left" rowspan="1" colspan="1">0.500</td><td align="left" rowspan="1" colspan="1">0.700</td><td align="left" rowspan="1" colspan="1">0.500 (0.083)</td><td align="left" rowspan="1" colspan="1">0.699 (0.075)</td><td align="left" rowspan="1" colspan="1">0.303 (0.240)</td><td align="left" rowspan="1" colspan="1">0.652 (0.172)</td><td align="left" rowspan="1" colspan="1">0.472 (0.123)</td><td align="left" rowspan="1" colspan="1">0.689 (0.080)</td></tr><tr><td align="left" rowspan="1" colspan="1">0.500</td><td align="left" rowspan="1" colspan="1">0.800</td><td align="left" rowspan="1" colspan="1">0.500 (0.083)</td><td align="left" rowspan="1" colspan="1">0.800 (0.065)</td><td align="left" rowspan="1" colspan="1">0.290 (0.266)</td><td align="left" rowspan="1" colspan="1">0.780 (0.129)</td><td align="left" rowspan="1" colspan="1">0.484 (0.136)</td><td align="left" rowspan="1" colspan="1">0.797 (0.058)</td></tr><tr><td align="left" rowspan="1" colspan="1">0.500</td><td align="left" rowspan="1" colspan="1">0.900</td><td align="left" rowspan="1" colspan="1">0.500 (0.083)</td><td align="left" rowspan="1" colspan="1">0.900 (0.049)</td><td align="left" rowspan="1" colspan="1">0.291 (0.290)</td><td align="left" rowspan="1" colspan="1">0.895 (0.074)</td><td align="left" rowspan="1" colspan="1">0.493 (0.147)</td><td align="left" rowspan="1" colspan="1">0.900 (0.039)</td></tr></tbody></table></table-wrap></floats-group></article>