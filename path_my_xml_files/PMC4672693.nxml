<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">Stat Med</journal-id><journal-id journal-id-type="iso-abbrev">Stat Med</journal-id><journal-id journal-id-type="publisher-id">sim</journal-id><journal-title-group><journal-title>Statistics in Medicine</journal-title></journal-title-group><issn pub-type="ppub">0277-6715</issn><issn pub-type="epub">1097-0258</issn><publisher><publisher-name>John Wiley &#x00026; Sons, Ltd</publisher-name><publisher-loc>Chichester, UK</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">25778798</article-id><article-id pub-id-type="pmc">4672693</article-id><article-id pub-id-type="doi">10.1002/sim.6468</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Articles</subject></subj-group></article-categories><title-group><article-title>A causal model for longitudinal randomised trials with time-dependent non-compliance</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Becque</surname><given-names>Taeko</given-names></name><xref ref-type="aff" rid="au1">a</xref><xref ref-type="corresp" rid="cor1">*</xref><xref ref-type="corresp" rid="cor2">&#x02020;</xref></contrib><contrib contrib-type="author"><name><surname>White</surname><given-names>Ian R</given-names></name><xref ref-type="aff" rid="au2">b</xref></contrib><contrib contrib-type="author"><name><surname>Haggard</surname><given-names>Mark</given-names></name><xref ref-type="aff" rid="au3">c</xref></contrib><aff id="au1"><label>a</label><institution>York Trials Unit, Department of Health Sciences, University of York</institution><addr-line>York, YO10 5DD, U.K.</addr-line></aff><aff id="au2"><label>b</label><institution>MRC Biostatistics Unit, Cambridge Institute of Public Health, School of Clinical Medicine, University Forvie Site, Robinson Way</institution><addr-line>Cambridge, CB2 0SR, U.K.</addr-line></aff><aff id="au3"><label>c</label><institution>MRC Multicentre Otitis Media Study Group, Department of Psychology, University of Cambridge</institution><addr-line>Downing Street, Cambridge, CB2 3EB, U.K.</addr-line></aff></contrib-group><author-notes><corresp id="cor1">
* Correspondence to: Taeko Becque, York Trials Unit, Department of Health Sciences, University of York, York, YO10 5DD, U.K.,</corresp><corresp id="cor2">
&#x02020; E-mail: <email>taeko.becque@york.ac.uk</email></corresp></author-notes><pub-date pub-type="ppub"><day>30</day><month>5</month><year>2015</year></pub-date><pub-date pub-type="epub"><day>16</day><month>3</month><year>2015</year></pub-date><volume>34</volume><issue>12</issue><fpage>2019</fpage><lpage>2034</lpage><history><date date-type="received"><day>26</day><month>6</month><year>2013</year></date><date date-type="rev-recd"><day>10</day><month>2</month><year>2015</year></date><date date-type="accepted"><day>13</day><month>2</month><year>2015</year></date></history><permissions><copyright-statement>&#x000a9; 2015 The Authors. Statistics in Medicine Published by JohnWiley &#x00026; Sons Ltd.</copyright-statement><copyright-year>2015</copyright-year><license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/3.0/"><license-p>This is an open access article under the terms of the Creative Commons Attribution License, which permits use, distribution and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><abstract><p>In the presence of non-compliance, conventional analysis by intention-to-treat provides an unbiased comparison of treatment policies but typically under-estimates treatment efficacy. With all-or-nothing compliance, efficacy may be specified as the complier-average causal effect (CACE), where compliers are those who receive intervention if and only if randomised to it. We extend the CACE approach to model longitudinal data with time-dependent non-compliance, focusing on the situation in which those randomised to control may receive treatment and allowing treatment effects to vary arbitrarily over time. Defining compliance type to be the time of surgical intervention if randomised to control, so that compliers are patients who would not have received treatment at all if they had been randomised to control, we construct a causal model for the multivariate outcome conditional on compliance type and randomised arm. This model is applied to the trial of alternative regimens for glue ear treatment evaluating surgical interventions in childhood ear disease, where outcomes are measured over five time points, and receipt of surgical intervention in the control arm may occur at any time. We fit the models using Markov chain Monte Carlo methods to obtain estimates of the CACE at successive times after receiving the intervention. In this trial, over a half of those randomised to control eventually receive intervention. We find that surgery is more beneficial than control at 6months, with a small but non-significant beneficial effect at 12months. &#x000a9; 2015 The Authors. Statistics in Medicine Published by JohnWiley &#x00026; Sons Ltd.</p></abstract><kwd-group><kwd>non-compliance</kwd><kwd>intention to treat</kwd><kwd>complier average causal effect</kwd><kwd>longitudinal model</kwd></kwd-group></article-meta></front><body><sec><title>1 Introduction</title><p>Non-compliance or departure from randomised intervention is a common occurrence in randomised controlled trials and can take various forms. For example, some patients randomised to treatment may take too much treatment, too little or none at all. Some participants may switch to another trial intervention or to an intervention outside the trial. In some cases, departures occur after consultation with a physician; in others, they may simply be because of non-adherence. Compliance can both influence and be influenced by the outcome, side effects and other prognostic factors. Intention-to-treat analysis <xref rid="b1" ref-type="bibr">1</xref>,<xref rid="b2" ref-type="bibr">2</xref> has become the standard analysis in the presence of non-compliance as it avoids selection bias and provides an estimate of the effectiveness of a particular programme of treatment. Per-protocol analysis, in which those who adhere to their randomised allocation are compared between randomised arms, is commonly used in addition to intention-to-treat (ITT) analysis. Occasionally, as-treated analysis, where patients are compared according to the intervention received, is also used. Both analyses attempt to measure efficacy but require strong assumptions about the comparability of compliers and non-compliers within randomised arms <xref rid="b3" ref-type="bibr">3</xref> and are known to be subject to selection bias <xref rid="b4" ref-type="bibr">4</xref>&#x02013;<xref rid="b6" ref-type="bibr">6</xref>.</p><p>Instead, we may use a randomisation-based estimate of efficacy, that is, an estimate of a causal effect based on a comparison of randomised arms <xref rid="b3" ref-type="bibr">3</xref>,<xref rid="b7" ref-type="bibr">7</xref>. The complier average causal effect (CACE) <xref rid="b8" ref-type="bibr">8</xref>,<xref rid="b9" ref-type="bibr">9</xref> is one such measure of causal effect. The main idea here is to divide the population of interest into several categories or <italic>compliance types</italic>, which specify treatment received under different randomised allocations. Compliance generally refers to treatment received, that is, whether or not the patient received their randomised intervention. Compliance type, on the other hand, is a classification of treatment-received given randomisation and is therefore independent of randomisation. Assuming two randomised arms, treatment and control and assuming compliance is all-or-nothing, that is, individuals either receive all of the treatment or none at all, the possible compliance types are as follows: 
<list list-type="order"><list-item><p><italic>Never-takers</italic>: those who never receive treatment regardless of their randomised arm.
</p></list-item><list-item><p><italic>Always-takers</italic>: those who always receive treatment regardless of their randomised arm.
</p></list-item><list-item><p><italic>Compliers</italic>: those who receive treatment if and only if randomised to treatment, that is, comply with their assignment.
</p></list-item><list-item><p><italic>Defiers</italic>: those who receive treatment if and only if randomised to control, that is, do the opposite of their assignment.
</p></list-item></list></p><p>Groups of always-takers and defiers are only possible if the treatment is available to those randomised to control. The CACE measures the causal effect of assignment on outcome among the group of compliers. In the principal stratification framework, the compliance types are referred to as <italic>principal strata</italic>, and the CACE is a <italic>principal effect</italic>
<xref rid="b10" ref-type="bibr">10</xref>. Compliance types are not fully observable because the behaviour under all possible randomisations cannot be observed for all individuals, but due to randomisation, the expected proportion of patients in each compliance type is the same across randomised arms. Two assumptions, known as exclusion restrictions, are usually made to enable estimation: (1) never-takers have the same mean outcome across randomised arms, and (2) always-takers have the same mean outcome across randomised arms. In addition, it is often assumed that there are no defiers <xref rid="b11" ref-type="bibr">11</xref>.</p><p>In this paper, we measure this causal effect as a mean difference, so that the CACE is the difference in mean outcome between compliers randomised to treatment and compliers randomised to control. This CACE may be estimated using instrumental variables (IVs) analysis <xref rid="b12" ref-type="bibr">12</xref>,<xref rid="b13" ref-type="bibr">13</xref>. In the context of randomised controlled trials, randomisation is an IV if it affects outcome only through the treatment received. In the simplest setting, the IV estimate of the CACE is the ratio of the ITT effect of randomisation on outcome and the ITT effect of randomisation on treatment received. Under the exclusion restriction and no defiers assumptions, this ratio represents a causal effect of treatment received on outcome <xref rid="b8" ref-type="bibr">8</xref>.</p><p>Alternatively, a full probability modelling approach involves specification of a model for the potential outcomes given randomisation and compliance type and allows estimation of the CACE using either maximum likelihood or Bayesian methods <xref rid="b14" ref-type="bibr">14</xref>,<xref rid="b15" ref-type="bibr">15</xref>. Maximum likelihood estimation can be performed using the expectation-maximisation algorithm <xref rid="b16" ref-type="bibr">16</xref>, which treats compliance type as unobserved data. The idea is to find the expected compliance type for each individual and to maximise the likelihood to obtain the maximum likelihood estimate of the CACE. The new parameter estimates are then used to calculate the expectation of the missing compliance types. The Bayesian model can be fitted with data augmentation <xref rid="b17" ref-type="bibr">17</xref>, using Markov chain Monte Carlo methods <xref rid="b18" ref-type="bibr">18</xref>.</p><p>The same approach may be taken in cases where the data are longitudinal, allowing a time-dependent treatment effect, provided that compliance remains all-or-nothing <xref rid="b19" ref-type="bibr">19</xref>. In trials where the alternative intervention is always available, however, there will be many different compliance patterns, depending on the time at which individuals depart from their allocation. With two or more interventions available at each time, the number of compliance types can quickly become large. An alternative to using all possible compliance types is to use superclasses or latent compliance class principal strata, to summarise longitudinal compliance patterns: ITT contrasts are then made within these superclasses, but these contrasts do not represent causal effects <xref rid="b20" ref-type="bibr">20</xref>. Sitlani <italic>et al.</italic>
<xref rid="b21" ref-type="bibr">21</xref> use a longitudinal structural mixed model (LSMM), an example of a structural-nested model <xref rid="b22" ref-type="bibr">22</xref>, to analyse a surgical trial with non-compliance that is varying over time. They consider a joint model of outcome and treatment, allowing for inclusion of covariates. The average causal effect of treatment is assumed to be a linear function of time. They compare the performance of likelihood-based methods and various semi-parametric methods and state the assumptions required for valid estimation in each case.</p><p>In this paper, we propose a causal model for longitudinal data, where intervention group individuals all receive a one-off intervention at the start of the trial, while control group individuals may receive the intervention at any time during the trial. Unlike Sitlani <italic>et al.</italic>
<xref rid="b21" ref-type="bibr">21</xref>, we consider the CACE interpretation, generalising the model of <xref rid="b15" ref-type="bibr">15</xref> by creating a compliance type for each longitudinal pattern of compliance, and we make no assumption about how the treatment effect varies over time: in particular, our model accommodates a transient treatment effect. By jointly modelling outcome and compliance over time, we obtain estimates of the CACE at each time point. We apply this model to data from the trial of alternative regimens for glue ear treatment (TARGET), which compared the effect of a surgical intervention and a control programme on hearing loss in children with otitis media with effusion (&#x02018;glue ear&#x02019;). The surgical intervention was available at all times over the two-year trial, and a large proportion of those randomised to control eventually chose to receive surgery.</p><p>In Section&#x02009;2, we give details of the motivating example along with an ITT analysis. In Section&#x02009;3, we review existing methods to account for non-compliance, including the standard CACE model. In Section&#x02009;4, we introduce the CACE model for longitudinal data with time-dependent compliance and various model extensions. In Section&#x02009;5, we apply these models to the TARGET trial and end with a discussion in Section&#x02009;6.</p></sec><sec><title>2 Motivating example</title><sec><title>2.1 Description of the trial</title><p>The TARGET <xref rid="b23" ref-type="bibr">23</xref> was a UK multi-centre randomised controlled trial that investigated the effect of surgery for children with glue ear. This is a condition in which the middle ear becomes filled with fluid, leading to hearing loss. The trial compared the insertion of ventilation tubes, with and without adenoidectomy, with non-surgical management. The inclusion criteria specified that the children must be aged 3&#x02013;7years, with no previous ear or adenoid surgery and with greater than 20dB hearing loss in the better ear.</p><p>Our analysis includes data from 248 participants: 126 randomised to insertion of ventilation tubes (VT) and 122 randomised to control. The third randomised arm (VT plus adenoidectomy) is ignored for present purposes. VT involved aspiration of fluid remaining in the middle ear, followed by insertion of ventilation tubes in the ear drums. The control arm provided rapid access to antibiotics in the case of resurgent acute infection, although these were rarely used in practice. Improvements in hearing were quantified by hearing level in decibels (dB), with lower measurements indicating better hearing. For this condition, a threshold high value of 40dB represents poor hearing, and less than 15dB is regarded as normal. Other outcomes were also measured, but hearing loss was the main outcome for the power calculation due to its widespread use and the existence of a precise convention on its measurement.</p></sec><sec><title>2.2 Description of the data</title><p>Measurements of hearing loss were taken at two pre-randomisation visits, then at 3, 6, 12, 18 and 24months, referred to as post-randomisation visits 1, 2, 3, 4, and 5, respectively <xref ref-type="fn" rid="fn1">&#x02021;</xref>. The hearing loss at baseline has mean 33dB and ranges from about 21dB to 46dB. The amount of missing outcome data ranges between about 13% and 18% at each visit, and attrition rates are similar across randomised arms. A descriptive summary of the trial is provided in Table&#x02009;<xref ref-type="table" rid="tbl1">1</xref>. A graph of the observed mean hearing loss against time by randomised arm, along with 95% confidence intervals, is given in Figure&#x02009;<xref ref-type="fig" rid="fig01">1</xref>, following <xref rid="b23" ref-type="bibr">23</xref>. It shows that although VT gives a larger reduction in hearing loss than control by visits 1 and 2, it is comparable to control after visit 3.</p><table-wrap id="tbl1" position="float"><label>Table 1</label><caption><p>Description of trial of alternative regimens for glue ear treatment (TARGET).</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2" colspan="1">Visit</th><th align="left" rowspan="2" colspan="1">Months</th><th align="left" colspan="2" rowspan="1">Randomised to VT (<italic>n</italic>=126)</th><th align="left" colspan="3" rowspan="1">Randomised to control (<italic>n</italic>=122)</th></tr><tr><th align="left" rowspan="1" colspan="1"><italic>n</italic></th><th align="left" rowspan="1" colspan="1">Mean hearing loss (dB)</th><th align="left" rowspan="1" colspan="1"><italic>n</italic></th><th align="left" rowspan="1" colspan="1">Mean hearing loss (dB)</th><th align="left" rowspan="1" colspan="1">Received VT since previous visit</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">0</td><td align="left" rowspan="1" colspan="1">126</td><td align="left" rowspan="1" colspan="1">32.2</td><td align="left" rowspan="1" colspan="1">122</td><td align="left" rowspan="1" colspan="1">33.5</td><td align="left" rowspan="1" colspan="1">0</td></tr><tr><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">109</td><td align="left" rowspan="1" colspan="1">14.4</td><td align="left" rowspan="1" colspan="1">106</td><td align="left" rowspan="1" colspan="1">26.3</td><td align="left" rowspan="1" colspan="1">13</td></tr><tr><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">6</td><td align="left" rowspan="1" colspan="1">106</td><td align="left" rowspan="1" colspan="1">17.5</td><td align="left" rowspan="1" colspan="1">105</td><td align="left" rowspan="1" colspan="1">23.2</td><td align="left" rowspan="1" colspan="1">20</td></tr><tr><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">12</td><td align="left" rowspan="1" colspan="1">110</td><td align="left" rowspan="1" colspan="1">21.0</td><td align="left" rowspan="1" colspan="1">100</td><td align="left" rowspan="1" colspan="1">20.5</td><td align="left" rowspan="1" colspan="1">17</td></tr><tr><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">18</td><td align="left" rowspan="1" colspan="1">103</td><td align="left" rowspan="1" colspan="1">21.1</td><td align="left" rowspan="1" colspan="1">98</td><td align="left" rowspan="1" colspan="1">19.7</td><td align="left" rowspan="1" colspan="1">13</td></tr><tr><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">24</td><td align="left" rowspan="1" colspan="1">108</td><td align="left" rowspan="1" colspan="1">18.7</td><td align="left" rowspan="1" colspan="1">102</td><td align="left" rowspan="1" colspan="1">18.2</td><td align="left" rowspan="1" colspan="1">3</td></tr></tbody></table><table-wrap-foot><fn id="tf1-1"><p>VT, ventilation tubes.</p></fn></table-wrap-foot></table-wrap><fig id="fig01" position="float"><label>Figure 1</label><caption><p>Graph of mean outcome (with 95% confidence intervals) by randomised arm.</p></caption><graphic xlink:href="sim0034-2019-f1"/></fig><p>The published ITT analysis found statistically significant beneficial effects of VT over 3 to 6months but a statistically non-significant negative effect of VT over 12 to 24months. This negative effect &#x02018;occurs because in this period more of the control group have transferred to treatment, and so have functioning VT, than is seen in the surgery groups where VT have mostly fallen out <xref rid="b23" ref-type="bibr">23</xref>&#x02019;. The present paper aims to correct for such departures, which we now describe in a more detail.</p><p>Any child in the VT arm who did not receive their allocated VT and any child in the control arm who received VT were considered to have departed from their randomised intervention. A total of 71 children departed from their allocated intervention, mostly from the control arm to receive surgical intervention (66 children, 54%). Departures from randomised treatment occurred over the duration of the trial, mostly at scheduled visits. The numbers of departures in the control arm between consecutive visits are given in Table&#x02009;<xref ref-type="table" rid="tbl1">1</xref>. Only five of those randomised to VT (4%) received control instead of surgical intervention.</p><p>There were two main reasons for departures in the control arm: early surgical intervention (before visit 1) was mostly due to discontentment with the allocated treatment, whereas later surgical intervention was largely due to deterioration of the child&#x02019;s condition. To see this, we plot the hearing loss for those randomised to control (Figure&#x02009;<xref ref-type="fig" rid="fig02">2</xref>). At each visit, we compare boxplots of the hearing loss for those who depart from the control arm before the next visit and those who do not depart before the next visit. Those who depart from the control arm tend to have a higher average hearing loss immediately prior to receiving VT than those who have not yet departed from the control arm. In other words, those with worse hearing in the control arm are more likely to depart and receive intervention.</p><fig id="fig02" position="float"><label>Figure 2</label><caption><p>Departures from the control arm. Boxplots of hearing loss for those who depart from control and those who do not depart from control before the next visit.</p></caption><graphic xlink:href="sim0034-2019-f2"/></fig></sec><sec><title>2.3 Intention-to-treat analysis of trial of alternative regimens for glue ear treatment data</title><p>Let <italic>Y</italic><sub><italic>i</italic><italic>j</italic><italic>k</italic></sub> represent the average hearing loss for individual <italic>i</italic> = 1,...,248, visit <italic>j</italic> = 1,2,3,4,5 and allocated treatment <italic>k</italic> = 1,2 (control, VT). An ITT model may be written
<disp-formula id="m1"><graphic xlink:href="sim0034-2019-m1.jpg" mimetype="image" position="float"/><label>2.1</label></disp-formula>
where <italic>&#x003b3;</italic><sub><italic>j</italic></sub> is the mean control arm outcome at visit <italic>j</italic>, <italic>&#x003b4;</italic><sub><italic>j</italic></sub> is the treatment effect at visit <italic>j</italic>, <italic>x</italic><sub><italic>k</italic></sub> is an indicator for treatment being VT (i.e.&#x02009;for <italic>k</italic> = 2) and <bold><italic>&#x003f5;</italic></bold><sub><italic>i</italic><italic>k</italic></sub> is a vector over <italic>j</italic>. The ITT estimates are given in Table&#x02009;<xref ref-type="table" rid="tbl2">2</xref>.</p><table-wrap id="tbl2" position="float"><label>Table 2</label><caption><p>Estimates of treatment effect using visits since receiving VT.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="1" colspan="1">Visits since VT</th><th align="left" rowspan="1" colspan="1">ITT (95% CI)</th><th align="left" rowspan="1" colspan="1">CACE (95% CI)</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">&#x02212;11.6(&#x02212;13.8,&#x02212;9.3)</td><td align="left" rowspan="1" colspan="1">&#x02212;11.6(&#x02212;14.0,&#x02212;9.2)</td></tr><tr><td align="left" rowspan="1" colspan="1">2</td><td align="left" rowspan="1" colspan="1">&#x02212;5.6(&#x02212;8.1,&#x02212;3.1)</td><td align="left" rowspan="1" colspan="1">&#x02212;7.2(&#x02212;10.1,&#x02212;4.4)</td></tr><tr><td align="left" rowspan="1" colspan="1">3</td><td align="left" rowspan="1" colspan="1">0.8(&#x02212;1.9,3.5)</td><td align="left" rowspan="1" colspan="1">&#x02212;1.4(&#x02212;4.2,1.4)</td></tr><tr><td align="left" rowspan="1" colspan="1">4</td><td align="left" rowspan="1" colspan="1">1.6(&#x02212;1.3,4.5)</td><td align="left" rowspan="1" colspan="1">&#x02212;0.1(&#x02212;3.5,3.3)</td></tr><tr><td align="left" rowspan="1" colspan="1">5</td><td align="left" rowspan="1" colspan="1">0.5(&#x02212;1.9,2.8)</td><td align="left" rowspan="1" colspan="1">&#x02212;0.8(&#x02212;3.9,2.4)</td></tr></tbody></table><table-wrap-foot><fn id="tf2-1"><p>ITT (intention-to-treat) is the average effect of randomisation on observed outcome at visit <italic>j</italic> (<italic>&#x003b4;</italic><sub><italic>j</italic></sub> in model 2.1).</p></fn><fn id="n4"><p>CACE (complier average causal effect) is the average effect of randomisation on outcome at visit <italic>j</italic> in the principal strata of compliers at visit <italic>j</italic> (<italic>&#x003b2;</italic>(<italic>j</italic>) in model <xref ref-type="disp-formula" rid="m8">8</xref>.</p></fn></table-wrap-foot></table-wrap><p>The ITT analysis provides a useful primary analysis of the data and gives estimates of the relative effectiveness of the treatment programmes. However, we may wish to know the efficacy (i.e. causal effect) of the intervention at each time point. Estimation of the causal effect is complicated by the fact that compliance is time-dependent, and the treatment effect itself is also time-varying. In the next section, we look at existing methods to account for non-compliance in randomised trials.</p></sec></sec><sec><title>3 Accounting for non-compliance</title><sec><title>3.1 Existing methods</title><p>Sitlani <italic>et al.</italic>
<xref rid="b21" ref-type="bibr">21</xref> present an example comparing a surgical intervention with a non-operative treatment, with outcomes measured at five time points after enrollment. They propose a LSMM to account for non-compliance (treatment crossovers) between surgical and non-operative treatment. The LSMM consists of a group average (separated into baseline and time-dependent exposure), subject average (random effects to take into account correlation between measurements on the same individual) and individual observations (error terms assumed to be independent of the random effects). In their model, treatment effect is a linear function of time since receiving surgery, so the model cannot allow for the transient treatment effect that we see in the TARGET trial. The average causal effect at any given time is the difference at that time between the trajectory corresponding to treatment just after enrollment and the trajectory corresponding to no treatment.</p><p>Analysis is easiest if treatment depends on baseline characteristics (including randomisation) but not on post-baseline characteristics (an &#x02018;exogenous&#x02019; treatment process or &#x02018;no selection&#x02019;). In practice, treatment often depends on post-baseline characteristics (an &#x02018;endogenous&#x02019; treatment process or &#x02018;selection&#x02019;). Sitlani <italic>et al.</italic>
<xref rid="b21" ref-type="bibr">21</xref> distinguish two types of selection for receiving treatment: direct and indirect. Direct selection depends on covariates observed after baseline but before the time of interest, for example a previous poor outcome leading to a decision to receive surgery. Indirect selection depends on unobserved confounders that affect both treatment and outcome: for example patients with a worse general health condition may elect to receive surgery.</p><p>Sitlani <italic>et al.</italic> go on to look at various methods of estimation for the different cases. In the absence of selection, standard tools such as linear mixed effect (LME) model and generalised estimating equations (GEE) may be used. If selection is only direct, the LME and GEE estimators provide consistent estimates of treatment effect provided that the random effect structure is correctly specified. However, if there is indirect selection, LME and GEE estimators that do not explicitly use a selection model can be biased.</p><p>Marginal structural models (MSM) enable flexible incorporation of factors that influence treatment timing under marginal modelling assumptions. They require specification of a selection model that includes observed covariates or past treatment that is predictive of treatment. Inverse probability weighting can then be used to obtain consistent estimates of the causal parameters of interest. In order for MSM to be consistent, there must be no unmeasured confounders (no indirect selection), and the form of the selection models must be correctly specified.</p><p>G-estimation and IV estimation both aim to be valid under indirect selection by exploiting the randomisation. G-estimation uses the idea that treatment-free potential outcomes for participants randomised to treatment should be on average equal to treatment-free potential outcomes for those randomised to control. This relies on three assumptions: the counterfactual outcomes are independent of randomisation, the structural model is correctly specified and the effect of treatment at a specified time is the same for those who receive it and those who do not (&#x02018;no current-treatment interaction&#x02019;). IV estimators are two stage least squares estimates in which the first equation is a causal model relating outcome and exposure, and the second equation uses an IV, in this case randomisation, to predict exposure. They may be regarded as a special, non-optimal, case of G-estimation. The IV must satisfy the following assumptions in every time period in which a causal effect is to be estimated: (1) random treatment assignment, (2) randomisation affects outcome only via treatment received (exclusion restriction), (3) non-zero average causal effect of randomisation on treatment and (4) those randomised to control and then treated would also have been treated if randomised to treatment (monotonicity, required for the estimates to be interpretable as average treatment effects).</p><p>Using simulations, Sitlani <italic>et al.</italic> show that when indirect selection exists, LME, GEE, MSM and G-estimation can be biased, while IV methods tend to avoid bias but are inefficient <xref rid="b21" ref-type="bibr">21</xref>. The bias of their G-estimation appears to arise because the simulation design involved current treatment interaction. They therefore recommend using the joint likelihood of treatment and outcomes in order to obtain efficient and consistent estimates (provided dependence of selection on subject specific latent effects is correctly specified). Estimation may be achieved using Bayesian analysis that explicitly incorporates the selection model. In this paper, we use the joint-likelihood approach via a CACE model to account for indirect selection to treatment. Section&#x02009;3.2 describes the CACE model that has previously been used for cross-sectional data and longitudinal data where the compliance is binary, and Section&#x02009;4.1 describes our extension for time-dependent compliance.</p></sec><sec><title>3.2 Complier average causal effect model for all-or-nothing compliance</title><p>We first state the standard CACE model in the simple case of a two arm trial with all-or-nothing compliance and a binary treatment. Let <italic>R</italic><sub><italic>i</italic></sub> be the randomised arm (<italic>R</italic><sub><italic>i</italic></sub>=1 for treatment and <italic>R</italic><sub><italic>i</italic></sub>=0 for control), and <italic>Y</italic><sub><italic>i</italic></sub> be the outcome for subject <italic>i</italic>, <italic>i</italic>&#x02208;1,...,<italic>n</italic>. Let <italic>D</italic><sub><italic>i</italic></sub> be an indicator of non-receipt of treatment, so that <italic>D</italic><sub><italic>i</italic></sub>=0 for treated individuals and <italic>D</italic><sub><italic>i</italic></sub>=1 for untreated individuals: this formulation is used as it extends naturally to the time-dependent case in Section&#x02009;4.1. Let <italic>D</italic><sub><italic>i</italic></sub>(<italic>r</italic>) be the potential value of <italic>D</italic><sub><italic>i</italic></sub> if subject <italic>i</italic> had been randomised to treatment <italic>r</italic>. Let <italic>Y</italic><sub><italic>i</italic></sub>(<italic>r</italic>,<italic>d</italic>) be the potential outcome for subject <italic>i</italic> if randomised to <italic>r</italic> and treated/untreated according to <italic>d</italic> = 0/1; we only model <italic>Y</italic><sub><italic>i</italic></sub>(0,1) the untreated outcome in the control arm. Let <italic>C</italic><sub><italic>i</italic></sub> be the latent compliance type for subject <italic>i</italic>, defined in terms of the potential treatments received: individual <italic>i</italic> is an &#x02018;always-taker&#x02019;, &#x02018;never-taker&#x02019;, &#x02018;complier&#x02019; or &#x02018;defier&#x02019; when (<italic>D</italic><sub><italic>i</italic></sub>(0),<italic>D</italic><sub><italic>i</italic></sub>(1)) equals (0,0), (1,1), (1,0) or (0,1) respectively. We allow indirect selection by allowing <italic>C</italic><sub><italic>i</italic></sub> to be associated with <italic>Y</italic><sub><italic>i</italic></sub>(0,1).</p><p>Here, we concentrate on the main form of departure from randomised allocation in TARGET: contamination of the control arm, that is, some of those randomised to control receive treatment. If we assume that those randomised to treatment all receive treatment, then <italic>D</italic><sub><italic>i</italic></sub>(1) = 0 for all <italic>i</italic>, so <italic>C</italic><sub><italic>i</italic></sub>=<italic>D</italic><sub><italic>i</italic></sub>(0): compliance type is treatment received under randomisation to the control arm. Note that in this notation, <italic>C</italic><sub><italic>i</italic></sub>=1 indicates a complier. We do not observe the treatment received under both randomisations for a particular individual so the compliance type <italic>C</italic><sub><italic>i</italic></sub> is only partially observed. If individual <italic>i</italic> is randomised to control (<italic>R</italic><sub><italic>i</italic></sub>=0) and they receive treatment (<italic>D</italic><sub><italic>i</italic></sub>=0), then they must be an always-taker (<italic>C</italic><sub><italic>i</italic></sub>=0), while if they do not receive treatment (<italic>D</italic><sub><italic>i</italic></sub>=1), then they must be a complier (<italic>C</italic><sub><italic>i</italic></sub>=1). However, if individual <italic>i</italic> is randomised to treatment (<italic>R</italic><sub><italic>i</italic></sub>=1), then they must receive treatment (<italic>D</italic><sub><italic>i</italic></sub>=0), and so they may be either an always-taker or a complier. Therefore, the compliance type <italic>C</italic><sub><italic>i</italic></sub> is unobserved for those randomised to treatment <italic>R</italic><sub><italic>i</italic></sub>=1.</p><p>We assume the causal model
<disp-formula id="m2"><graphic xlink:href="sim0034-2019-m2.jpg" mimetype="image" position="float"/><label>3.1</label></disp-formula>
where <italic>D</italic><sub><italic>i</italic></sub>=<italic>C</italic><sub><italic>i</italic></sub> if <italic>R</italic><sub><italic>i</italic></sub>=0 and <italic>D</italic><sub><italic>i</italic></sub>=0 if <italic>R</italic><sub><italic>i</italic></sub>=1. Model <xref ref-type="disp-formula" rid="m2">2</xref> describes observed outcomes as differing in expectation from untreated outcomes only through the receipt of treatment, where <italic>&#x003b2;</italic> is the treatment effect. The absence of a direct effect of <italic>R</italic> expresses the exclusion restriction, that the always-takers have the same mean outcome in both randomised arms. In fact, the model makes unnecessary and unused assumptions about the causal effect of treatment in always-takers: we return to this in the discussion. Model <xref ref-type="disp-formula" rid="m2">2</xref> implies for the observed outcome:
<disp-formula id="m3"><graphic xlink:href="sim0034-2019-m3.jpg" mimetype="image" position="float"/><label>3.2</label></disp-formula>
where <italic>&#x003b1;</italic>(<italic>C</italic><sub><italic>i</italic></sub>) = <italic>E</italic>[<italic>Y</italic><sub><italic>i</italic></sub>(0,1)|<italic>C</italic><sub><italic>i</italic></sub>] represents the mean untreated outcome for individuals with compliance type <italic>C</italic><sub><italic>i</italic></sub>: its dependence on <italic>C</italic><sub><italic>i</italic></sub> allows for indirect selection. Under this model, the causal effect of randomisation on outcome for compliers (<italic>C</italic><sub><italic>i</italic></sub>=1) is
<disp-formula id="m4"><graphic xlink:href="sim0034-2019-m4.jpg" mimetype="image" position="float"/><label>3.3</label></disp-formula>
This is the difference in mean outcome between compliers randomised to treatment and compliers randomised to control. The parameter <italic>&#x003b2;</italic> represents the CACE, the average causal effect among the group of compliers.</p><p>Estimation of <italic>&#x003b2;</italic> is complicated by the fact that compliance type <italic>C</italic><sub><italic>i</italic></sub> is not observed for those randomised to treatment <italic>R</italic><sub><italic>i</italic></sub>=1. A regression of outcome <italic>Y</italic><sub><italic>i</italic></sub> on randomisation <italic>R</italic><sub><italic>i</italic></sub> and compliance type <italic>C</italic><sub><italic>i</italic></sub> will not suffice because <italic>C</italic><sub><italic>i</italic></sub> is not fully observed. Instead, estimation can be achieved using either maximum likelihood or Bayesian methods. In Bayesian analysis, the unobserved compliance types are considered as missing data and estimated in the same way as the other parameters. Probability distributions for <italic>&#x003b2;</italic> and the other parameters are obtained and appropriate summary measures reported.</p><p>In trials with a repeatedly measured outcome and all-or-nothing compliance, a longitudinal version of model <xref ref-type="disp-formula" rid="m3">3</xref> may be fitted. If <italic>Y</italic><sub><italic>i</italic><italic>j</italic></sub> is the outcome for individual <italic>i</italic> at visit <italic>j</italic>, then
<disp-formula id="m5"><graphic xlink:href="sim0034-2019-m5.jpg" mimetype="image" position="float"/><label>3.4</label></disp-formula>
where <italic>D</italic><sub><italic>i</italic></sub> is defined as previously, and <italic>&#x003b1;</italic>(<italic>C</italic><sub><italic>i</italic></sub>,<italic>j</italic>) = <italic>E</italic>[<italic>Y</italic><sub><italic>i</italic><italic>j</italic></sub>(0,1)|<italic>C</italic><sub><italic>i</italic></sub>] represents the mean untreated outcome for individuals with compliance type <italic>C</italic><sub><italic>i</italic></sub> at visit <italic>j</italic>. Under this model, the causal effect of randomisation on outcome at visit <italic>j</italic> for compliers (<italic>C</italic><sub><italic>i</italic></sub>=1) is
<disp-formula id="m6"><graphic xlink:href="sim0034-2019-m6.jpg" mimetype="image" position="float"/><label>3.5</label></disp-formula>
Thus, <italic>&#x003b2;</italic>(<italic>j</italic>) is the CACE at visit <italic>j</italic>. This model has previously been proposed and fitted by Yau and Little <xref rid="b19" ref-type="bibr">19</xref>.</p><p>However, if treatment received is varying over time, the situation becomes more complicated. In our example, at a given visit <italic>j</italic>, those randomised to treatment would all have received treatment at the beginning of the trial, but those randomised to control will be a mixture of those who received treatment, one visit ago, two visits ago and so on up to <italic>j</italic> visits ago and will therefore be receiving different treatment effects at the current time. We now extend the CACE model to account for this by modelling the longitudinal data as follows.</p></sec></sec><sec><title>4 Longitudinal complier average causal effect model</title><sec><title>4.1 Complier average causal effect model for longitudinal compliance</title><p>As previously, let <italic>R</italic><sub><italic>i</italic></sub> be randomised arm (1 for treatment and 0 for control), and <italic>Y</italic><sub><italic>i</italic><italic>j</italic></sub> be outcome for subject <italic>i</italic>&#x02208;1,...,<italic>n</italic>, visit <italic>j</italic>&#x02208;1,...,<italic>m</italic>. We redefine <italic>D</italic><sub><italic>i</italic></sub> as the last visit before surgical treatment (regarding baseline as visit 0): <italic>D</italic><sub><italic>i</italic></sub>=0 if treatment was received between visits 0 and 1, <italic>D</italic><sub><italic>i</italic></sub>=1 if treatment was received between visits 1 and 2 and so on, and <italic>D</italic><sub><italic>i</italic></sub>=<italic>m</italic> if no treatment was received. <italic>D</italic><sub><italic>i</italic></sub> is therefore grouped, not actual, time of surgery. Let <italic>D</italic><sub><italic>i</italic></sub>(<italic>r</italic>) be the potential value of <italic>D</italic><sub><italic>i</italic></sub> for subject <italic>i</italic> if randomised to treatment <italic>r</italic>. Let <italic>Y</italic><sub><italic>i</italic><italic>j</italic></sub>(<italic>r</italic>,<italic>d</italic>) be the potential outcome for subject <italic>i</italic> at visit <italic>j</italic> if randomised to <italic>r</italic> and receiving treatment just after visit <italic>d</italic>; we only model the treatment-free potential outcome <italic>Y</italic><sub><italic>i</italic><italic>j</italic></sub>(0,<italic>m</italic>). Again, we allow for indirect selection by allowing <italic>C</italic><sub><italic>i</italic></sub> to be associated with <italic>Y</italic><sub><italic>i</italic><italic>j</italic></sub>(0,<italic>m</italic>).</p><p>We assume those randomised to treatment receive surgery just after baseline, so that <italic>D</italic><sub><italic>i</italic></sub>(1) = 0 for all <italic>i</italic>. Thus, <italic>C</italic><sub><italic>i</italic></sub>, the latent compliance type for subject <italic>i</italic>, is again defined as <italic>C</italic><sub><italic>i</italic></sub>=<italic>D</italic><sub><italic>i</italic></sub>(0), the last visit before surgical treatment under randomisation to control. Now, <italic>C</italic><sub><italic>i</italic></sub> is categorical and is a summary of longitudinal compliance so is not dependent on time. The compliance types are principal strata in the terminology of Frangakis and Rubin <xref rid="b10" ref-type="bibr">10</xref>. In particular, the principal strata with <inline-formula><inline-graphic xlink:href="sim0034-2019-mu7.jpg" mimetype="image"/></inline-formula> are the &#x02018;compliers at visit j&#x02019;, that is, those individuals who would receive treatment under randomisation to treatment but would receive no treatment up to visit <italic>j</italic> under randomisation to control.</p><p>We consider two causal models to specify the mean outcome, basing the treatment effect on (1) the number of visits since receiving treatment and (2) the number of days since receiving treatment. Both models describe the mean of <italic>Y</italic><sub><italic>i</italic><italic>j</italic></sub>&#x02212;<italic>Y</italic><sub><italic>i</italic><italic>j</italic></sub>(0,<italic>m</italic>), which is the difference between an individual&#x02019;s observed outcome and the same individual&#x02019;s counterfactual outcome if they were randomised to control and never treated.</p><sec><title>4.1.1 Causal model using visits</title><p>The first model assumes equal spacing between visits and assumes that treatment occurs just after a visit:
<disp-formula id="m7"><graphic xlink:href="sim0034-2019-m8.jpg" mimetype="image" position="float"/><label>4.1</label></disp-formula>
where <italic>D</italic><sub><italic>i</italic></sub>=<italic>C</italic><sub><italic>i</italic></sub> if <italic>R</italic><sub><italic>i</italic></sub>=0 and <italic>D</italic><sub><italic>i</italic></sub>=0 if <italic>R</italic><sub><italic>i</italic></sub>=1. Here, <italic>&#x003b2;</italic>(<italic>k</italic>), a function of <italic>k</italic> for <italic>k</italic>&#x02208;1,...,<italic>m</italic>, represents the causal effect of treatment on outcome measured <italic>k</italic> visits after treatment. We assume <italic>&#x003b2;</italic>(<italic>k</italic>) is equal across randomised arms: this identifying assumption is plausible in TARGET. This model implies for the observed data:
<disp-formula id="m8"><graphic xlink:href="sim0034-2019-m9.jpg" mimetype="image" position="float"/><label>4.2</label></disp-formula>
where <italic>&#x003b1;</italic>(<italic>C</italic><sub><italic>i</italic></sub>,<italic>j</italic>) = <italic>E</italic>[<italic>Y</italic><sub><italic>i</italic><italic>j</italic></sub>(0,<italic>m</italic>)|<italic>C</italic><sub><italic>i</italic></sub>] represents the mean untreated hearing loss for a patient with compliance type <italic>C</italic><sub><italic>i</italic></sub> at visit <italic>j</italic>; its dependence on <italic>C</italic><sub><italic>i</italic></sub> allows for indirect selection. The model embodies the exclusion restriction, because individuals of a given compliance type have the same mean untreated outcome, <italic>&#x003b1;</italic>(<italic>C</italic><sub><italic>i</italic></sub>,<italic>j</italic>), in both randomised arms. Those randomised to control with <inline-formula><inline-graphic xlink:href="sim0034-2019-mu10.jpg" mimetype="image"/></inline-formula> have not (yet) departed from their allocation (i.e. have not yet received any treatment), and so their expected outcome equals the mean untreated outcome <italic>&#x003b1;</italic>(<italic>C</italic><sub><italic>i</italic></sub>,<italic>j</italic>). Those randomised to control with <italic>D</italic><sub><italic>i</italic></sub>&#x0003c;<italic>j</italic> received treatment <italic>j</italic> &#x02212; <italic>D</italic><sub><italic>i</italic></sub> visits ago, so their expected outcome is <italic>&#x003b1;</italic>(<italic>C</italic><sub><italic>i</italic></sub>,<italic>j</italic>) + <italic>&#x003b2;</italic>(<italic>j</italic> &#x02212; <italic>D</italic><sub><italic>i</italic></sub>). Those randomised to treatment all have <italic>D</italic><sub><italic>i</italic></sub>=0, so their expected outcome is <italic>&#x003b1;</italic>(<italic>C</italic><sub><italic>i</italic></sub>,<italic>j</italic>) + <italic>&#x003b2;</italic>(<italic>j</italic>).</p><p>Under this model, the causal effect of randomisation on outcome at visit <italic>j</italic> for principal stratum <italic>c</italic> is
<disp-formula id="m9"><graphic xlink:href="sim0034-2019-m11.jpg" mimetype="image" position="float"/><label>4.3</label></disp-formula>
Thus, <italic>&#x003b2;</italic>(<italic>j</italic>) is the causal effect of randomisation on outcome at visit <italic>j</italic> for individuals in each of the principal strata with <inline-formula><inline-graphic xlink:href="sim0034-2019-mu12.jpg" mimetype="image"/></inline-formula>. We therefore interpret <italic>&#x003b2;</italic>(<italic>j</italic>) as the average causal effect of randomisation on outcome at visit <italic>j</italic> among compliers at visit <italic>j</italic>.</p></sec><sec><title>4.1.2 Causal model using days</title><p>We extend the aforementioned model to allow for unequal intervals between visits and to allow the causal effect of treatment to depend on the actual number of days since receiving treatment. Let the visits occur at <italic>t</italic><sub>1</sub>,<italic>t</italic><sub>2</sub>,&#x02026;,<italic>t</italic><sub><italic>m</italic></sub> days after randomisation. The setup is the same as previously, but instead of using <italic>D</italic><sub><italic>i</italic></sub> to represent actual treatment, we now let <italic>T</italic><sub><italic>i</italic></sub> represent the time (in days) at which individual <italic>i</italic> first received treatment, or a value greater than <italic>t</italic><sub><italic>m</italic></sub> if treatment was never received. Compliance type is defined in terms of the potential treatment time under randomisation to control <italic>T</italic><sub><italic>i</italic></sub>(0) as follows:
<disp-formula id="m10"><graphic xlink:href="sim0034-2019-m13.jpg" mimetype="image" position="float"/></disp-formula>
Let <italic>&#x003b2;</italic>(<italic>j</italic>) represent the treatment effect among compliers <italic>t</italic><sub><italic>j</italic></sub> days after receiving treatment, where <italic>j</italic> = 1,2,&#x02026;,<italic>m</italic>. We assume a piecewise linear treatment effect between these times:
<disp-formula id="m11"><graphic xlink:href="sim0034-2019-m14.jpg" mimetype="image" position="float"/><label>4.4</label></disp-formula>
for <italic>k</italic> = 0,1,2,&#x02026;,<italic>m</italic> &#x02212; 1. This implies the observed data model
<disp-formula id="m12"><graphic xlink:href="sim0034-2019-m15.jpg" mimetype="image" position="float"/><label>4.5</label></disp-formula>
where <italic>&#x003b1;</italic>(<italic>C</italic><sub><italic>i</italic></sub>,<italic>j</italic>) = <italic>E</italic>[<italic>Y</italic><sub><italic>i</italic><italic>j</italic></sub>(0,<italic>m</italic>)|<italic>C</italic><sub><italic>i</italic></sub>] represents the mean untreated hearing loss for a patient with compliance type <italic>C</italic><sub><italic>i</italic></sub> at visit <italic>j</italic>, and <italic>&#x003b2;</italic>(<italic>k</italic>) is the average effect of randomisation on outcome at <italic>t</italic><sub><italic>k</italic></sub> days in the principal strata of compliers.</p></sec><sec><title>4.1.3 Distributional model</title><p>In both models, the outcomes <bold>Y</bold><sub><italic>i</italic></sub>=(<italic>Y</italic><sub><italic>i</italic>1</sub>,....,<italic>Y</italic><sub><italic>i</italic><italic>m</italic></sub>) are assumed to have a multivariate normal distribution,
<disp-formula id="m13"><graphic xlink:href="sim0034-2019-m16.jpg" mimetype="image" position="float"/></disp-formula>
with means <bold><italic>&#x003bc;</italic></bold><sub><italic>i</italic></sub>=(<italic>&#x003bc;</italic><sub><italic>i</italic>1</sub>,...,<italic>&#x003bc;</italic><sub><italic>i</italic><italic>m</italic></sub>), where <italic>&#x003bc;</italic><sub><italic>i</italic><italic>j</italic></sub>=<italic>E</italic>(<italic>Y</italic><sub><italic>i</italic><italic>j</italic></sub>|<italic>R</italic><sub><italic>i</italic></sub>,<italic>C</italic><sub><italic>i</italic></sub>) as given in <xref ref-type="disp-formula" rid="m8">8</xref> or <xref ref-type="disp-formula" rid="m12">12</xref>, and <bold><italic>&#x003a3;</italic></bold> is an unstructured <italic>m</italic> &#x000d7; <italic>m</italic> covariance matrix. We also assume a saturated model for <italic>C</italic><sub><italic>i</italic></sub>, that is, <italic>p</italic>(<italic>C</italic><sub><italic>i</italic></sub>=<italic>c</italic>) = <italic>&#x003b3;</italic>(<italic>c</italic>).</p></sec></sec><sec><title>4.2 Assumptions</title><p>The aforementioned model makes several assumptions. The randomisation assumption implies that randomisation <italic>R</italic><sub><italic>i</italic></sub> is independent of pre-randomisation variables, including latent compliance type <italic>C</italic><sub><italic>i</italic></sub> and potential outcome <italic>Y</italic><sub><italic>i</italic></sub>(0,1) <xref rid="b14" ref-type="bibr">14</xref>. The stable unit treatment value assumption implies no interference between individuals, so that the compliance behaviour of one patient is not affected by the randomisation of other patients, and the potential outcome of one patient is not affected by the randomisation and compliance status of other patients. We also assume the causal model given by either <xref ref-type="disp-formula" rid="m7">7</xref> or <xref ref-type="disp-formula" rid="m11">11</xref>, and that <italic>&#x003b2;</italic>(<italic>k</italic>) is equal across randomised arms.</p></sec><sec><title>4.3 Identification</title><p>We describe how the parameters <italic>&#x003b3;</italic>(<italic>c</italic>), <italic>&#x003b2;</italic>(<italic>j</italic>) and <italic>&#x003b1;</italic>(<italic>c</italic>,<italic>j</italic>) (for <italic>c</italic> = 0,&#x02026;,<italic>m</italic> and <italic>j</italic> = 1,&#x02026;,<italic>m</italic>) are identified in the causal model using visits. A similar argument applies for the causal model using days. 
<list list-type="order"><list-item><p>Since <italic>C</italic><sub><italic>i</italic></sub> is observed if <italic>R</italic><sub><italic>i</italic></sub>=0, <italic>&#x003b3;</italic>(<italic>c</italic>) may be estimated using <italic>&#x003b3;</italic>(<italic>c</italic>) = <italic>P</italic>(<italic>C</italic><sub><italic>i</italic></sub>=<italic>c</italic>|<italic>R</italic><sub><italic>i</italic></sub>=0).
</p></list-item><list-item><p>Since E[<italic>Y</italic><sub><italic>i</italic><italic>j</italic></sub>|<italic>R</italic><sub><italic>i</italic></sub>=1] = <italic>&#x003b2;</italic>(<italic>j</italic>) + E[<italic>&#x003b1;</italic>(<italic>C</italic><sub><italic>i</italic></sub>,<italic>j</italic>)] and <inline-formula><inline-graphic xlink:href="sim0034-2019-mu17.jpg" mimetype="image"/></inline-formula>, the ITT difference E[<italic>Y</italic><sub><italic>i</italic><italic>j</italic></sub>|<italic>R</italic><sub><italic>i</italic></sub>=1] &#x02212; E[<italic>Y</italic><sub><italic>i</italic><italic>j</italic></sub>|<italic>R</italic><sub><italic>i</italic></sub>=0] may be expressed in terms of (<italic>&#x003b3;</italic>(0),&#x02026;,<italic>&#x003b3;</italic>(<italic>j</italic> &#x02212; 1)) and (<italic>&#x003b2;</italic>(1),&#x02026;,<italic>&#x003b2;</italic>(<italic>j</italic>)). So the ITT difference at time <italic>j</italic> may be used recursively to estimate <italic>&#x003b2;</italic>(<italic>j</italic>).
</p></list-item><list-item><p>Finally, we have E[<italic>Y</italic><sub><italic>i</italic><italic>j</italic></sub>|<italic>C</italic><sub><italic>i</italic></sub>=<italic>c</italic>,<italic>R</italic><sub><italic>i</italic></sub>=0] = <italic>&#x003b1;</italic>(<italic>c</italic>,<italic>j</italic>) if <inline-formula><inline-graphic xlink:href="sim0034-2019-mu18.jpg" mimetype="image"/></inline-formula> and =<italic>&#x003b1;</italic>(<italic>c</italic>,<italic>j</italic>) + <italic>&#x003b2;</italic>(<italic>j</italic> &#x02212; <italic>c</italic>) if <italic>c</italic> &#x0003c; <italic>j</italic>. This may be used to estimate <italic>&#x003b1;</italic>(<italic>c</italic>,<italic>j</italic>).
</p></list-item></list></p><p>The aforementioned procedure for estimating the <italic>&#x003b2;</italic>(<italic>j</italic>) is essentially the same as the instrumental variables procedure. However, the Bayesian procedure makes fuller use of the data.</p></sec><sec><title>4.4 Bayesian estimation</title><p>In Bayesian inference, we assume prior distributions for the parameters to be estimated and simulate the posterior distribution using the Gibbs sampler, treating the unobserved compliance types and missing outcomes as missing data. The CACE can only be indirectly estimated through the observation of mixtures of distributions. If compliance type is known for all units, inference of the causal estimands involves only data from the associated subpopulation with no mixture components. The first step of the data augmentation algorithm is to impute the missing compliance types by drawing them from their conditional distribution, a multinomial distribution, given observed data and current drawn values of <italic>&#x003b1;</italic>,<italic>&#x003b2;</italic>,<italic>&#x003b3;</italic> and <italic>&#x003a3;</italic>. The second step is to draw values of parameters from the complete-data posterior distribution given current values of <italic>C</italic><sub><italic>i</italic></sub> and the observed values of <italic>Y</italic><sub><italic>i</italic></sub>, <italic>D</italic><sub><italic>i</italic></sub> and <italic>R</italic><sub><italic>i</italic></sub>. This involves drawing <italic>&#x003b1;</italic> and <italic>&#x003b2;</italic> from a multivariate normal distribution and <italic>&#x003a3;</italic> from an inverse Wishart distribution.</p></sec></sec><sec><title>5 Application</title><p>We now apply the aforementioned models to data from the TARGET trial. To fit the models to the TARGET data, we make some simplifying assumptions to avoid creating too many compliance types. Non-compliance is assumed to occur in only one direction: those allocated to control can receive VT but not vice-versa. Some of those who received VT had the ventilation tube reinserted at a later time, but the reinsertions are also ignored here. In the TARGET trial, treatment may be received at any time, but we ignore its precise timing and define the compliance types as the last visit before which the individual would receive surgical treatment if randomised to control. <italic>C</italic> = 0 corresponds to those who would receive VT between visits 0 and 1 if they had been randomised to control, <italic>C</italic> = 1 corresponds to those who would receive VT between visits 1 and 2 if they had been randomised to control and so on. In this notation, <italic>C</italic> = 5 corresponds to those who would not have received VT at all, had they been randomised to control. The compliance types are unobserved in those randomised to treatment, but the model parameters may be estimated using Bayesian methods.</p><p>We analyse <italic>n</italic> = 248 individuals, 122 randomised to control (<italic>R</italic> = 0) and 126 randomised to VT (<italic>R</italic> = 1). There are five visits, so <italic>j</italic> = 1,2,3,4,5, and the corresponding number of days is taken to be <italic>t</italic><sub>1</sub>=90,<italic>t</italic><sub>2</sub>=180,<italic>t</italic><sub>3</sub>=365,<italic>t</italic><sub>4</sub>=550,<italic>t</italic><sub>5</sub>=730.</p><p>Here, we assess the plausibility of assumptions made in Section&#x02009;4.2. Treatment assignment was random in the TARGET trial, satisfying the randomisation assumption. The stable unit treatment value assumption (SUTVA) implies that the potential outcome for each individual does not depend on the treatment status of other individuals. This holds in TARGET because the hearing loss of one participant should not be affected by the treatment that other trial participants are receiving. The exclusion restriction means that treatment assignment is unrelated to potential outcomes given treatment received. This is plausible in TARGET because the outcome only depends on the time since receiving treatment and compliance type, rather than on randomisation. The monotonicity assumption implies that there are no defiers. In the TARGET example, most of those offered treatment took it up, so the assumption of no never-takers or defiers is plausible. The joint likelihood method assumes that the likelihood is correctly specified, namely normality of outcomes and a correctly specified covariance matrix.</p><sec><title>5.1 Implementation</title><p>The aforementioned models were fitted using Markov chain Monte Carlo in WinBUGS <xref rid="b24" ref-type="bibr">24</xref> and were run for 100000 iterations. Diffuse normal distributions with mean zero and a large variance were used as prior distributions for the parameters <italic>&#x003b1;</italic>(<italic>c</italic>,<italic>j</italic>),<italic>&#x003b2;</italic>(<italic>j</italic>). An inverse Wishart distribution was used as a prior for <bold><italic>&#x003a3;</italic></bold>.
<disp-formula id="m14"><graphic xlink:href="sim0034-2019-m19.jpg" mimetype="image" position="float"/></disp-formula>
The posterior distribution was simulated, treating the unobserved compliance types and missing outcomes as missing data. We assume that the missing outcomes are missing at random <xref rid="b25" ref-type="bibr">25</xref>, though other methods could be applied, as noted in the discussion. The simulations were run on two chains, which were initialised at different values near the maximum likelihood estimates. The first chain was initialised at <italic>&#x003b1;</italic>(<italic>c</italic>,<italic>j</italic>) = 20,<italic>&#x003b2;</italic>(<italic>j</italic>) =&#x02212; 10 for all <italic>c</italic><italic>and</italic><italic>j</italic> and <italic>C</italic><sub><italic>i</italic></sub>=1 for all <italic>i</italic>. The second chain was initialised at <italic>&#x003b1;</italic>(<italic>c</italic>,<italic>j</italic>) = 10,<italic>&#x003b2;</italic>(<italic>j</italic>) =&#x02212; 5 for all <italic>c</italic>,<italic>j</italic> and <italic>C</italic><sub><italic>i</italic></sub>=1 for all <italic>i</italic>. Convergence was assessed using the Gelman&#x02013;Rubin diagnostic <xref rid="b26" ref-type="bibr">26</xref> and history plots for each parameter. All of the model parameters, <italic>&#x003b1;</italic>(<italic>c</italic>,<italic>j</italic>),<italic>&#x003b2;</italic>(<italic>j</italic>),<bold><italic>&#x003a3;</italic></bold>, were mixing well, that is, the two chains were moving freely over the parameter space and appeared to have converged after about 10000 iterations.</p><p>The model using days since VT was implemented similarly. If there is a missing visit, we assume the number of missing days because receiving VT is equal to the scheduled number of days. This value is used to impute the missing <italic>Y</italic><sub><italic>i</italic><italic>j</italic></sub>. An alternative model for the missing days with an appropriate mean structure gave similar results.</p></sec><sec><title>5.2 Results</title><p>Table&#x02009;<xref ref-type="table" rid="tbl2">2</xref> gives the treatment effect estimates from an ITT analysis (model <xref ref-type="disp-formula" rid="m1">1</xref>) and from the CACE model by visits since receiving VT (model <xref ref-type="disp-formula" rid="m8">8</xref>). Under ITT, VT reduces hearing loss more than control, by 11.6dB with 95% CI (9.3 to 13.8)dB after one visit and by 5.6dB with 95% CI (3.1 to 8.1) after two visits. Under the CACE analysis, VT reduces hearing loss by 11.6 (9.2 to 14.0)dB compared to control after one visit and 7.2 (4.4 to 10.1)dB after two visits. The ITT analysis would be expected to give a conservative estimate of the treatment effect compared to the CACE model at visit 1, because the ITT analysis includes some patients in the control arm who have received VT one visit ago. In this case, the ITT and CACE estimates are similar for visit 1. For visits 3, 4 and 5, the sign of the ITT effect is positive, indicating a small but non-significant adverse effect of VT, whereas the CACE estimates are negative, indicating a small but non-significant beneficial effect of VT. This change is because at visit 3, for example, the control arm contains a mixture of patients, some of whom have received control and others who have received VT one, two or three visits ago.</p><p>Table&#x02009;<xref ref-type="table" rid="tbl3">3</xref> gives the treatment effect estimates from an ITT analysis and from the CACE model by days since receiving VT (model <xref ref-type="disp-formula" rid="m12">12</xref>). We observe slightly larger treatment effects in both CACE and ITT analyses when taking into account actual days since receiving VT, rather than assuming equal spacing between visits. Qualitatively, both analyses agree that VT is significantly better for the first 6months after receiving VT. After 6months, no significant difference between VT and control is observed. By this time, a substantial proportion of those randomised to control have received VT, so the ITT analysis obscures a possible benefit of VT, whereas the CACE analysis indicates a non-significant beneficial effect.</p><table-wrap id="tbl3" position="float"><label>Table 3</label><caption><p>Estimates of treatment effect using number of days since VT.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="1" colspan="1">Days since VT</th><th align="left" rowspan="1" colspan="1">ITT (95% CI)</th><th align="left" rowspan="1" colspan="1">CACE (95% CI)</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">90</td><td align="left" rowspan="1" colspan="1">&#x02212;11.9(&#x02212;14.3,&#x02212;9.5)</td><td align="left" rowspan="1" colspan="1">&#x02212;12.0(&#x02212;14.3,&#x02212;9.5)</td></tr><tr><td align="left" rowspan="1" colspan="1">180</td><td align="left" rowspan="1" colspan="1">&#x02212;7.3(&#x02212;9.8,&#x02212;4.7)</td><td align="left" rowspan="1" colspan="1">&#x02212;8.5(&#x02212;11.2,&#x02212;5.8)</td></tr><tr><td align="left" rowspan="1" colspan="1">365</td><td align="left" rowspan="1" colspan="1">&#x02212;0.2(&#x02212;2.9,2.7)</td><td align="left" rowspan="1" colspan="1">&#x02212;2.5(&#x02212;5.4,0.3)</td></tr><tr><td align="left" rowspan="1" colspan="1">550</td><td align="left" rowspan="1" colspan="1">1.0(&#x02212;2.0,4.0)</td><td align="left" rowspan="1" colspan="1">&#x02212;1.3(&#x02212;4.7,2.0)</td></tr><tr><td align="left" rowspan="1" colspan="1">730</td><td align="left" rowspan="1" colspan="1">0.8(&#x02212;1.5,3.2)</td><td align="left" rowspan="1" colspan="1">0.6(&#x02212;2.1,3.7)</td></tr></tbody></table><table-wrap-foot><fn id="tf3-1"><p>ITT (intention-to-treat) is the average effect of randomisation on observed outcome after <italic>t</italic> days.</p></fn><fn id="n6"><p>CACE (complier average causal effect) is the average effect of randomisation on outcome at <italic>t</italic><sub><italic>k</italic></sub> days in the principal strata of compliers at <italic>t</italic><sub><italic>k</italic></sub> days (<italic>&#x003b2;</italic>(<italic>k</italic>) from model <xref ref-type="disp-formula" rid="m12">12</xref>). VT, ventilation tubes.</p></fn></table-wrap-foot></table-wrap><p>A graph of the estimates of <italic>&#x003b1;</italic>(<italic>c</italic>,<italic>j</italic>) from model <xref ref-type="disp-formula" rid="m8">8</xref>, representing the untreated outcome over time for each compliance type, is given in Figure&#x02009;<xref ref-type="fig" rid="fig03">3</xref>. Compliance type 0 has a relatively low hearing loss that gradually decreases over time. Compliance type 1 begins with a high hearing loss but decreases rapidly over time. Compliance type 2 has a relatively high hearing loss at the first two visits which then decreases. Compliance type 3 has moderate hearing loss at visits 1 and 2 then a very high hearing loss at visit 3 that decreases over the next two visits. Compliance type 4 starts with moderate hearing loss, increases to a high value at visit 3 then decreases. Finally, compliance type 5 begins with a low hearing loss that gradually decreases over time. The trajectories for those who receive VT immediately after baseline (C=0) and those who never receive VT under randomisation to control (C=5) are quite similar. This is consistent with early departures being due to discontentment with the allocation rather than poor outcomes.</p><fig id="fig03" position="float"><label>Figure 3</label><caption><p>Estimates from model <xref ref-type="disp-formula" rid="m8">8</xref> of mean untreated outcome, <italic>&#x003b1;</italic>(<italic>C</italic>,<italic>j</italic>), by compliance type.</p></caption><graphic xlink:href="sim0034-2019-f3"/></fig></sec><sec><title>5.3 Model checking</title><p>Plots of standardised residuals show that most lie within a reasonable range of about (&#x02212;2.5,2.5). There are a few extreme residuals and these usually correspond to very high (&#x0003e;40 dB) outcomes. Exclusion of individuals with extreme residuals has little effect on the results. Plots of residuals versus fitted values show no distinguishable pattern. Comparison of the fitted values <inline-formula><inline-graphic xlink:href="sim0034-2019-mu20.jpg" mimetype="image"/></inline-formula> from model <xref ref-type="disp-formula" rid="m8">8</xref> (Figure&#x02009;<xref ref-type="fig" rid="fig04">4</xref>) with the crude mean outcome in the control arm (Figure&#x02009;<xref ref-type="fig" rid="fig05">5</xref>) suggests that the model makes fairly plausible assumptions.</p><fig id="fig04" position="float"><label>Figure 4</label><caption><p>Fitted values from model <xref ref-type="disp-formula" rid="m8">8</xref> for control arm by compliance type.</p></caption><graphic xlink:href="sim0034-2019-f4"/></fig><fig id="fig05" position="float"><label>Figure 5</label><caption><p>Mean outcome from model <xref ref-type="disp-formula" rid="m8">8</xref> for control arm by compliance type.</p></caption><graphic xlink:href="sim0034-2019-f5"/></fig><p>Alternative options for <italic>&#x003a9;</italic> in the Wishart prior distribution were used, such as <italic>&#x003a9;</italic> = <italic>d</italic><italic>i</italic><italic>a</italic><italic>g</italic>(0.001) and <italic>&#x003a9;</italic> = <italic>d</italic><italic>i</italic><italic>a</italic><italic>g</italic>(1000), as well as non-diagonal matrices. These made little difference to estimates of the CACEs.</p></sec></sec><sec><title>6 Simulation study</title><p>We performed a small simulation study to evaluate the performance of the proposed method and to compare it with the IV method in a data generating model loosely based on the TARGET results and the causal model using visits.</p><sec><title>6.1 Data-generating model</title><p>We generated 1000 data sets of size 300 with <italic>m</italic> = 5 time points. We assumed equal randomisation (<italic>p</italic>(<italic>R</italic><sub><italic>i</italic></sub>=1) = 0.5). The latent compliance types were distributed with <italic>&#x003b3;</italic>(0) = <italic>&#x003b3;</italic>(1) = <italic>&#x003b3;</italic>(2) = <italic>&#x003b3;</italic>(3) = <italic>&#x003b3;</italic>(4) = 1/9, <italic>&#x003b3;</italic>(5) = 4/9. The untreated mean outcomes were derived from TARGET as <italic>&#x003b1;</italic>(<italic>c</italic>,<italic>j</italic>) = 10 if <italic>c</italic> = 0,5; <italic>&#x003b1;</italic>(<italic>c</italic>,<italic>j</italic>) = 25 &#x02212; <italic>j</italic> if <italic>C</italic> = 1,2; <italic>&#x003b1;</italic>(<italic>c</italic>,<italic>j</italic>) = 22 &#x02212; 3|<italic>j</italic> &#x02212; 3| if <italic>C</italic> = 3,4. The treatment effect was modelled as <italic>&#x003b2;</italic>(<italic>j</italic>) = 2(6 &#x02212; <italic>j</italic>). Finally, <italic>Y</italic><sub><italic>i</italic><italic>j</italic></sub> followed model <xref ref-type="disp-formula" rid="m12">12</xref> with uncorrelated <italic>N</italic>(0,8<sup>2</sup>) errors. There were no missing data.</p></sec><sec><title>6.2 Analyses</title><p>Model <xref ref-type="disp-formula" rid="m8">8</xref> was used. For comparison the IV, analysis was done, using dummy variables for treatment 1,&#x02026;,5 visits ago as endogenous variables, the interaction of randomised group and time as instruments, and dummy variables for visits as covariates.</p></sec><sec><title>6.3 Results</title><p>The results are summarised in Figure&#x02009;<xref ref-type="fig" rid="fig06">6</xref>. Bias was small (magnitude &#x02264;0.1 compared with treatment effects ranging from 10 to 2) and somewhat worse for the Bayesian method. However, the Bayesian method had a standard error 15&#x02013;20% smaller than the IV method and hence a smaller mean squared error. Finally, the Bayesian method achieved 95% coverage near the correct 95% interval, while the IV method somewhat under-covered.</p><fig id="fig06" position="float"><label>Figure 6</label><caption><p>Results from the simulation study of Section&#x02009;6. Monte Carlo error is expressed through 95% confidence intervals.</p></caption><graphic xlink:href="sim0034-2019-f6"/></fig></sec></sec><sec><title>7 Conclusions and discussion</title><sec><title>7.1 Conclusions</title><p>In randomised clinical trials in which a substantial proportion of patients departs from their randomised treatment, standard ITT analysis compares treatment policies but may obscure the treatment effect. Per-protocol analyses that compare those who adhere to their randomised allocation between randomised arms are commonly used, but these are subject to selection bias. Instead, randomisation-based estimates of efficacy may be employed. Given reasonable assumptions, the CACE model can provide estimates of the average causal effect of treatment among the group of compliers.</p><p>CACE models have previously been applied in simple situations where treatment is all-or-nothing and compliance is binary. We extended the CACE model to incorporate compliance that is changing over time by introducing categorical compliance types based on the time of receiving treatment. We specified a model for the conditional distribution of outcome given randomisation and compliance type and fitted this to obtain estimates of the causal effect of treatment at each visit. Full probability modelling enables model checking by comparing fitted values with the observed values, by checking for extreme residuals and by examining the plot of residuals versus fitted values.</p><p>We applied this model to data from the TARGET trial in which outcomes are measured over five time points, and departures from the control arm to surgical intervention could occur at any time. In this example, the CACE analyses generally gave larger estimates of treatment effect compared to the ITT effects. The ITT estimates are conservative in this case because at any given time, the control arm contains a mixture of people, some of whom are receiving the effect of surgery. Adjusting for the exact timing of the visit had little effect on the results.</p><p>The CACE model can provide a useful secondary analysis in addition to the primary ITT analysis. However, the average causal effect among compliers may not be a representative of the causal effect among the general population. In addition, the longitudinal CACE model is somewhat complex both conceptually and in terms of computation. Computation can be performed using either maximum likelihood or Bayesian methods, but software would be needed to make CACE estimation more accessible.</p></sec><sec><title>7.2 Discussion</title><p>In this paper, we focused mainly on contamination of the control arm, that is, those randomised to control receiving VT. The model could be extended to include non-receipt of VT in the VT arm by creating just one more compliance type, namely those who would not receive VT if randomised to it, and making a no-defiers (monotonicity) assumption that these individuals would also not have received VT if randomised to control.</p><p>We ignored baseline covariates such as trial centre and baseline hearing loss in the CACE models. Inclusion of covariates both in the outcome model and as predictors in the compliance model should improve efficiency but could make estimation more complex and is a topic for further work. Trials that are large enough to consider interactions between baseline and outcome allow identification of patients who benefit most. In TARGET, there was evidence that those who had worse hearing benefit more from treatment and such people were more likely to receive non-randomised surgery. This is one situation in which applying CACE analysis can be useful <xref rid="b3" ref-type="bibr">3</xref>.</p><p>The model could be extended to incorporate a <italic>k</italic>-level treatment by including more compliance types, one for each level of each treatment. The mean outcome model may need to be changed to give a different treatment effect for each level of treatment. It would be possible to incorporate continuous compliance by modelling <italic>&#x003b1;</italic>(<italic>c</italic>,<italic>j</italic>), for example using a linear model. However, this may be too sensitive to the modelling assumptions.</p><p>We used the identifying assumption that the causal effect of VT was the same in both randomised arms. This might be false if randomisation to control modified the value of a subsequent VT. However, in TARGET, control involved watchful waiting, and very few cases received any active treatment, so the identifying assumption seems plausible. An alternative could be to allow the causal effect of VT on the outcome <italic>k</italic> visits later to be <italic>&#x003b2;</italic>(<italic>k</italic>) in the VT arm and <italic>&#x003bb;</italic><italic>&#x003b2;</italic>(<italic>k</italic>) in the control arm and to allow <italic>&#x003bb;</italic> to vary over a range of values below 1.</p><p>A limitation of the models is that they assume missing data are missing at random. Much work has been carried out to adjust for both non-compliance and missing data, for example <xref rid="b27" ref-type="bibr">27</xref>&#x02013;<xref rid="b30" ref-type="bibr">30</xref>, and these methods could be incorporated into the models presented.</p><p>Models <xref ref-type="disp-formula" rid="m2">2</xref>, <xref ref-type="disp-formula" rid="m7">7</xref> and <xref ref-type="disp-formula" rid="m11">11</xref> make stronger assumptions than are required. For example, model <xref ref-type="disp-formula" rid="m2">2</xref> unnecessarily equates <italic>E</italic>[<italic>Y</italic><sub><italic>i</italic></sub>&#x02212;<italic>Y</italic><sub><italic>i</italic></sub>(0,1)|<italic>R</italic><sub><italic>i</italic></sub>=1,<italic>C</italic><sub><italic>i</italic></sub>=0], the causal effect of treatment in always-takers, to <italic>E</italic>[<italic>Y</italic><sub><italic>i</italic></sub>&#x02212;<italic>Y</italic><sub><italic>i</italic></sub>(0,1)|<italic>R</italic><sub><italic>i</italic></sub>=1,<italic>C</italic><sub><italic>i</italic></sub>=1], the causal effect of treatment in compliers randomised to treatment. It would be sufficient to assume that <italic>E</italic>[<italic>Y</italic><sub><italic>i</italic></sub>|<italic>R</italic><sub><italic>i</italic></sub>=1,<italic>C</italic><sub><italic>i</italic></sub>] &#x02212; <italic>E</italic>[<italic>Y</italic><sub><italic>i</italic></sub>|<italic>R</italic><sub><italic>i</italic></sub>=0,<italic>C</italic><sub><italic>i</italic></sub>] equals <italic>&#x003b2;</italic>(1 &#x02212; <italic>C</italic><sub><italic>i</italic></sub>), as is implied by (but does not imply) model <xref ref-type="disp-formula" rid="m2">2</xref>.</p><p>An alternative to full probability modelling is to estimate the CACE using IV analysis <xref rid="b31" ref-type="bibr">31</xref>. This is easier to implement than the full probability modelling method described here and avoids distributional assumptions but does not perform as well as the CACE in terms of operating characteristics such as bias and the width of 90% intervals <xref rid="b15" ref-type="bibr">15</xref>,<xref rid="b21" ref-type="bibr">21</xref>.</p></sec></sec></body><back><ack><p>We would like to thank the TARGET investigators for the use of their data. The collaborators are listed in an appendix to <xref rid="b23" ref-type="bibr">23</xref>. This work was carried out by the first author as part of the postgraduate study funded by a medical research council scholarship. Ian White was supported by the medical research council (unit programme number U105260558).</p></ack><fn-group><fn id="fn1"><label>&#x02021;</label><p>In the main trial paper and elsewhere, the pre-randomisation visits are referred to as visits 1 and 2 and the post-randomisation visits are referred to as visits 3 to 7.</p></fn></fn-group><ref-list><title>References</title><ref id="b1"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Pocock</surname><given-names>SJ</given-names></name></person-group><source>Clinical Trials: A Practical Approach</source><year>1983</year><publisher-loc>Chichester</publisher-loc><publisher-name>Wiley</publisher-name></element-citation></ref><ref id="b2"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hollis</surname><given-names>S</given-names></name><name><surname>Campbell</surname><given-names>F</given-names></name></person-group><article-title>What is meant by intention to treat analysis? Survey of published randomised controlled trials</article-title><source>British Medical Journal</source><year>1999</year><volume>319</volume><issue>7211</issue><fpage>670</fpage><lpage>674</lpage><pub-id pub-id-type="pmid">10480822</pub-id></element-citation></ref><ref id="b3"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>White</surname><given-names>IR</given-names></name></person-group><article-title>Uses and limitations of randomization-based efficacy estimators</article-title><source>Statistical Methods in Medical Research</source><year>2005</year><volume>14</volume><issue>4</issue><fpage>327</fpage><lpage>347</lpage><pub-id pub-id-type="pmid">16178136</pub-id></element-citation></ref><ref id="b4"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>The Coronary Drug Research Project</surname></name></person-group><article-title>Influence of adherence to treatment and response of cholesterol on mortality in the coronary drug project</article-title><source>New England Journal of Medicine</source><year>1980</year><volume>303</volume><issue>18</issue><fpage>1038</fpage><lpage>1041</lpage><pub-id pub-id-type="pmid">6999345</pub-id></element-citation></ref><ref id="b5"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>YJ</given-names></name><name><surname>Ellenberg</surname><given-names>JH</given-names></name><name><surname>Hirtz</surname><given-names>DG</given-names></name><name><surname>Nelson</surname><given-names>KB</given-names></name></person-group><article-title>Analysis of clinical trials by treatment actually received: is it really an option?</article-title><source>Statistics in Medicine</source><year>1991</year><volume>10</volume><issue>10</issue><fpage>1595</fpage><lpage>1605</lpage><pub-id pub-id-type="pmid">1947515</pub-id></element-citation></ref><ref id="b6"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peduzzi</surname><given-names>P</given-names></name><name><surname>Wittes</surname><given-names>J</given-names></name><name><surname>Detre</surname><given-names>K</given-names></name><name><surname>Holdford</surname><given-names>T</given-names></name></person-group><article-title>Analysis as randomised and the problem of non-adherence: an example from the veterans affairs randomized trial of coronary artery bypass surgery</article-title><source>Statistics in Medicine</source><year>1993</year><volume>12</volume><issue>13</issue><fpage>1185</fpage><lpage>1195</lpage><pub-id pub-id-type="pmid">8210821</pub-id></element-citation></ref><ref id="b7"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>White</surname><given-names>IR</given-names></name><name><surname>Babiker</surname><given-names>AG</given-names></name><name><surname>Walker</surname><given-names>S</given-names></name><name><surname>Darbyshire</surname><given-names>JH</given-names></name></person-group><article-title>Randomisation-based methods for correcting for treatment changes: examples from the Concorde trial</article-title><source>Statistics in Medicine</source><year>1999</year><volume>18</volume><issue>19</issue><fpage>2617</fpage><lpage>2634</lpage><pub-id pub-id-type="pmid">10495460</pub-id></element-citation></ref><ref id="b8"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Angrist</surname><given-names>JD</given-names></name><name><surname>Imbens</surname><given-names>GW</given-names></name><name><surname>Rubin</surname><given-names>DB</given-names></name></person-group><article-title>Identification of causal effects using instrumental variables</article-title><source>Journal of the American Statistical Association</source><year>1996</year><volume>91</volume><issue>434</issue><fpage>444</fpage><lpage>455</lpage></element-citation></ref><ref id="b9"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rubin</surname><given-names>DB</given-names></name></person-group><article-title>Estimating causal effects of treatments in randomized and nonrandomized studies</article-title><source>Journal of Educational Psychology</source><year>1974</year><volume>66</volume><fpage>688</fpage><lpage>701</lpage></element-citation></ref><ref id="b10"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frangakis</surname><given-names>C</given-names></name></person-group><article-title>Principal stratification in causal inference</article-title><source>Biometrics</source><year>2002</year><volume>58</volume><issue>1</issue><fpage>21</fpage><lpage>29</lpage><pub-id pub-id-type="pmid">11890317</pub-id></element-citation></ref><ref id="b11"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cuzick</surname><given-names>J</given-names></name><name><surname>Edwards</surname><given-names>R</given-names></name><name><surname>Segnan</surname><given-names>N</given-names></name></person-group><article-title>Adjusting for non-compliance and contamination in randomized clinical trials</article-title><source>Statistics in Medicine</source><year>1997</year><volume>16</volume><issue>9</issue><fpage>1017</fpage><lpage>1029</lpage><pub-id pub-id-type="pmid">9160496</pub-id></element-citation></ref><ref id="b12"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Greenland</surname><given-names>S</given-names></name></person-group><article-title>An introduction to instrumental variables for epidemiologists</article-title><source>International Journal of Epidemiology</source><year>2000</year><volume>29</volume><issue>4</issue><fpage>722</fpage><lpage>729</lpage><pub-id pub-id-type="pmid">10922351</pub-id></element-citation></ref><ref id="b13"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dunn</surname><given-names>G</given-names></name><name><surname>Maracy</surname><given-names>M</given-names></name><name><surname>Tomenson</surname><given-names>B</given-names></name></person-group><article-title>Estimating treatment effects from randomised clinical trials with non-compliance and loss to follow-up: the role of instrumental variables</article-title><source>Statistical Methods in Medical Research</source><year>2005</year><volume>14</volume><issue>4</issue><fpage>369</fpage><lpage>395</lpage><pub-id pub-id-type="pmid">16178138</pub-id></element-citation></ref><ref id="b14"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rubin</surname><given-names>DB</given-names></name></person-group><article-title>Bayesian inference for causal effects: the role of randomization</article-title><source>The Annals of Statistics</source><year>1978</year><volume>6</volume><fpage>34</fpage><lpage>58</lpage></element-citation></ref><ref id="b15"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Imbens</surname><given-names>GW</given-names></name><name><surname>Rubin</surname><given-names>DB</given-names></name></person-group><article-title>Bayesian inference for causal effects in randomised experiments with noncompliance</article-title><source>The Annals of Statistics</source><year>1997</year><volume>25</volume><issue>1</issue><fpage>305</fpage><lpage>327</lpage></element-citation></ref><ref id="b16"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dempster</surname><given-names>AP</given-names></name><name><surname>Laird</surname><given-names>NM</given-names></name><name><surname>Rubin</surname><given-names>DB</given-names></name></person-group><article-title>Maxiumum likelihood from incomplete data via the EM algorithm</article-title><source>Journal of the Royal Statistical Society, Series B</source><year>1977</year><volume>39</volume><fpage>1</fpage><lpage>38</lpage></element-citation></ref><ref id="b17"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tanner</surname><given-names>MA</given-names></name><name><surname>Wong</surname><given-names>WH</given-names></name></person-group><article-title>The calculation of posterior distributions by data augmentation</article-title><source>Journal of the American Statistical Association</source><year>1987</year><volume>82</volume><issue>398</issue><fpage>528</fpage><lpage>540</lpage></element-citation></ref><ref id="b18"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gilks</surname><given-names>WR</given-names></name><name><surname>Richardson</surname><given-names>S</given-names></name><name><surname>Spiegelhalter</surname><given-names>DJ</given-names></name></person-group><source>Markov Chain Monte Carlo in Practice</source><year>1996</year><publisher-loc>London</publisher-loc><publisher-name>Chapman and Hall</publisher-name></element-citation></ref><ref id="b19"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yau</surname><given-names>LHY</given-names></name><name><surname>Little</surname><given-names>RJ</given-names></name></person-group><article-title>Inference for the complier average causal effect from longitudinal data subject to noncompliance and missing data, with application to a job training assessment for the unemployed</article-title><source>Journal of the American Statistical Association</source><year>2001</year><volume>96</volume><issue>456</issue><fpage>1232</fpage><lpage>1243</lpage></element-citation></ref><ref id="b20"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lin</surname><given-names>JY</given-names></name><name><surname>Ten Have</surname><given-names>TR</given-names></name><name><surname>Bogner</surname><given-names>HR</given-names></name><name><surname>Elliot</surname><given-names>MR</given-names></name></person-group><article-title>Baseline patient characteristics and mortality associated with longitudinal intervention compliance</article-title><source>Statistics in Medicine</source><year>2007</year><volume>26</volume><issue>28</issue><fpage>5100</fpage><lpage>5115</lpage><pub-id pub-id-type="pmid">17477334</pub-id></element-citation></ref><ref id="b21"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sitlani</surname><given-names>CM</given-names></name><name><surname>Heagerty</surname><given-names>PJ</given-names></name><name><surname>Blood</surname><given-names>EA</given-names></name><name><surname>Tosteson</surname><given-names>TD</given-names></name></person-group><article-title>Longitudinal structural mixed models for the analysis of surgical trials with noncompliance</article-title><source>Statistics in Medicine</source><year>2012</year><volume>31</volume><issue>16</issue><fpage>1738</fpage><lpage>1760</lpage><pub-id pub-id-type="pmid">22344923</pub-id></element-citation></ref><ref id="b22"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robins</surname><given-names>J</given-names></name></person-group><article-title>Correcting for noncompliance in randomized trials using structural nested mean models</article-title><source>Communications in Statistics - Theory and Methods</source><year>1994</year><volume>23</volume><issue>8</issue><fpage>2379</fpage><lpage>2412</lpage></element-citation></ref><ref id="b23"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Medical Research Council Multicentre Otitis Media Study Group</surname></name></person-group><article-title>Adjuvant adenoidectomy in persistent bilateral otitis media with effusion: hearing and revision surgery outcomes through 2 years in the TARGET randomised trial</article-title><source>Clinical Otolaryngology</source><year>2012</year><volume>37</volume><issue>2</issue><fpage>107</fpage><lpage>116</lpage><pub-id pub-id-type="pmid">22443163</pub-id></element-citation></ref><ref id="b24"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lunn</surname><given-names>DJ</given-names></name><name><surname>Thomas</surname><given-names>A</given-names></name><name><surname>Best</surname><given-names>N</given-names></name><name><surname>Spiegelhalter</surname><given-names>D</given-names></name></person-group><article-title>WinBUGS &#x02013; a Bayesian modelling framework: concepts, structure, and extensibility</article-title><source>Statistics and Computing</source><year>2000</year><volume>10</volume><issue>4</issue><fpage>325</fpage><lpage>337</lpage></element-citation></ref><ref id="b25"><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Little</surname><given-names>RJA</given-names></name><name><surname>Rubin</surname><given-names>DB</given-names></name></person-group><source>Statistical Analysis with Missing Data (2nd Ed)</source><year>2000</year><publisher-loc>Hoboken</publisher-loc><publisher-name>Wiley</publisher-name></element-citation></ref><ref id="b26"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Brooks</surname><given-names>S</given-names></name><name><surname>Gelman</surname><given-names>A</given-names></name></person-group><article-title>Alternative models for monitoring convergence of iterative simulations</article-title><source>Journal of Computational and Graphical Statistics</source><year>1998</year><volume>7</volume><issue>4</issue><fpage>434</fpage><lpage>455</lpage></element-citation></ref><ref id="b27"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Frangakis</surname><given-names>CE</given-names></name><name><surname>Rubin</surname><given-names>DB</given-names></name></person-group><article-title>Addressing complications of intention-to-treat analysis in the combined presence of all-or-none treatment-noncompliance and subsequent missing outcomes</article-title><source>Biometrika</source><year>1999</year><volume>86</volume><issue>2</issue><fpage>365</fpage><lpage>379</lpage></element-citation></ref><ref id="b28"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peng</surname><given-names>Y</given-names></name><name><surname>Little</surname><given-names>RJA</given-names></name><name><surname>Raghunathan</surname><given-names>TE</given-names></name></person-group><article-title>An extended general location model for causal inferences from data subject to noncompliance and missing values</article-title><source>Biometrics</source><year>2004</year><volume>60</volume><issue>3</issue><fpage>598</fpage><lpage>607</lpage><pub-id pub-id-type="pmid">15339281</pub-id></element-citation></ref><ref id="b29"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mealli</surname><given-names>F</given-names></name><name><surname>Imbens</surname><given-names>GW</given-names></name><name><surname>Ferro</surname><given-names>S</given-names></name><name><surname>Biggeri</surname><given-names>A</given-names></name></person-group><article-title>Analyzing a randomized trial on breast self-examination with noncompliance and missing outcomes</article-title><source>Biostatistics</source><year>2005</year><volume>5</volume><issue>2</issue><fpage>207</fpage><lpage>222</lpage><pub-id pub-id-type="pmid">15054026</pub-id></element-citation></ref><ref id="b30"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>O&#x02019;Malley</surname><given-names>AJ</given-names></name><name><surname>Normand</surname><given-names>SLT</given-names></name></person-group><article-title>Likelihood methods for treatment noncompliance and subsequent nonresponse in randomized trials</article-title><source>Biometrics</source><year>2005</year><volume>61</volume><issue>2</issue><fpage>325</fpage><lpage>334</lpage><pub-id pub-id-type="pmid">16011678</pub-id></element-citation></ref><ref id="b31"><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hogan</surname><given-names>JW</given-names></name><name><surname>Lancaster</surname><given-names>T</given-names></name></person-group><article-title>Instrumental variables and inverse probability weighting for causal inference from longitudinal observational studies</article-title><source>Statistical Methods in Medical Research</source><year>2004</year><volume>13</volume><issue>1</issue><fpage>17</fpage><lpage>48</lpage><pub-id pub-id-type="pmid">14746439</pub-id></element-citation></ref></ref-list></back></article>